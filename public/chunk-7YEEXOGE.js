import{a as y,b as B}from"./chunk-PKUTC4BC.js";import{Aa as C,Eb as P,Fb as F,Gb as O,Hb as k,Ka as p,Na as l,Qa as r,Ra as a,Sa as b,Ta as v,Ua as M,Va as u,Xa as d,Ya as j,Z as w,cb as S,fa as _,fb as V,ga as g,ha as x,za as s}from"./chunk-Q72HHEJZ.js";var h=class{constructor(e,t){this.row=e;this.column=t}status="open";mine=!1;proximaMinas=0};var E=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],f=class{cells=[];celdaRestante=0;mineCount=0;constructor(e,t){for(let i=0;i<e;i++){this.cells[i]=[];for(let o=0;o<e;o++)this.cells[i][o]=new h(i,o)}for(let i=0;i<t;i++)this.getRandomCell().mine=!0;for(let i=0;i<e;i++)for(let o=0;o<e;o++){let m=0;for(let c of E)this.cells[i+c[0]]&&this.cells[i+c[0]][o+c[1]]&&this.cells[i+c[0]][o+c[1]].mine&&m++;this.cells[i][o].proximaMinas=m,this.cells[i][o].mine&&this.mineCount++}this.celdaRestante=e*e-this.mineCount}getRandomCell(){let e=Math.floor(Math.random()*this.cells.length),t=Math.floor(Math.random()*this.cells[e].length);return this.cells[e][t]}checkCell(e){if(e.status!=="open")return null;if(e.mine)return this.revealAll(),"gameover";if(e.status="clear",e.proximaMinas===0)for(let t of E)this.cells[e.row+t[0]]&&this.cells[e.row+t[0]][e.column+t[1]]&&this.checkCell(this.cells[e.row+t[0]][e.column+t[1]]);return this.celdaRestante--<=1?"win":null}revealAll(){for(let e of this.cells)for(let t of e)t.status==="open"&&(t.status="clear")}};var T=(n,e)=>({ganado:n,perdio:e});function I(n,e){if(n&1&&(r(0,"div"),d(1),a()),n&2){let t=u().$implicit;s(),j(t.proximaMinas)}}function H(n,e){n&1&&(r(0,"div"),x(),r(1,"svg",7),b(2,"path",8),a()())}function D(n,e){n&1&&(r(0,"div"),x(),r(1,"svg",7),b(2,"path",9),a()())}function N(n,e){if(n&1){let t=v();r(0,"td",5),M("click",function(){let o=_(t).$implicit,m=u(2);return g(m.checkCell(o))})("contextmenu",function(o){let m=_(t).$implicit,c=u(2);return o.preventDefault(),g(c.flag(m))}),p(1,I,2,1,"div",6)(2,H,3,0,"div",6)(3,D,3,0,"div",6),a()}if(n&2){let t=e.$implicit;s(),l("ngIf",t.status==="clear"&&!t.mine),s(),l("ngIf",t.status==="flag"),s(),l("ngIf",t.mine&&t.status==="clear")}}function R(n,e){if(n&1&&(r(0,"tr"),p(1,N,4,3,"td",4),a()),n&2){let t=e.$implicit;s(),l("ngForOf",t)}}function U(n,e){if(n&1){let t=v();r(0,"div",10)(1,"h2"),d(2),a(),r(3,"button",11),M("click",function(){_(t);let o=u();return g(o.reinicio())}),d(4,"\xBFJugar Otra Vez?"),a()()}if(n&2){let t=u();l("ngClass",V(2,T,t.calcularVictoria(),t.calcularDerrota())),s(2),j(t.mensajeFinal)}}var L=class n{constructor(e,t){this.user=e;this.db=t;this.reinicio(),this.board=new f(20,50)}mostrarMensajeFinal=!1;mensajeFinal="";errores=0;board;checkCell(e){let t=this.board.checkCell(e);t==="gameover"?this.Perder():t==="win"&&this.ganoElJuego()}flag(e){e.status==="flag"?e.status="open":e.status="flag"}reinicio(){this.board=new f(20,50),this.mostrarMensajeFinal=!1,this.errores=0}ganoElJuego(){let e=Math.max(1,10);this.mostrarMensajeFinal=!0,this.mensajeFinal="GANASTE",this.user.datos?.id&&(this.mensajeFinal=this.mensajeFinal+" "+e+" PUNTOS!!",this.user.datos.puntajeMaxBuscamina=e+this.user.datos.puntajeMaxBuscamina,this.db.actulizarPuntaje("puntajeMaxBuscamina",this.user.datos.id,this.user.datos.puntajeMaxBuscamina)),this.calcularVictoria()}Perder(){this.mostrarMensajeFinal=!0,this.mensajeFinal="PERDISTE!",this.calcularDerrota()}calcularVictoria(){return!0}calcularDerrota(){return this.errores==6}static \u0275fac=function(t){return new(t||n)(C(B),C(y))};static \u0275cmp=w({type:n,selectors:[["app-buscamina"]],standalone:!0,features:[S],decls:6,vars:2,consts:[[1,"contenedor"],[1,"titulo"],[4,"ngFor","ngForOf"],["class","mensaje",3,"ngClass",4,"ngIf"],[3,"click","contextmenu",4,"ngFor","ngForOf"],[3,"click","contextmenu"],[4,"ngIf"],["viewBox","0 0 24 24",2,"width","24px","height","24px"],["fill","#000000","d","M14.4,6L14,4H5V21H7V14H12.6L13,16H20V6H14.4Z"],["fill","#000000","d","M23,13V11H19.93C19.75,9.58 19.19,8.23 18.31,7.1L20.5,4.93L19.07,3.5L16.9,5.69C15.77,4.81 14.42,4.25 13,4.07V1H11V4.07C9.58,4.25 8.23,4.81 7.1,5.69L4.93,3.5L3.5,4.93L5.69,7.1C4.81,8.23 4.25,9.58 4.07,11H1V13H4.07C4.25,14.42 4.81,15.77 5.69,16.9L3.5,19.07L4.93,20.5L7.1,18.31C8.23,19.19 9.58,19.75 11,19.93V23H13V19.93C14.42,19.75 15.77,19.19 16.9,18.31L19.07,20.5L20.5,19.07L18.31,16.9C19.19,15.77 19.75,14.42 19.93,13H23M12,8A4,4 0 0,0 8,12H6A6,6 0 0,1 12,6V8Z"],[1,"mensaje",3,"ngClass"],[3,"click"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"h2",1),d(2," Buscamina: "),a(),r(3,"table"),p(4,R,2,1,"tr",2),a(),p(5,U,5,5,"div",3),a()),t&2&&(s(4),l("ngForOf",i.board.cells),s(),l("ngIf",i.mostrarMensajeFinal))},dependencies:[k,P,F,O],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center}.contenedor[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background-color:#89f48580;padding:40px;border-radius:5px;box-shadow:0 0 10px #0003;margin-bottom:20px;margin-top:10px}.titulo[_ngcontent-%COMP%]{text-align:center;color:green;border-radius:10px;font-size:35px;font-weight:700}table[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid grey;border-collapse:collapse}td[_ngcontent-%COMP%]{width:32px;height:32px}.mensaje[_ngcontent-%COMP%]{position:fixed;background-color:#445740;top:80%;left:50%;transform:translate(-50%,-50%);color:#fff;padding:20px;border-radius:5px;text-align:center;box-shadow:0 2px 6px #0000004d}.mensaje[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:20px}.mensaje[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-block;background-color:#fff;color:#000;border:none;padding:10px 20px;font-size:16px;text-align:center;cursor:pointer;border-radius:5px}.mensaje[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#d3d3d3}.mensaje.perdio[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.mensaje.ganado[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}"]})};export{L as BuscaminaComponent};
