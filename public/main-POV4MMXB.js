import{$ as O,A as at,Aa as Hd,B as Kn,Ba as ys,C as _s,Ca as Zn,D as Le,Da as Kd,E as Ue,Ea as we,F as kd,G as yn,H as Qn,I as Bt,J as ja,K as Nd,L as Jn,M as U,N as q,O as ei,P as ti,Q as qt,R as re,S as j,T as Vd,U as Ba,V as D,W as R,X as se,Y as Ke,Z as ue,_ as oe,a as Be,aa as ct,b as Ze,ba as ut,c as Ut,ca as Od,d as y,da as Md,e as Xr,ea as Fd,f as Ad,fa as ni,g as Cd,ga as me,h as Sd,ha as Ld,i as Ma,ia as ri,j as Fa,ja as Yn,k as La,ka as qa,l as Ua,la as Ud,m as _n,ma as jd,n as Pd,na as Bd,o as Rd,oa as qd,p as Dd,pa as zd,q as xd,qa as ii,r as ps,ra as zt,s as Zr,sa as za,t as it,ta as Xn,u as ms,ua as Gt,v as He,va as qe,w as jt,wa as Ie,x as et,xa as Gd,y as pe,ya as $d,z as gs,za as Wd}from"./chunk-ME6XNQTW.js";var Ee=class n{usuario;constructor(){}get datos(){return this.usuario}get nombre(){return this.usuario?.nombre.split("@")[0]||""}iniciar(e){this.usuario=e}cerrar(){this.usuario=void 0}static \u0275fac=function(t){return new(t||n)};static \u0275prov=it({token:n,factory:n.\u0275fac,providedIn:"root"})};var Jd=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},U_=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Yd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=o>>2,I=(o&3)<<4|u>>4,A=(u&15)<<2|d>>6,S=d&63;h||(S=64,a||(A=64)),r.push(t[p],t[I],t[A],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Jd(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):U_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let I=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||d==null||I==null)throw new $a;let A=o<<2|u>>4;if(r.push(A),d!==64){let S=u<<4&240|d>>2;if(r.push(S),I!==64){let V=d<<6&192|I;r.push(V)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},$a=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},j_=function(n){let e=Jd(n);return Yd.encodeByteArray(e,!0)},si=function(n){return j_(n).replace(/\./g,"")},Ha=function(n){try{return Yd.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function B_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var q_=()=>B_().__FIREBASE_DEFAULTS__,z_=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},G_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Ha(n[1]);return e&&JSON.parse(e)},Is=()=>{try{return q_()||z_()||G_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ka=n=>{var e,t;return(t=(e=Is())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Xd=n=>{let e=Ka(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Qa=()=>{var n;return(n=Is())===null||n===void 0?void 0:n.config},Ja=n=>{var e;return(e=Is())===null||e===void 0?void 0:e[`_${n}`]};var vs=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Zd(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[si(JSON.stringify(t)),si(JSON.stringify(a)),""].join(".")}function be(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ef(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(be())}function $_(){var n;let e=(n=Is())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tf(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nf(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function rf(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function sf(){let n=be();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function of(){return!$_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ya(){try{return typeof indexedDB=="object"}catch{return!1}}function af(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var W_="FirebaseError",Qe=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=W_,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wt.prototype.create)}},wt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?H_(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new Qe(i,u,r)}};function H_(n,e){return n.replace(K_,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var K_=/\{\$([^}]+)}/g;function cf(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function vn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(Qd(o)&&Qd(a)){if(!vn(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Qd(n){return n!==null&&typeof n=="object"}function oi(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function uf(n,e){let t=new Wa(n,e);return t.subscribe.bind(t)}var Wa=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Q_(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ga),i.error===void 0&&(i.error=Ga),i.complete===void 0&&(i.complete=Ga);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Q_(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ga(){}var Qb=4*60*60*1e3;function Te(n){return n&&n._delegate?n._delegate:n}var tt=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var In="[DEFAULT]";var Xa=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new vs;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Y_(e))try{this.getOrInitializeService({instanceIdentifier:In})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=In){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=In){return this.instances.has(e)}getOptions(e=In){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:J_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=In){return this.component?this.component.multipleInstances?e:In:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function J_(n){return n===In?void 0:n}function Y_(n){return n.instantiationMode==="EAGER"}var ws=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Xa(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var X_=[],K=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(K||{}),Z_={debug:K.DEBUG,verbose:K.VERBOSE,info:K.INFO,warn:K.WARN,error:K.ERROR,silent:K.SILENT},ey=K.INFO,ty={[K.DEBUG]:"log",[K.VERBOSE]:"log",[K.INFO]:"info",[K.WARN]:"warn",[K.ERROR]:"error"},ny=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=ty[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Wt=class{constructor(e){this.name=e,this._logLevel=ey,this._logHandler=ny,this._userLogHandler=null,X_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in K))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Z_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,K.DEBUG,...e),this._logHandler(this,K.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,K.VERBOSE,...e),this._logHandler(this,K.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,K.INFO,...e),this._logHandler(this,K.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,K.WARN,...e),this._logHandler(this,K.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,K.ERROR,...e),this._logHandler(this,K.ERROR,...e)}};var ry=(n,e)=>e.some(t=>n instanceof t),lf,hf;function iy(){return lf||(lf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sy(){return hf||(hf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var df=new WeakMap,ec=new WeakMap,ff=new WeakMap,Za=new WeakMap,nc=new WeakMap;function oy(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(lt(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&df.set(t,n)}).catch(()=>{}),nc.set(e,n),e}function ay(n){if(ec.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});ec.set(n,e)}var tc={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ec.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ff.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return lt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function pf(n){tc=n(tc)}function cy(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Es(this),e,...t);return ff.set(r,e.sort?e.sort():[e]),lt(r)}:sy().includes(n)?function(...e){return n.apply(Es(this),e),lt(df.get(this))}:function(...e){return lt(n.apply(Es(this),e))}}function uy(n){return typeof n=="function"?cy(n):(n instanceof IDBTransaction&&ay(n),ry(n,iy())?new Proxy(n,tc):n)}function lt(n){if(n instanceof IDBRequest)return oy(n);if(Za.has(n))return Za.get(n);let e=uy(n);return e!==n&&(Za.set(n,e),nc.set(e,n)),e}var Es=n=>nc.get(n);function gf(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=lt(a);return r&&a.addEventListener("upgradeneeded",h=>{r(lt(a.result),h.oldVersion,h.newVersion,lt(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var ly=["get","getKey","getAll","getAllKeys","count"],hy=["put","add","delete","clear"],rc=new Map;function mf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(rc.get(e))return rc.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=hy.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||ly.includes(t)))return;let o=function(a,...u){return y(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&h.done]))[0]})};return rc.set(e,o),o}pf(n=>Ze(Be({},n),{get:(e,t,r)=>mf(e,t)||n.get(e,t,r),has:(e,t)=>!!mf(e,t)||n.has(e,t)}));var sc=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(dy(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function dy(n){let e=n.getComponent();return e?.type==="VERSION"}var oc="@firebase/app",_f="0.10.11";var Et=new Wt("@firebase/app"),fy="@firebase/app-compat",py="@firebase/analytics-compat",my="@firebase/analytics",gy="@firebase/app-check-compat",_y="@firebase/app-check",yy="@firebase/auth",vy="@firebase/auth-compat",Iy="@firebase/database",wy="@firebase/database-compat",Ey="@firebase/functions",by="@firebase/functions-compat",Ty="@firebase/installations",Ay="@firebase/installations-compat",Cy="@firebase/messaging",Sy="@firebase/messaging-compat",Py="@firebase/performance",Ry="@firebase/performance-compat",Dy="@firebase/remote-config",xy="@firebase/remote-config-compat",ky="@firebase/storage",Ny="@firebase/storage-compat",Vy="@firebase/firestore",Oy="@firebase/vertexai-preview",My="@firebase/firestore-compat",Fy="firebase",Ly="10.13.2";var ac="[DEFAULT]",Uy={[oc]:"fire-core",[fy]:"fire-core-compat",[my]:"fire-analytics",[py]:"fire-analytics-compat",[_y]:"fire-app-check",[gy]:"fire-app-check-compat",[yy]:"fire-auth",[vy]:"fire-auth-compat",[Iy]:"fire-rtdb",[wy]:"fire-rtdb-compat",[Ey]:"fire-fn",[by]:"fire-fn-compat",[Ty]:"fire-iid",[Ay]:"fire-iid-compat",[Cy]:"fire-fcm",[Sy]:"fire-fcm-compat",[Py]:"fire-perf",[Ry]:"fire-perf-compat",[Dy]:"fire-rc",[xy]:"fire-rc-compat",[ky]:"fire-gcs",[Ny]:"fire-gcs-compat",[Vy]:"fire-fst",[My]:"fire-fst-compat",[Oy]:"fire-vertex","fire-js":"fire-js",[Fy]:"fire-js-all"};var ai=new Map,jy=new Map,cc=new Map;function yf(n,e){try{n.container.addComponent(e)}catch(t){Et.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Kt(n){let e=n.name;if(cc.has(e))return Et.debug(`There were multiple attempts to register component ${e}.`),!1;cc.set(e,n);for(let t of ai.values())yf(t,n);for(let t of jy.values())yf(t,n);return!0}function ui(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function bt(n){return n.settings!==void 0}var By={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ht=new wt("app","Firebase",By);var uc=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new tt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ht.create("app-deleted",{appName:this._name})}};var Qt=Ly;function dc(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:ac,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Ht.create("bad-app-name",{appName:String(i)});if(t||(t=Qa()),!t)throw Ht.create("no-options");let o=ai.get(i);if(o){if(vn(t,o.options)&&vn(r,o.config))return o;throw Ht.create("duplicate-app",{appName:i})}let a=new ws(i);for(let h of cc.values())a.addComponent(h);let u=new uc(t,r,a);return ai.set(i,u),u}function er(n=ac){let e=ai.get(n);if(!e&&n===ac&&Qa())return dc();if(!e)throw Ht.create("no-app",{appName:n});return e}function bs(){return Array.from(ai.values())}function ve(n,e,t){var r;let i=(r=Uy[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Et.warn(u.join(" "));return}Kt(new tt(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var qy="firebase-heartbeat-database",zy=1,ci="firebase-heartbeat-store",ic=null;function Ef(){return ic||(ic=gf(qy,zy,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ci)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ht.create("idb-open",{originalErrorMessage:n.message})})),ic}function Gy(n){return y(this,null,function*(){try{let t=(yield Ef()).transaction(ci),r=yield t.objectStore(ci).get(bf(n));return yield t.done,r}catch(e){if(e instanceof Qe)Et.warn(e.message);else{let t=Ht.create("idb-get",{originalErrorMessage:e?.message});Et.warn(t.message)}}})}function vf(n,e){return y(this,null,function*(){try{let r=(yield Ef()).transaction(ci,"readwrite");yield r.objectStore(ci).put(e,bf(n)),yield r.done}catch(t){if(t instanceof Qe)Et.warn(t.message);else{let r=Ht.create("idb-set",{originalErrorMessage:t?.message});Et.warn(r.message)}}})}function bf(n){return`${n.name}!${n.options.appId}`}var $y=1024,Wy=30*24*60*60*1e3,lc=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new hc(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=If();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=Wy}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Et.warn(r)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=If(),{heartbeatsToSend:r,unsentEntries:i}=Hy(this._heartbeatsCache.heartbeats),o=si(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Et.warn(t),""}})}};function If(){return new Date().toISOString().substring(0,10)}function Hy(n,e=$y){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),wf(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),wf(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var hc=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return Ya()?af().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield Gy(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return vf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return vf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function wf(n){return si(JSON.stringify({version:2,heartbeats:n})).length}function Ky(n){Kt(new tt("platform-logger",e=>new sc(e),"PRIVATE")),Kt(new tt("heartbeat",e=>new lc(e),"PRIVATE")),ve(oc,_f,n),ve(oc,_f,"esm2017"),ve("fire-js","")}Ky("");var Qy="firebase",Jy="10.13.2";ve(Qy,Jy,"app");var En=new qa("ANGULARFIRE2_VERSION");function As(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var li=(n,e)=>{let t=e?[e]:bs(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},nr=class{constructor(){return li(Yy)}},Yy="app-check";function tr(){}var Ts=class{zone;delegate;constructor(e,t=Sd){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(o,t,r)}},fc=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",tr,{},tr,tr)),t.pipe(xd({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},rr=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Ts(Zone.current)),this.insideAngular=t.run(()=>new Ts(Zone.current,Cd)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(jt(Bt))};static \u0275prov=it({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Cs(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Xy(n){return Cs().ngZone.runOutsideAngular(()=>n())}function wn(n){return Cs().ngZone.run(()=>n())}function Zy(n){return ev(Cs())(n)}function ev(n){return function(t){return t=t.lift(new fc(n.ngZone)),t.pipe(La(n.outsideAngular),Fa(n.insideAngular))}}var tv=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),wn(()=>n.apply(void 0,r))},ze=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=wn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",tr,{},tr,tr))),r[o]=tv(r[o],t));let i=Xy(()=>n.apply(this,r));if(!e)if(i instanceof Xr){let o=Cs();return i.pipe(La(o.outsideAngular),Fa(o.insideAngular))}else return wn(()=>i);return i instanceof Xr?i.pipe(Zy):i instanceof Promise?wn(()=>new Promise((o,a)=>i.then(u=>wn(()=>o(u)),u=>wn(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:wn(()=>i)};var Tt=class{constructor(e){return e}},bn=class{constructor(){return bs()}};function nv(n){return n&&n.length===1?n[0]:new Tt(er())}var pc=new He("angularfire2._apps"),rv={provide:Tt,useFactory:nv,deps:[[new et,pc]]},iv={provide:bn,deps:[[new et,pc]]};function sv(n){return(e,t)=>{let r=t.get(Nd);ve("angularfire",En.full,"core"),ve("angularfire",En.full,"app"),ve("angular",Ud.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Tt(i)}}function Tf(n,...e){return Kn([rv,iv,{provide:pc,useFactory:sv(n),multi:!0,deps:[Bt,yn,rr,...e]}])}var Af=ze(dc,!0);function jf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Bf=jf,qf=new wt("auth","Firebase",jf());var ks=new Wt("@firebase/auth");function ov(n,...e){ks.logLevel<=K.WARN&&ks.warn(`Auth (${Qt}): ${n}`,...e)}function Ps(n,...e){ks.logLevel<=K.ERROR&&ks.error(`Auth (${Qt}): ${n}`,...e)}function Yt(n,...e){throw Vc(n,...e)}function An(n,...e){return Vc(n,...e)}function zf(n,e,t){let r=Object.assign(Object.assign({},Bf()),{[e]:t});return new wt("auth","Firebase",r).create(e,{appName:n.name})}function Tn(n){return zf(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Vc(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return qf.create(n,...e)}function G(n,e,...t){if(!n)throw Vc(e,...t)}function At(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ps(e),new Error(e)}function Xt(n,e){n||At(e)}function yc(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function av(){return Cf()==="http:"||Cf()==="https:"}function Cf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function cv(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(av()||nf()||"connection"in navigator)?navigator.onLine:!0}function uv(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Cn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xt(t>e,"Short delay should be less than long delay!"),this.isMobile=ef()||rf()}get(){return cv()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Oc(n,e){Xt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ns=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;At("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;At("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;At("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var lv={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var hv=new Cn(3e4,6e4);function Mc(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function sr(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){return Gf(n,i,()=>y(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let I=oi(Object.assign({key:n.config.apiKey},p)).slice(1),A=yield n._getAdditionalHeaders();A["Content-Type"]="application/json",n.languageCode&&(A["X-Firebase-Locale"]=n.languageCode);let S=Object.assign({method:e,headers:A},d);return tf()||(S.referrerPolicy="no-referrer"),Ns.fetch()($f(n,n.config.apiHost,t,I),S)}))})}function Gf(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},lv),e);try{let i=new vc(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield o.json();if("needConfirmation"in a)throw Ss(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let u=o.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ss(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw Ss(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw Ss(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw zf(n,p,d);Yt(n,p)}}catch(i){if(i instanceof Qe)throw i;Yt(n,"network-request-failed",{message:String(i)})}})}function dv(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){let d=yield sr(n,e,t,r,i);return"mfaPendingCredential"in d&&Yt(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function $f(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?Oc(n.config,i):`${n.config.apiScheme}://${i}`}var vc=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(An(this.auth,"network-request-failed")),hv.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Ss(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=An(n,e,r);return i.customData._tokenResponse=t,i}function fv(n,e){return y(this,null,function*(){return sr(n,"POST","/v1/accounts:delete",e)})}function Wf(n,e){return y(this,null,function*(){return sr(n,"POST","/v1/accounts:lookup",e)})}function hi(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Fc(n,e=!1){return y(this,null,function*(){let t=Te(n),r=yield t.getIdToken(e),i=Lc(r);G(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:hi(mc(i.auth_time)),issuedAtTime:hi(mc(i.iat)),expirationTime:hi(mc(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function mc(n){return Number(n)*1e3}function Lc(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ps("JWT malformed, contained fewer than 3 sections"),null;try{let i=Ha(t);return i?JSON.parse(i):(Ps("Failed to decode base64 JWT payload"),null)}catch(i){return Ps("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Sf(n){let e=Lc(n);return G(e,"internal-error"),G(typeof e.exp<"u","internal-error"),G(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function fi(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Qe&&pv(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function pv({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Ic=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var pi=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=hi(this.lastLoginAt),this.creationTime=hi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Vs(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield fi(n,Wf(t,{idToken:r}));G(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?Hf(o.providerUserInfo):[],u=mv(n.providerData,a),h=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!u?.length,p=h?d:!1,I={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new pi(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(n,I)})}function Uc(n){return y(this,null,function*(){let e=Te(n);yield Vs(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function mv(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Hf(n){return n.map(e=>{var{providerId:t}=e,r=Ma(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function gv(n,e){return y(this,null,function*(){let t=yield Gf(n,{},()=>y(this,null,function*(){let r=oi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=$f(n,i,"/v1/token",`key=${o}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Ns.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function _v(n,e){return y(this,null,function*(){return sr(n,"POST","/v2/accounts:revokeToken",Mc(n,e))})}var di=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){G(e.idToken,"internal-error"),G(typeof e.idToken<"u","internal-error"),G(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Sf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){G(e.length!==0,"internal-error");let t=Sf(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(G(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield gv(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(G(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(G(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(G(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return At("not implemented")}};function Jt(n,e){G(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var ir=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=Ma(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ic(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new pi(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield fi(this,this.stsTokenManager.getToken(this.auth,e));return G(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Fc(this,e)}reload(){return Uc(this)}_assign(e){this!==e&&(G(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){G(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Vs(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(bt(this.auth.app))return Promise.reject(Tn(this.auth));let e=yield this.getIdToken();return yield fi(this,fv(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,u,h,d,p;let I=(r=t.displayName)!==null&&r!==void 0?r:void 0,A=(i=t.email)!==null&&i!==void 0?i:void 0,S=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,V=(a=t.photoURL)!==null&&a!==void 0?a:void 0,F=(u=t.tenantId)!==null&&u!==void 0?u:void 0,N=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,H=(d=t.createdAt)!==null&&d!==void 0?d:void 0,J=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:Y,emailVerified:ae,isAnonymous:Oe,providerData:te,stsTokenManager:w}=t;G(Y&&w,e,"internal-error");let m=di.fromJSON(this.name,w);G(typeof Y=="string",e,"internal-error"),Jt(I,e.name),Jt(A,e.name),G(typeof ae=="boolean",e,"internal-error"),G(typeof Oe=="boolean",e,"internal-error"),Jt(S,e.name),Jt(V,e.name),Jt(F,e.name),Jt(N,e.name),Jt(H,e.name),Jt(J,e.name);let _=new n({uid:Y,auth:e,email:A,emailVerified:ae,displayName:I,isAnonymous:Oe,photoURL:V,phoneNumber:S,tenantId:F,stsTokenManager:m,createdAt:H,lastLoginAt:J});return te&&Array.isArray(te)&&(_.providerData=te.map(v=>Object.assign({},v))),N&&(_._redirectEventId=N),_}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new di;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Vs(o),o})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];G(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?Hf(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,u=new di;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new pi(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h})}};var Pf=new Map;function Ct(n){Xt(n instanceof Function,"Expected a class definition");let e=Pf.get(n);return e?(Xt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Pf.set(n,e),e)}var yv=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),wc=yv;function Rs(n,e,t){return`firebase:${n}:${e}:${t}`}var Os=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=Rs(this.userKey,i.apiKey,o),this.fullPersistenceKey=Rs("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?ir._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(Ct(wc),e,r);let i=(yield Promise.all(t.map(d=>y(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),o=i[0]||Ct(wc),a=Rs(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let I=ir._fromJSON(e,p);d!==o&&(u=I),o=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],u&&(yield o._set(a,u.toJSON())),yield Promise.all(t.map(d=>y(this,null,function*(){if(d!==o)try{yield d._remove(a)}catch{}}))),new n(o,e,r))})}};function Rf(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Yf(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Kf(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Zf(e))return"Blackberry";if(ep(e))return"Webos";if(Qf(e))return"Safari";if((e.includes("chrome/")||Jf(e))&&!e.includes("edge/"))return"Chrome";if(Xf(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Kf(n=be()){return/firefox\//i.test(n)}function Qf(n=be()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Jf(n=be()){return/crios\//i.test(n)}function Yf(n=be()){return/iemobile/i.test(n)}function Xf(n=be()){return/android/i.test(n)}function Zf(n=be()){return/blackberry/i.test(n)}function ep(n=be()){return/webos/i.test(n)}function jc(n=be()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function vv(n=be()){var e;return jc(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Iv(){return sf()&&document.documentMode===10}function tp(n=be()){return jc(n)||Xf(n)||ep(n)||Zf(n)||/windows phone/i.test(n)||Yf(n)}function np(n,e=[]){let t;switch(n){case"Browser":t=Rf(be());break;case"Worker":t=`${Rf(be())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Qt}/${r}`}var Ec=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,u)=>{try{let h=e(o);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function wv(t){return y(this,arguments,function*(n,e={}){return sr(n,"GET","/v2/passwordPolicy",Mc(n,e))})}var Ev=6,bc=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:Ev,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var Tc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ms(this),this.idTokenSubscription=new Ms(this),this.beforeStateQueue=new Ec(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ct(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Os.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield Wf(this,{idToken:e}),r=yield ir._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(bt(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return G(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield Vs(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=uv()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(bt(this.app))return Promise.reject(Tn(this));let t=e?Te(e):null;return t&&G(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&G(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return bt(this.app)?Promise.reject(Tn(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return bt(this.app)?Promise.reject(Tn(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(Ct(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield wv(this),t=new bc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new wt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield _v(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Ct(e)||this._popupRedirectResolver;G(t,this,"argument-error"),this.redirectPersistenceManager=yield Os.create(this,[Ct(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(G(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return G(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=np(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&ov(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Bc(n){return Te(n)}var Ms=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=uf(t=>this.observer=t)}get next(){return G(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var qc={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bv(n){qc=n}function Tv(n){return qc.loadJS(n)}function Av(){return qc.gapiScript}function rp(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function zc(n,e){let t=ui(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(vn(o,e??{}))return i;Yt(i,"already-initialized")}return t.initialize({options:e})}function Cv(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ct);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Gc(n,e,t){let r=Bc(n);G(r._canInitEmulator,r,"emulator-config-failed"),G(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=ip(e),{host:a,port:u}=Sv(e),h=u===null?"":`:${u}`;r.config.emulator={url:`${o}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||Pv()}function ip(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Sv(n){let e=ip(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:Df(r.substr(o.length+1))}}else{let[o,a]=r.split(":");return{host:o,port:Df(a)}}}function Df(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function Pv(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Fs=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return At("not implemented")}_getIdTokenResponse(e){return At("not implemented")}_linkToIdToken(e,t){return At("not implemented")}_getReauthenticationResolver(e){return At("not implemented")}};function gc(n,e){return y(this,null,function*(){return dv(n,"POST","/v1/accounts:signInWithIdp",Mc(n,e))})}var Ls=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Ac=class extends Ls{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var mi=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let o=yield ir._fromIdTokenResponse(e,r,i),a=xf(r);return new n({user:o,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=xf(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function xf(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Cc=class n extends Qe{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function sp(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Cc._fromErrorAndOperation(n,o,e,r):o})}function Rv(n,e,t=!1){return y(this,null,function*(){let r=yield fi(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return mi._forOperation(n,"link",r)})}function Dv(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(bt(r.app))return Promise.reject(Tn(r));let i="reauthenticate";try{let o=yield fi(n,sp(r,i,e,n),t);G(o.idToken,r,"internal-error");let a=Lc(o.idToken);G(a,r,"internal-error");let{sub:u}=a;return G(n.uid===u,r,"user-mismatch"),mi._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Yt(r,"user-mismatch"),o}})}function xv(n,e,t=!1){return y(this,null,function*(){if(bt(n.app))return Promise.reject(Tn(n));let r="signIn",i=yield sp(n,r,e),o=yield mi._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(o.user)),o})}function $c(n,e,t,r){return Te(n).onIdTokenChanged(e,t,r)}function Wc(n,e,t){return Te(n).beforeAuthStateChanged(e,t)}var Us="__sak";var js=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Us,"1"),this.storage.removeItem(Us),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var kv=1e3,Nv=10,Vv=(()=>{class n extends js{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=tp(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,h,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);Iv()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,Nv):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},kv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield Ut(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield Ut(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield Ut(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),op=Vv;var Ov=(()=>{class n extends js{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Hc=Ov;function Mv(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var Fv=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:o,data:a}=r.data,u=this.handlersMap[o];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let h=Array.from(u).map(p=>y(this,null,function*(){return p(r.origin,a)})),d=yield Mv(h);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function ap(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Sc=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((u,h)=>{let d=ap("",20);i.port1.start();let p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(I){let A=I;if(A.data.eventId===d)switch(A.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(A.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function ht(){return window}function Lv(n){ht().location.href=n}function cp(){return typeof ht().WorkerGlobalScope<"u"&&typeof ht().importScripts=="function"}function Uv(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function jv(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Bv(){return cp()?self:null}var up="firebaseLocalStorageDb",qv=1,Bs="firebaseLocalStorage",lp="fbase_key",Sn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function zs(n,e){return n.transaction([Bs],e?"readwrite":"readonly").objectStore(Bs)}function zv(){let n=indexedDB.deleteDatabase(up);return new Sn(n).toPromise()}function Pc(){let n=indexedDB.open(up,qv);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Bs,{keyPath:lp})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Bs)?e(r):(r.close(),yield zv(),e(yield Pc()))}))})}function kf(n,e,t){return y(this,null,function*(){let r=zs(n,!0).put({[lp]:e,value:t});return new Sn(r).toPromise()})}function Gv(n,e){return y(this,null,function*(){let t=zs(n,!1).get(e),r=yield new Sn(t).toPromise();return r===void 0?null:r.value})}function Nf(n,e){let t=zs(n,!0).delete(e);return new Sn(t).toPromise()}var $v=800,Wv=3,Hv=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield Pc(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>Wv)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return cp()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=Fv._getInstance(Bv()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield Uv(),!this.activeServiceWorker)return;this.sender=new Sc(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||jv()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Pc();return yield kf(t,Us,"1"),yield Nf(t,Us),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>kf(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>Gv(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>Nf(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(o=>{let a=zs(o,!1).getAll();return new Sn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:a}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),$v)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),hp=Hv;var GT=rp("rcb"),$T=new Cn(3e4,6e4);function Kv(n,e){return e?Ct(e):(G(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var gi=class extends Fs{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return gc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return gc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return gc(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Qv(n){return xv(n.auth,new gi(n),n.bypassAuthState)}function Jv(n){let{auth:e,user:t}=n;return G(t,e,"internal-error"),Dv(t,new gi(n),n.bypassAuthState)}function Yv(n){return y(this,null,function*(){let{auth:e,user:t}=n;return G(t,e,"internal-error"),Rv(t,new gi(n),n.bypassAuthState)})}var Rc=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:a,type:u}=e;if(a){this.reject(a);return}let h={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(h))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Qv;case"linkViaPopup":case"linkViaRedirect":return Yv;case"reauthViaPopup":case"reauthViaRedirect":return Jv;default:Yt(this.auth,"internal-error")}}resolve(e){Xt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var WT=new Cn(2e3,1e4);var Xv="pendingRedirect",Ds=new Map,Dc=class n extends Rc{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=Ds.get(this.auth._key());if(!e){try{let r=(yield Zv(this.resolver,this.auth))?yield Ut(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ds.set(this.auth._key(),e)}return this.bypassAuthState||Ds.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Ut(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Ut(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function Zv(n,e){return y(this,null,function*(){let t=nI(e),r=tI(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function eI(n,e){Ds.set(n._key(),e)}function tI(n){return Ct(n._redirectPersistence)}function nI(n){return Rs(Xv,n.config.apiKey,n.name)}function rI(n,e,t=!1){return y(this,null,function*(){if(bt(n.app))return Promise.reject(Tn(n));let r=Bc(n),i=Kv(r,e),a=yield new Dc(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var iI=10*60*1e3,xc=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!sI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!dp(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(An(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=iI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Vf(e))}saveEventToCache(e){this.cachedEventUids.add(Vf(e)),this.lastProcessedEventTime=Date.now()}};function Vf(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function dp({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function sI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return dp(n);default:return!1}}function oI(t){return y(this,arguments,function*(n,e={}){return sr(n,"GET","/v1/projects",e)})}var aI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,cI=/^https?/;function uI(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield oI(n);for(let t of e)try{if(lI(t))return}catch{}Yt(n,"unauthorized-domain")})}function lI(n){let e=yc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!cI.test(t))return!1;if(aI.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var hI=new Cn(3e4,6e4);function Of(){let n=ht().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function dI(n){return new Promise((e,t)=>{var r,i,o;function a(){Of(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Of(),t(An(n,"network-request-failed"))},timeout:hI.get()})}if(!((i=(r=ht().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=ht().gapi)===null||o===void 0)&&o.load)a();else{let u=rp("iframefcb");return ht()[u]=()=>{gapi.load?a():t(An(n,"network-request-failed"))},Tv(`${Av()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw xs=null,e})}var xs=null;function fI(n){return xs=xs||dI(n),xs}var pI=new Cn(5e3,15e3),mI="__/auth/iframe",gI="emulator/auth/iframe",_I={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},yI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vI(n){let e=n.config;G(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Oc(e,gI):`https://${n.config.authDomain}/${mI}`,r={apiKey:e.apiKey,appName:n.name,v:Qt},i=yI.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${oi(r).slice(1)}`}function II(n){return y(this,null,function*(){let e=yield fI(n),t=ht().gapi;return G(t,n,"internal-error"),e.open({where:document.body,url:vI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_I,dontclear:!0},r=>new Promise((i,o)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=An(n,"network-request-failed"),u=ht().setTimeout(()=>{o(a)},pI.get());function h(){ht().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(a)})})))})}var wI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},EI=500,bI=600,TI="_blank",AI="http://localhost",qs=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function CI(n,e,t,r=EI,i=bI){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",h=Object.assign(Object.assign({},wI),{width:r.toString(),height:i.toString(),top:o,left:a}),d=be().toLowerCase();t&&(u=Jf(d)?TI:t),Kf(d)&&(e=e||AI,h.scrollbars="yes");let p=Object.entries(h).reduce((A,[S,V])=>`${A}${S}=${V},`,"");if(vv(d)&&u!=="_self")return SI(e||"",u),new qs(null);let I=window.open(e||"",u,p);G(I,n,"popup-blocked");try{I.focus()}catch{}return new qs(I)}function SI(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var PI="__/auth/handler",RI="emulator/auth/handler",DI=encodeURIComponent("fac");function Mf(n,e,t,r,i,o){return y(this,null,function*(){G(n.config.authDomain,n,"auth-domain-config-required"),G(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Qt,eventId:i};if(e instanceof Ls){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",cf(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,I]of Object.entries(o||{}))a[p]=I}if(e instanceof Ac){let p=e.getScopes().filter(I=>I!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let h=yield n._getAppCheckToken(),d=h?`#${DI}=${encodeURIComponent(h)}`:"";return`${xI(n)}?${oi(u).slice(1)}${d}`})}function xI({config:n}){return n.emulator?Oc(n,RI):`https://${n.authDomain}/${PI}`}var _c="webStorageSupport",kc=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Hc,this._completeRedirectFn=rI,this._overrideRedirectResult=eI}_openPopup(e,t,r,i){return y(this,null,function*(){var o;Xt((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let a=yield Mf(e,t,r,yc(),i);return CI(e,a,ap())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let o=yield Mf(e,t,r,yc(),i);return Lv(o),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Xt(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield II(e),r=new xc(e);return t.register("authEvent",i=>(G(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(_c,{type:_c},i=>{var o;let a=(o=i?.[0])===null||o===void 0?void 0:o[_c];a!==void 0&&t(!!a),Yt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=uI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return tp()||Qf()||jc()}},fp=kc;var Ff="@firebase/auth",Lf="1.7.9";var Nc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){G(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function kI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function NI(n){Kt(new tt("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;G(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:np(n)},d=new Tc(r,i,o,h);return Cv(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Kt(new tt("auth-internal",e=>{let t=Bc(e.getProvider("auth").getImmediate());return(r=>new Nc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ve(Ff,Lf,kI(n)),ve(Ff,Lf,"esm2017")}var VI=5*60,OI=Ja("authIdTokenMaxAge")||VI,Uf=null,MI=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>OI)return;let i=t?.token;Uf!==i&&(Uf=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function Kc(n=er()){let e=ui(n,"auth");if(e.isInitialized())return e.getImmediate();let t=zc(n,{popupRedirectResolver:fp,persistence:[hp,op,Hc]}),r=Ja("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let a=MI(o.toString());Wc(t,a,()=>a(t.currentUser)),$c(t,u=>a(u))}}let i=Ka("auth");return i&&Gc(t,`http://${i}`),t}function FI(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}bv({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=An("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",FI().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});NI("Browser");var pp="auth",_i=class{constructor(e){return e}},yi=class{constructor(){return li(pp)}};var Qc=new He("angularfire2.auth-instances");function xw(n,e){let t=As(pp,n,e);return t&&new _i(t)}function kw(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new _i(r)}}var Nw={provide:yi,deps:[[new et,Qc]]},Vw={provide:_i,useFactory:xw,deps:[[new et,Qc],Tt]};function mp(n,...e){return ve("angularfire",En.full,"auth"),Kn([Vw,Nw,{provide:Qc,useFactory:kw(n),multi:!0,deps:[Bt,yn,rr,bn,[new et,nr],...e]}])}var gp=ze(Kc,!0);var _p=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yp={};var Zt,Jc;(function(){var n;function e(w,m){function _(){}_.prototype=m.prototype,w.D=m.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(v,E,T){for(var g=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)g[yt-2]=arguments[yt];return m.prototype[E].apply(v,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,m,_){_||(_=0);var v=Array(16);if(typeof m=="string")for(var E=0;16>E;++E)v[E]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(E=0;16>E;++E)v[E]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=w.g[0],_=w.g[1],E=w.g[2];var T=w.g[3],g=m+(T^_&(E^T))+v[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+v[1]+3905402710&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+v[2]+606105819&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+v[3]+3250441966&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(T^_&(E^T))+v[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+v[5]+1200080426&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+v[6]+2821735955&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+v[7]+4249261313&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(T^_&(E^T))+v[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+v[9]+2336552879&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+v[10]+4294925233&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+v[11]+2304563134&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(T^_&(E^T))+v[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+v[13]+4254626195&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+v[14]+2792965006&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+v[15]+1236535329&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(E^T&(_^E))+v[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+v[6]+3225465664&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+v[11]+643717713&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+v[0]+3921069994&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^T&(_^E))+v[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+v[10]+38016083&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+v[15]+3634488961&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+v[4]+3889429448&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^T&(_^E))+v[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+v[14]+3275163606&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+v[3]+4107603335&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+v[8]+1163531501&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^T&(_^E))+v[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+v[2]+4243563512&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+v[7]+1735328473&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+v[12]+2368359562&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(_^E^T)+v[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+v[8]+2272392833&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+v[11]+1839030562&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+v[14]+4259657740&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^T)+v[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+v[4]+1272893353&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+v[7]+4139469664&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+v[10]+3200236656&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^T)+v[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+v[0]+3936430074&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+v[3]+3572445317&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+v[6]+76029189&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^T)+v[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+v[12]+3873151461&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+v[15]+530742520&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+v[2]+3299628645&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(E^(_|~T))+v[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+v[7]+1126891415&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+v[14]+2878612391&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+v[5]+4237533241&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~T))+v[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+v[3]+2399980690&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+v[10]+4293915773&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+v[1]+2240044497&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~T))+v[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+v[15]+4264355552&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+v[6]+2734768916&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+v[13]+1309151649&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~T))+v[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+v[11]+3174756917&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+v[2]+718787259&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+v[9]+3951481745&4294967295,w.g[0]=w.g[0]+m&4294967295,w.g[1]=w.g[1]+(E+(g<<21&4294967295|g>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+T&4294967295}r.prototype.u=function(w,m){m===void 0&&(m=w.length);for(var _=m-this.blockSize,v=this.B,E=this.h,T=0;T<m;){if(E==0)for(;T<=_;)i(this,w,T),T+=this.blockSize;if(typeof w=="string"){for(;T<m;)if(v[E++]=w.charCodeAt(T++),E==this.blockSize){i(this,v),E=0;break}}else for(;T<m;)if(v[E++]=w[T++],E==this.blockSize){i(this,v),E=0;break}}this.h=E,this.o+=m},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var m=1;m<w.length-8;++m)w[m]=0;var _=8*this.o;for(m=w.length-8;m<w.length;++m)w[m]=_&255,_/=256;for(this.u(w),w=Array(16),m=_=0;4>m;++m)for(var v=0;32>v;v+=8)w[_++]=this.g[m]>>>v&255;return w};function o(w,m){var _=u;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=m(w)}function a(w,m){this.h=m;for(var _=[],v=!0,E=w.length-1;0<=E;E--){var T=w[E]|0;v&&T==m||(_[E]=T,v=!1)}this.g=_}var u={};function h(w){return-128<=w&&128>w?o(w,function(m){return new a([m|0],0>m?-1:0)}):new a([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return I;if(0>w)return N(d(-w));for(var m=[],_=1,v=0;w>=_;v++)m[v]=w/_|0,_*=4294967296;return new a(m,0)}function p(w,m){if(w.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(w.charAt(0)=="-")return N(p(w.substring(1),m));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),v=I,E=0;E<w.length;E+=8){var T=Math.min(8,w.length-E),g=parseInt(w.substring(E,E+T),m);8>T?(T=d(Math.pow(m,T)),v=v.j(T).add(d(g))):(v=v.j(_),v=v.add(d(g)))}return v}var I=h(0),A=h(1),S=h(16777216);n=a.prototype,n.m=function(){if(F(this))return-N(this).m();for(var w=0,m=1,_=0;_<this.g.length;_++){var v=this.i(_);w+=(0<=v?v:4294967296+v)*m,m*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(V(this))return"0";if(F(this))return"-"+N(this).toString(w);for(var m=d(Math.pow(w,6)),_=this,v="";;){var E=ae(_,m).g;_=H(_,E.j(m));var T=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=E,V(_))return T+v;for(;6>T.length;)T="0"+T;v=T+v}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function V(w){if(w.h!=0)return!1;for(var m=0;m<w.g.length;m++)if(w.g[m]!=0)return!1;return!0}function F(w){return w.h==-1}n.l=function(w){return w=H(this,w),F(w)?-1:V(w)?0:1};function N(w){for(var m=w.g.length,_=[],v=0;v<m;v++)_[v]=~w.g[v];return new a(_,~w.h).add(A)}n.abs=function(){return F(this)?N(this):this},n.add=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0,E=0;E<=m;E++){var T=v+(this.i(E)&65535)+(w.i(E)&65535),g=(T>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);v=g>>>16,T&=65535,g&=65535,_[E]=g<<16|T}return new a(_,_[_.length-1]&-2147483648?-1:0)};function H(w,m){return w.add(N(m))}n.j=function(w){if(V(this)||V(w))return I;if(F(this))return F(w)?N(this).j(N(w)):N(N(this).j(w));if(F(w))return N(this.j(N(w)));if(0>this.l(S)&&0>w.l(S))return d(this.m()*w.m());for(var m=this.g.length+w.g.length,_=[],v=0;v<2*m;v++)_[v]=0;for(v=0;v<this.g.length;v++)for(var E=0;E<w.g.length;E++){var T=this.i(v)>>>16,g=this.i(v)&65535,yt=w.i(E)>>>16,Nr=w.i(E)&65535;_[2*v+2*E]+=g*Nr,J(_,2*v+2*E),_[2*v+2*E+1]+=T*Nr,J(_,2*v+2*E+1),_[2*v+2*E+1]+=g*yt,J(_,2*v+2*E+1),_[2*v+2*E+2]+=T*yt,J(_,2*v+2*E+2)}for(v=0;v<m;v++)_[v]=_[2*v+1]<<16|_[2*v];for(v=m;v<2*m;v++)_[v]=0;return new a(_,0)};function J(w,m){for(;(w[m]&65535)!=w[m];)w[m+1]+=w[m]>>>16,w[m]&=65535,m++}function Y(w,m){this.g=w,this.h=m}function ae(w,m){if(V(m))throw Error("division by zero");if(V(w))return new Y(I,I);if(F(w))return m=ae(N(w),m),new Y(N(m.g),N(m.h));if(F(m))return m=ae(w,N(m)),new Y(N(m.g),m.h);if(30<w.g.length){if(F(w)||F(m))throw Error("slowDivide_ only works with positive integers.");for(var _=A,v=m;0>=v.l(w);)_=Oe(_),v=Oe(v);var E=te(_,1),T=te(v,1);for(v=te(v,2),_=te(_,2);!V(v);){var g=T.add(v);0>=g.l(w)&&(E=E.add(_),T=g),v=te(v,1),_=te(_,1)}return m=H(w,E.j(m)),new Y(E,m)}for(E=I;0<=w.l(m);){for(_=Math.max(1,Math.floor(w.m()/m.m())),v=Math.ceil(Math.log(_)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),T=d(_),g=T.j(m);F(g)||0<g.l(w);)_-=v,T=d(_),g=T.j(m);V(T)&&(T=A),E=E.add(T),w=H(w,g)}return new Y(E,w)}n.A=function(w){return ae(this,w).h},n.and=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)&w.i(v);return new a(_,this.h&w.h)},n.or=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)|w.i(v);return new a(_,this.h|w.h)},n.xor=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)^w.i(v);return new a(_,this.h^w.h)};function Oe(w){for(var m=w.g.length+1,_=[],v=0;v<m;v++)_[v]=w.i(v)<<1|w.i(v-1)>>>31;return new a(_,w.h)}function te(w,m){var _=m>>5;m%=32;for(var v=w.g.length-_,E=[],T=0;T<v;T++)E[T]=0<m?w.i(T+_)>>>m|w.i(T+_+1)<<32-m:w.i(T+_);return new a(E,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Jc=yp.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,Zt=yp.Integer=a}).apply(typeof _p<"u"?_p:typeof self<"u"?self:typeof window<"u"?window:{});var Gs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},St={};var Yc,Xc,or,Zc,vi,$s,eu,tu,nu;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,l){return s==Array.prototype||s==Object.prototype||(s[c]=l.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof Gs=="object"&&Gs];for(var c=0;c<s.length;++c){var l=s[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var l=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var b=s[f];if(!(b in l))break e;l=l[b]}s=s[s.length-1],f=l[s],c=c(f),c!=f&&c!=null&&e(l,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var l=0,f=!1,b={next:function(){if(!f&&l<s.length){var C=l++;return{value:c(C,s[C]),done:!1}}return f=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function p(s,c,l){return s.call.apply(s.bind,arguments)}function I(s,c,l){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,f),s.apply(c,b)}}return function(){return s.apply(c,arguments)}}function A(s,c,l){return A=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:I,A.apply(null,arguments)}function S(s,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function V(s,c){function l(){}l.prototype=c.prototype,s.aa=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.Qb=function(f,b,C){for(var k=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)k[ne-2]=arguments[ne];return c.prototype[b].apply(f,k)}}function F(s){let c=s.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=s[f];return l}return[]}function N(s,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let b=s.length||0,C=f.length||0;s.length=b+C;for(let k=0;k<C;k++)s[b+k]=f[k]}else s.push(f)}}class H{constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function J(s){return/^[\s\xa0]*$/.test(s)}function Y(){var s=u.navigator;return s&&(s=s.userAgent)?s:""}function ae(s){return ae[" "](s),s}ae[" "]=function(){};var Oe=Y().indexOf("Gecko")!=-1&&!(Y().toLowerCase().indexOf("webkit")!=-1&&Y().indexOf("Edge")==-1)&&!(Y().indexOf("Trident")!=-1||Y().indexOf("MSIE")!=-1)&&Y().indexOf("Edge")==-1;function te(s,c,l){for(let f in s)c.call(l,s[f],f,s)}function w(s,c){for(let l in s)c.call(void 0,s[l],l,s)}function m(s){let c={};for(let l in s)c[l]=s[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(s,c){let l,f;for(let b=1;b<arguments.length;b++){f=arguments[b];for(l in f)s[l]=f[l];for(let C=0;C<_.length;C++)l=_[C],Object.prototype.hasOwnProperty.call(f,l)&&(s[l]=f[l])}}function E(s){var c=1;s=s.split(":");let l=[];for(;0<c&&s.length;)l.push(s.shift()),c--;return s.length&&l.push(s.join(":")),l}function T(s){u.setTimeout(()=>{throw s},0)}function g(){var s=ha;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class yt{constructor(){this.h=this.g=null}add(c,l){let f=Nr.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var Nr=new H(()=>new s_,s=>s.reset());class s_{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let Vr,Or=!1,ha=new yt,Th=()=>{let s=u.Promise.resolve(void 0);Vr=()=>{s.then(o_)}};var o_=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(l){T(l)}var c=Nr;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}Or=!1};function Ot(){this.s=this.s,this.C=this.C}Ot.prototype.s=!1,Ot.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ot.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Pe(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}Pe.prototype.h=function(){this.defaultPrevented=!0};var a_=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return s}();function Mr(s,c){if(Pe.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var l=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(Oe){e:{try{ae(c.nodeName);var b=!0;break e}catch{}b=!1}b||(c=null)}}else l=="mouseover"?c=s.fromElement:l=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:c_[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&Mr.aa.h.call(this)}}V(Mr,Pe);var c_={2:"touch",3:"pen",4:"mouse"};Mr.prototype.h=function(){Mr.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var Fr="closure_listenable_"+(1e6*Math.random()|0),u_=0;function l_(s,c,l,f,b){this.listener=s,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=b,this.key=++u_,this.da=this.fa=!1}function Yi(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Xi(s){this.src=s,this.g={},this.h=0}Xi.prototype.add=function(s,c,l,f,b){var C=s.toString();s=this.g[C],s||(s=this.g[C]=[],this.h++);var k=fa(s,c,f,b);return-1<k?(c=s[k],l||(c.fa=!1)):(c=new l_(c,this.src,C,!!f,b),c.fa=l,s.push(c)),c};function da(s,c){var l=c.type;if(l in s.g){var f=s.g[l],b=Array.prototype.indexOf.call(f,c,void 0),C;(C=0<=b)&&Array.prototype.splice.call(f,b,1),C&&(Yi(c),s.g[l].length==0&&(delete s.g[l],s.h--))}}function fa(s,c,l,f){for(var b=0;b<s.length;++b){var C=s[b];if(!C.da&&C.listener==c&&C.capture==!!l&&C.ha==f)return b}return-1}var pa="closure_lm_"+(1e6*Math.random()|0),ma={};function Ah(s,c,l,f,b){if(f&&f.once)return Sh(s,c,l,f,b);if(Array.isArray(c)){for(var C=0;C<c.length;C++)Ah(s,c[C],l,f,b);return null}return l=va(l),s&&s[Fr]?s.K(c,l,d(f)?!!f.capture:!!f,b):Ch(s,c,l,!1,f,b)}function Ch(s,c,l,f,b,C){if(!c)throw Error("Invalid event type");var k=d(b)?!!b.capture:!!b,ne=_a(s);if(ne||(s[pa]=ne=new Xi(s)),l=ne.add(c,l,f,k,C),l.proxy)return l;if(f=h_(),l.proxy=f,f.src=s,f.listener=l,s.addEventListener)a_||(b=k),b===void 0&&(b=!1),s.addEventListener(c.toString(),f,b);else if(s.attachEvent)s.attachEvent(Rh(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function h_(){function s(l){return c.call(s.src,s.listener,l)}let c=d_;return s}function Sh(s,c,l,f,b){if(Array.isArray(c)){for(var C=0;C<c.length;C++)Sh(s,c[C],l,f,b);return null}return l=va(l),s&&s[Fr]?s.L(c,l,d(f)?!!f.capture:!!f,b):Ch(s,c,l,!0,f,b)}function Ph(s,c,l,f,b){if(Array.isArray(c))for(var C=0;C<c.length;C++)Ph(s,c[C],l,f,b);else f=d(f)?!!f.capture:!!f,l=va(l),s&&s[Fr]?(s=s.i,c=String(c).toString(),c in s.g&&(C=s.g[c],l=fa(C,l,f,b),-1<l&&(Yi(C[l]),Array.prototype.splice.call(C,l,1),C.length==0&&(delete s.g[c],s.h--)))):s&&(s=_a(s))&&(c=s.g[c.toString()],s=-1,c&&(s=fa(c,l,f,b)),(l=-1<s?c[s]:null)&&ga(l))}function ga(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[Fr])da(c.i,s);else{var l=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(l,f,s.capture):c.detachEvent?c.detachEvent(Rh(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=_a(c))?(da(l,s),l.h==0&&(l.src=null,c[pa]=null)):Yi(s)}}}function Rh(s){return s in ma?ma[s]:ma[s]="on"+s}function d_(s,c){if(s.da)s=!0;else{c=new Mr(c,this);var l=s.listener,f=s.ha||s.src;s.fa&&ga(s),s=l.call(f,c)}return s}function _a(s){return s=s[pa],s instanceof Xi?s:null}var ya="__closure_events_fn_"+(1e9*Math.random()>>>0);function va(s){return typeof s=="function"?s:(s[ya]||(s[ya]=function(c){return s.handleEvent(c)}),s[ya])}function Re(){Ot.call(this),this.i=new Xi(this),this.M=this,this.F=null}V(Re,Ot),Re.prototype[Fr]=!0,Re.prototype.removeEventListener=function(s,c,l,f){Ph(this,s,c,l,f)};function Me(s,c){var l,f=s.F;if(f)for(l=[];f;f=f.F)l.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new Pe(c,s);else if(c instanceof Pe)c.target=c.target||s;else{var b=c;c=new Pe(f,s),v(c,b)}if(b=!0,l)for(var C=l.length-1;0<=C;C--){var k=c.g=l[C];b=Zi(k,f,!0,c)&&b}if(k=c.g=s,b=Zi(k,f,!0,c)&&b,b=Zi(k,f,!1,c)&&b,l)for(C=0;C<l.length;C++)k=c.g=l[C],b=Zi(k,f,!1,c)&&b}Re.prototype.N=function(){if(Re.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var l=s.g[c],f=0;f<l.length;f++)Yi(l[f]);delete s.g[c],s.h--}}this.F=null},Re.prototype.K=function(s,c,l,f){return this.i.add(String(s),c,!1,l,f)},Re.prototype.L=function(s,c,l,f){return this.i.add(String(s),c,!0,l,f)};function Zi(s,c,l,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var b=!0,C=0;C<c.length;++C){var k=c[C];if(k&&!k.da&&k.capture==l){var ne=k.listener,Ce=k.ha||k.src;k.fa&&da(s.i,k),b=ne.call(Ce,f)!==!1&&b}}return b&&!f.defaultPrevented}function Dh(s,c,l){if(typeof s=="function")l&&(s=A(s,l));else if(s&&typeof s.handleEvent=="function")s=A(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(s,c||0)}function xh(s){s.g=Dh(()=>{s.g=null,s.i&&(s.i=!1,xh(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class f_ extends Ot{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:xh(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lr(s){Ot.call(this),this.h=s,this.g={}}V(Lr,Ot);var kh=[];function Nh(s){te(s.g,function(c,l){this.g.hasOwnProperty(l)&&ga(c)},s),s.g={}}Lr.prototype.N=function(){Lr.aa.N.call(this),Nh(this)},Lr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ia=u.JSON.stringify,p_=u.JSON.parse,m_=class{stringify(s){return u.JSON.stringify(s,void 0)}parse(s){return u.JSON.parse(s,void 0)}};function wa(){}wa.prototype.h=null;function Vh(s){return s.h||(s.h=s.i())}function Oh(){}var Ur={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ea(){Pe.call(this,"d")}V(Ea,Pe);function ba(){Pe.call(this,"c")}V(ba,Pe);var fn={},Mh=null;function es(){return Mh=Mh||new Re}fn.La="serverreachability";function Fh(s){Pe.call(this,fn.La,s)}V(Fh,Pe);function jr(s){let c=es();Me(c,new Fh(c))}fn.STAT_EVENT="statevent";function Lh(s,c){Pe.call(this,fn.STAT_EVENT,s),this.stat=c}V(Lh,Pe);function Fe(s){let c=es();Me(c,new Lh(c,s))}fn.Ma="timingevent";function Uh(s,c){Pe.call(this,fn.Ma,s),this.size=c}V(Uh,Pe);function Br(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){s()},c)}function qr(){this.g=!0}qr.prototype.xa=function(){this.g=!1};function g_(s,c,l,f,b,C){s.info(function(){if(s.g)if(C)for(var k="",ne=C.split("&"),Ce=0;Ce<ne.length;Ce++){var Z=ne[Ce].split("=");if(1<Z.length){var De=Z[0];Z=Z[1];var xe=De.split("_");k=2<=xe.length&&xe[1]=="type"?k+(De+"="+Z+"&"):k+(De+"=redacted&")}}else k=null;else k=C;return"XMLHTTP REQ ("+f+") [attempt "+b+"]: "+c+`
`+l+`
`+k})}function __(s,c,l,f,b,C,k){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+b+"]: "+c+`
`+l+`
`+C+" "+k})}function Gn(s,c,l,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+v_(s,l)+(f?" "+f:"")})}function y_(s,c){s.info(function(){return"TIMEOUT: "+c})}qr.prototype.info=function(){};function v_(s,c){if(!s.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(s=0;s<l.length;s++)if(Array.isArray(l[s])){var f=l[s];if(!(2>f.length)){var b=f[1];if(Array.isArray(b)&&!(1>b.length)){var C=b[0];if(C!="noop"&&C!="stop"&&C!="close")for(var k=1;k<b.length;k++)b[k]=""}}}}return Ia(l)}catch{return c}}var ts={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},jh={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ta;function ns(){}V(ns,wa),ns.prototype.g=function(){return new XMLHttpRequest},ns.prototype.i=function(){return{}},Ta=new ns;function Mt(s,c,l,f){this.j=s,this.i=c,this.l=l,this.R=f||1,this.U=new Lr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Bh}function Bh(){this.i=null,this.g="",this.h=!1}var qh={},Aa={};function Ca(s,c,l){s.L=1,s.v=os(vt(c)),s.m=l,s.P=!0,zh(s,null)}function zh(s,c){s.F=Date.now(),rs(s),s.A=vt(s.v);var l=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),rd(l.i,"t",f),s.C=0,l=s.j.J,s.h=new Bh,s.g=wd(s.j,l?c:null,!s.m),0<s.O&&(s.M=new f_(A(s.Y,s,s.g),s.O)),c=s.U,l=s.g,f=s.ca;var b="readystatechange";Array.isArray(b)||(b&&(kh[0]=b.toString()),b=kh);for(var C=0;C<b.length;C++){var k=Ah(l,b[C],f||c.handleEvent,!1,c.h||c);if(!k)break;c.g[k.key]=k}c=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),jr(),g_(s.i,s.u,s.A,s.l,s.R,s.m)}Mt.prototype.ca=function(s){s=s.target;let c=this.M;c&&It(s)==3?c.j():this.Y(s)},Mt.prototype.Y=function(s){try{if(s==this.g)e:{let xe=It(this.g);var c=this.g.Ba();let Hn=this.g.Z();if(!(3>xe)&&(xe!=3||this.g&&(this.h.h||this.g.oa()||ld(this.g)))){this.J||xe!=4||c==7||(c==8||0>=Hn?jr(3):jr(2)),Sa(this);var l=this.g.Z();this.X=l;t:if(Gh(this)){var f=ld(this.g);s="";var b=f.length,C=It(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){pn(this),zr(this);var k="";break t}this.h.i=new u.TextDecoder}for(c=0;c<b;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(C&&c==b-1)});f.length=0,this.h.g+=s,this.C=0,k=this.h.g}else k=this.g.oa();if(this.o=l==200,__(this.i,this.u,this.A,this.l,this.R,xe,l),this.o){if(this.T&&!this.K){t:{if(this.g){var ne,Ce=this.g;if((ne=Ce.g?Ce.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!J(ne)){var Z=ne;break t}}Z=null}if(l=Z)Gn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pa(this,l);else{this.o=!1,this.s=3,Fe(12),pn(this),zr(this);break e}}if(this.P){l=!0;let rt;for(;!this.J&&this.C<k.length;)if(rt=I_(this,k),rt==Aa){xe==4&&(this.s=4,Fe(14),l=!1),Gn(this.i,this.l,null,"[Incomplete Response]");break}else if(rt==qh){this.s=4,Fe(15),Gn(this.i,this.l,k,"[Invalid Chunk]"),l=!1;break}else Gn(this.i,this.l,rt,null),Pa(this,rt);if(Gh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xe!=4||k.length!=0||this.h.h||(this.s=1,Fe(16),l=!1),this.o=this.o&&l,!l)Gn(this.i,this.l,k,"[Invalid Chunked Response]"),pn(this),zr(this);else if(0<k.length&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.ba&&!De.M&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),Va(De),De.M=!0,Fe(11))}}else Gn(this.i,this.l,k,null),Pa(this,k);xe==4&&pn(this),this.o&&!this.J&&(xe==4?_d(this.j,this):(this.o=!1,rs(this)))}else F_(this.g),l==400&&0<k.indexOf("Unknown SID")?(this.s=3,Fe(12)):(this.s=0,Fe(13)),pn(this),zr(this)}}}catch{}finally{}};function Gh(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function I_(s,c){var l=s.C,f=c.indexOf(`
`,l);return f==-1?Aa:(l=Number(c.substring(l,f)),isNaN(l)?qh:(f+=1,f+l>c.length?Aa:(c=c.slice(f,f+l),s.C=f+l,c)))}Mt.prototype.cancel=function(){this.J=!0,pn(this)};function rs(s){s.S=Date.now()+s.I,$h(s,s.I)}function $h(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=Br(A(s.ba,s),c)}function Sa(s){s.B&&(u.clearTimeout(s.B),s.B=null)}Mt.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(y_(this.i,this.A),this.L!=2&&(jr(),Fe(17)),pn(this),this.s=2,zr(this)):$h(this,this.S-s)};function zr(s){s.j.G==0||s.J||_d(s.j,s)}function pn(s){Sa(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,Nh(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function Pa(s,c){try{var l=s.j;if(l.G!=0&&(l.g==s||Ra(l.h,s))){if(!s.K&&Ra(l.h,s)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var b=f;if(b[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<s.F)hs(l),us(l);else break e;Na(l),Fe(18)}}else l.za=b[1],0<l.za-l.T&&37500>b[2]&&l.F&&l.v==0&&!l.C&&(l.C=Br(A(l.Za,l),6e3));if(1>=Kh(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else gn(l,11)}else if((s.K||l.g==s)&&hs(l),!J(c))for(b=l.Da.g.parse(c),c=0;c<b.length;c++){let Z=b[c];if(l.T=Z[0],Z=Z[1],l.G==2)if(Z[0]=="c"){l.K=Z[1],l.ia=Z[2];let De=Z[3];De!=null&&(l.la=De,l.j.info("VER="+l.la));let xe=Z[4];xe!=null&&(l.Aa=xe,l.j.info("SVER="+l.Aa));let Hn=Z[5];Hn!=null&&typeof Hn=="number"&&0<Hn&&(f=1.5*Hn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let rt=s.g;if(rt){let fs=rt.g?rt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fs){var C=f.h;C.g||fs.indexOf("spdy")==-1&&fs.indexOf("quic")==-1&&fs.indexOf("h2")==-1||(C.j=C.l,C.g=new Set,C.h&&(Da(C,C.h),C.h=null))}if(f.D){let Oa=rt.g?rt.g.getResponseHeader("X-HTTP-Session-Id"):null;Oa&&(f.ya=Oa,ce(f.I,f.D,Oa))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-s.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var k=s;if(f.qa=Id(f,f.J?f.ia:null,f.W),k.K){Qh(f.h,k);var ne=k,Ce=f.L;Ce&&(ne.I=Ce),ne.B&&(Sa(ne),rs(ne)),f.g=k}else md(f);0<l.i.length&&ls(l)}else Z[0]!="stop"&&Z[0]!="close"||gn(l,7);else l.G==3&&(Z[0]=="stop"||Z[0]=="close"?Z[0]=="stop"?gn(l,7):ka(l):Z[0]!="noop"&&l.l&&l.l.ta(Z),l.v=0)}}jr(4)}catch{}}var w_=class{constructor(s,c){this.g=s,this.map=c}};function Wh(s){this.l=s||10,u.PerformanceNavigationTiming?(s=u.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Hh(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Kh(s){return s.h?1:s.g?s.g.size:0}function Ra(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function Da(s,c){s.g?s.g.add(c):s.h=c}function Qh(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}Wh.prototype.cancel=function(){if(this.i=Jh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function Jh(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let l of s.g.values())c=c.concat(l.D);return c}return F(s.i)}function E_(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],l=s.length,f=0;f<l;f++)c.push(s[f]);return c}c=[],l=0;for(f in s)c[l++]=s[f];return c}function b_(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var l=0;l<s;l++)c.push(l);return c}c=[],l=0;for(let f in s)c[l++]=f;return c}}}function Yh(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var l=b_(s),f=E_(s),b=f.length,C=0;C<b;C++)c.call(void 0,f[C],l&&l[C],s)}var Xh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function T_(s,c){if(s){s=s.split("&");for(var l=0;l<s.length;l++){var f=s[l].indexOf("="),b=null;if(0<=f){var C=s[l].substring(0,f);b=s[l].substring(f+1)}else C=s[l];c(C,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function mn(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof mn){this.h=s.h,is(this,s.j),this.o=s.o,this.g=s.g,ss(this,s.s),this.l=s.l;var c=s.i,l=new Wr;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),Zh(this,l),this.m=s.m}else s&&(c=String(s).match(Xh))?(this.h=!1,is(this,c[1]||"",!0),this.o=Gr(c[2]||""),this.g=Gr(c[3]||"",!0),ss(this,c[4]),this.l=Gr(c[5]||"",!0),Zh(this,c[6]||"",!0),this.m=Gr(c[7]||"")):(this.h=!1,this.i=new Wr(null,this.h))}mn.prototype.toString=function(){var s=[],c=this.j;c&&s.push($r(c,ed,!0),":");var l=this.g;return(l||c=="file")&&(s.push("//"),(c=this.o)&&s.push($r(c,ed,!0),"@"),s.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&s.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push($r(l,l.charAt(0)=="/"?S_:C_,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",$r(l,R_)),s.join("")};function vt(s){return new mn(s)}function is(s,c,l){s.j=l?Gr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function ss(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function Zh(s,c,l){c instanceof Wr?(s.i=c,D_(s.i,s.h)):(l||(c=$r(c,P_)),s.i=new Wr(c,s.h))}function ce(s,c,l){s.i.set(c,l)}function os(s){return ce(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function Gr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function $r(s,c,l){return typeof s=="string"?(s=encodeURI(s).replace(c,A_),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function A_(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var ed=/[#\/\?@]/g,C_=/[#\?:]/g,S_=/[#\?]/g,P_=/[#\?@]/g,R_=/#/g;function Wr(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function Ft(s){s.g||(s.g=new Map,s.h=0,s.i&&T_(s.i,function(c,l){s.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=Wr.prototype,n.add=function(s,c){Ft(this),this.i=null,s=$n(this,s);var l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(c),this.h+=1,this};function td(s,c){Ft(s),c=$n(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function nd(s,c){return Ft(s),c=$n(s,c),s.g.has(c)}n.forEach=function(s,c){Ft(this),this.g.forEach(function(l,f){l.forEach(function(b){s.call(c,b,f,this)},this)},this)},n.na=function(){Ft(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let b=s[f];for(let C=0;C<b.length;C++)l.push(c[f])}return l},n.V=function(s){Ft(this);let c=[];if(typeof s=="string")nd(this,s)&&(c=c.concat(this.g.get($n(this,s))));else{s=Array.from(this.g.values());for(let l=0;l<s.length;l++)c=c.concat(s[l])}return c},n.set=function(s,c){return Ft(this),this.i=null,s=$n(this,s),nd(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function rd(s,c,l){td(s,c),0<l.length&&(s.i=null,s.g.set($n(s,c),F(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let C=encodeURIComponent(String(f)),k=this.V(f);for(f=0;f<k.length;f++){var b=C;k[f]!==""&&(b+="="+encodeURIComponent(String(k[f]))),s.push(b)}}return this.i=s.join("&")};function $n(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function D_(s,c){c&&!s.j&&(Ft(s),s.i=null,s.g.forEach(function(l,f){var b=f.toLowerCase();f!=b&&(td(this,f),rd(this,b,l))},s)),s.j=c}function x_(s,c){let l=new qr;if(u.Image){let f=new Image;f.onload=S(Lt,l,"TestLoadImage: loaded",!0,c,f),f.onerror=S(Lt,l,"TestLoadImage: error",!1,c,f),f.onabort=S(Lt,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=S(Lt,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function k_(s,c){let l=new qr,f=new AbortController,b=setTimeout(()=>{f.abort(),Lt(l,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(C=>{clearTimeout(b),C.ok?Lt(l,"TestPingServer: ok",!0,c):Lt(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(b),Lt(l,"TestPingServer: error",!1,c)})}function Lt(s,c,l,f,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),f(l)}catch{}}function N_(){this.g=new m_}function V_(s,c,l){let f=l||"";try{Yh(s,function(b,C){let k=b;d(b)&&(k=Ia(b)),c.push(f+C+"="+encodeURIComponent(k))})}catch(b){throw c.push(f+"type="+encodeURIComponent("_badmap")),b}}function Hr(s){this.l=s.Ub||null,this.j=s.eb||!1}V(Hr,wa),Hr.prototype.g=function(){return new as(this.l,this.j)},Hr.prototype.i=function(s){return function(){return s}}({});function as(s,c){Re.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}V(as,Re),n=as.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,Qr(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Kr(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Qr(this)),this.g&&(this.readyState=3,Qr(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;id(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function id(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?Kr(this):Qr(this),this.readyState==3&&id(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,Kr(this))},n.Qa=function(s){this.g&&(this.response=s,Kr(this))},n.ga=function(){this.g&&Kr(this)};function Kr(s){s.readyState=4,s.l=null,s.j=null,s.v=null,Qr(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=c.next();return s.join(`\r
`)};function Qr(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(as.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function sd(s){let c="";return te(s,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function xa(s,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=sd(l),typeof s=="string"?l!=null&&encodeURIComponent(String(l)):ce(s,c,l))}function de(s){Re.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}V(de,Re);var O_=/^https?$/i,M_=["POST","PUT"];n=de.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ta.g(),this.v=this.o?Vh(this.o):Vh(Ta),this.g.onreadystatechange=A(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(C){od(this,C);return}if(s=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var b in f)l.set(b,f[b]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let C of f.keys())l.set(C,f.get(C));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(C=>C.toLowerCase()=="content-type"),b=u.FormData&&s instanceof u.FormData,!(0<=Array.prototype.indexOf.call(M_,c,void 0))||f||b||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[C,k]of l)this.g.setRequestHeader(C,k);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ud(this),this.u=!0,this.g.send(s),this.u=!1}catch(C){od(this,C)}};function od(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,ad(s),cs(s)}function ad(s){s.A||(s.A=!0,Me(s,"complete"),Me(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,Me(this,"complete"),Me(this,"abort"),cs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),cs(this,!0)),de.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?cd(this):this.bb())},n.bb=function(){cd(this)};function cd(s){if(s.h&&typeof a<"u"&&(!s.v[1]||It(s)!=4||s.Z()!=2)){if(s.u&&It(s)==4)Dh(s.Ea,0,s);else if(Me(s,"readystatechange"),It(s)==4){s.h=!1;try{let k=s.Z();e:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=k===0){var b=String(s.D).match(Xh)[1]||null;!b&&u.self&&u.self.location&&(b=u.self.location.protocol.slice(0,-1)),f=!O_.test(b?b.toLowerCase():"")}l=f}if(l)Me(s,"complete"),Me(s,"success");else{s.m=6;try{var C=2<It(s)?s.g.statusText:""}catch{C=""}s.l=C+" ["+s.Z()+"]",ad(s)}}finally{cs(s)}}}}function cs(s,c){if(s.g){ud(s);let l=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||Me(s,"ready");try{l.onreadystatechange=f}catch{}}}function ud(s){s.I&&(u.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function It(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<It(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),p_(c)}};function ld(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function F_(s){let c={};s=(s.g&&2<=It(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(J(s[f]))continue;var l=E(s[f]);let b=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let C=c[b]||[];c[b]=C,C.push(l)}w(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Jr(s,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||c}function hd(s){this.Aa=0,this.i=[],this.j=new qr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Jr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Jr("baseRetryDelayMs",5e3,s),this.cb=Jr("retryDelaySeedMs",1e4,s),this.Wa=Jr("forwardChannelMaxRetries",2,s),this.wa=Jr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new Wh(s&&s.concurrentRequestLimit),this.Da=new N_,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=hd.prototype,n.la=8,n.G=1,n.connect=function(s,c,l,f){Fe(0),this.W=s,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=Id(this,null,this.W),ls(this)};function ka(s){if(dd(s),s.G==3){var c=s.U++,l=vt(s.I);if(ce(l,"SID",s.K),ce(l,"RID",c),ce(l,"TYPE","terminate"),Yr(s,l),c=new Mt(s,s.j,c),c.L=2,c.v=os(vt(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=wd(c.j,null),c.g.ea(c.v)),c.F=Date.now(),rs(c)}vd(s)}function us(s){s.g&&(Va(s),s.g.cancel(),s.g=null)}function dd(s){us(s),s.u&&(u.clearTimeout(s.u),s.u=null),hs(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&u.clearTimeout(s.s),s.s=null)}function ls(s){if(!Hh(s.h)&&!s.s){s.s=!0;var c=s.Ga;Vr||Th(),Or||(Vr(),Or=!0),ha.add(c,s),s.B=0}}function L_(s,c){return Kh(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=Br(A(s.Ga,s,c),yd(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let b=new Mt(this,this.j,s),C=this.o;if(this.S&&(C?(C=m(C),v(C,this.S)):C=this.S),this.m!==null||this.O||(b.H=C,C=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=pd(this,b,c),l=vt(this.I),ce(l,"RID",s),ce(l,"CVER",22),this.D&&ce(l,"X-HTTP-Session-Id",this.D),Yr(this,l),C&&(this.O?c="headers="+encodeURIComponent(String(sd(C)))+"&"+c:this.m&&xa(l,this.m,C)),Da(this.h,b),this.Ua&&ce(l,"TYPE","init"),this.P?(ce(l,"$req",c),ce(l,"SID","null"),b.T=!0,Ca(b,l,null)):Ca(b,l,c),this.G=2}}else this.G==3&&(s?fd(this,s):this.i.length==0||Hh(this.h)||fd(this))};function fd(s,c){var l;c?l=c.l:l=s.U++;let f=vt(s.I);ce(f,"SID",s.K),ce(f,"RID",l),ce(f,"AID",s.T),Yr(s,f),s.m&&s.o&&xa(f,s.m,s.o),l=new Mt(s,s.j,l,s.B+1),s.m===null&&(l.H=s.o),c&&(s.i=c.D.concat(s.i)),c=pd(s,l,1e3),l.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),Da(s.h,l),Ca(l,f,c)}function Yr(s,c){s.H&&te(s.H,function(l,f){ce(c,f,l)}),s.l&&Yh({},function(l,f){ce(c,f,l)})}function pd(s,c,l){l=Math.min(s.i.length,l);var f=s.l?A(s.l.Na,s.l,s):null;e:{var b=s.i;let C=-1;for(;;){let k=["count="+l];C==-1?0<l?(C=b[0].g,k.push("ofs="+C)):C=0:k.push("ofs="+C);let ne=!0;for(let Ce=0;Ce<l;Ce++){let Z=b[Ce].g,De=b[Ce].map;if(Z-=C,0>Z)C=Math.max(0,b[Ce].g-100),ne=!1;else try{V_(De,k,"req"+Z+"_")}catch{f&&f(De)}}if(ne){f=k.join("&");break e}}}return s=s.i.splice(0,l),c.D=s,f}function md(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;Vr||Th(),Or||(Vr(),Or=!0),ha.add(c,s),s.v=0}}function Na(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=Br(A(s.Fa,s),yd(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,gd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=Br(A(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Fe(10),us(this),gd(this))};function Va(s){s.A!=null&&(u.clearTimeout(s.A),s.A=null)}function gd(s){s.g=new Mt(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=vt(s.qa);ce(c,"RID","rpc"),ce(c,"SID",s.K),ce(c,"AID",s.T),ce(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&ce(c,"TO",s.ja),ce(c,"TYPE","xmlhttp"),Yr(s,c),s.m&&s.o&&xa(c,s.m,s.o),s.L&&(s.g.I=s.L);var l=s.g;s=s.ia,l.L=1,l.v=os(vt(c)),l.m=null,l.P=!0,zh(l,s)}n.Za=function(){this.C!=null&&(this.C=null,us(this),Na(this),Fe(19))};function hs(s){s.C!=null&&(u.clearTimeout(s.C),s.C=null)}function _d(s,c){var l=null;if(s.g==c){hs(s),Va(s),s.g=null;var f=2}else if(Ra(s.h,c))l=c.D,Qh(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var b=s.B;f=es(),Me(f,new Uh(f,l)),ls(s)}else md(s);else if(b=c.s,b==3||b==0&&0<c.X||!(f==1&&L_(s,c)||f==2&&Na(s)))switch(l&&0<l.length&&(c=s.h,c.i=c.i.concat(l)),b){case 1:gn(s,5);break;case 4:gn(s,10);break;case 3:gn(s,6);break;default:gn(s,2)}}}function yd(s,c){let l=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(l*=2),l*c}function gn(s,c){if(s.j.info("Error code "+c),c==2){var l=A(s.fb,s),f=s.Xa;let b=!f;f=new mn(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||is(f,"https"),os(f),b?x_(f.toString(),l):k_(f.toString(),l)}else Fe(2);s.G=0,s.l&&s.l.sa(c),vd(s),dd(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),Fe(2)):(this.j.info("Failed to ping google.com"),Fe(1))};function vd(s){if(s.G=0,s.ka=[],s.l){let c=Jh(s.h);(c.length!=0||s.i.length!=0)&&(N(s.ka,c),N(s.ka,s.i),s.h.i.length=0,F(s.i),s.i.length=0),s.l.ra()}}function Id(s,c,l){var f=l instanceof mn?vt(l):new mn(l);if(f.g!="")c&&(f.g=c+"."+f.g),ss(f,f.s);else{var b=u.location;f=b.protocol,c=c?c+"."+b.hostname:b.hostname,b=+b.port;var C=new mn(null);f&&is(C,f),c&&(C.g=c),b&&ss(C,b),l&&(C.l=l),f=C}return l=s.D,c=s.ya,l&&c&&ce(f,l,c),ce(f,"VER",s.la),Yr(s,f),f}function wd(s,c,l){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new de(new Hr({eb:l})):new de(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ed(){}n=Ed.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ds(){}ds.prototype.g=function(s,c){return new We(s,c)};function We(s,c){Re.call(this),this.g=new hd(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!J(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!J(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new Wn(this)}V(We,Re),We.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},We.prototype.close=function(){ka(this.g)},We.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.u&&(l={},l.__data__=Ia(s),s=l);c.i.push(new w_(c.Ya++,s)),c.G==3&&ls(c)},We.prototype.N=function(){this.g.l=null,delete this.j,ka(this.g),delete this.g,We.aa.N.call(this)};function bd(s){Ea.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let l in c){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}V(bd,Ea);function Td(){ba.call(this),this.status=1}V(Td,ba);function Wn(s){this.g=s}V(Wn,Ed),Wn.prototype.ua=function(){Me(this.g,"a")},Wn.prototype.ta=function(s){Me(this.g,new bd(s))},Wn.prototype.sa=function(s){Me(this.g,new Td)},Wn.prototype.ra=function(){Me(this.g,"b")},ds.prototype.createWebChannel=ds.prototype.g,We.prototype.send=We.prototype.o,We.prototype.open=We.prototype.m,We.prototype.close=We.prototype.close,nu=St.createWebChannelTransport=function(){return new ds},tu=St.getStatEventTarget=function(){return es()},eu=St.Event=fn,$s=St.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ts.NO_ERROR=0,ts.TIMEOUT=8,ts.HTTP_ERROR=6,vi=St.ErrorCode=ts,jh.COMPLETE="complete",Zc=St.EventType=jh,Oh.EventType=Ur,Ur.OPEN="a",Ur.CLOSE="b",Ur.ERROR="c",Ur.MESSAGE="d",Re.prototype.listen=Re.prototype.K,or=St.WebChannel=Oh,Xc=St.FetchXmlHttpFactory=Hr,de.prototype.listenOnce=de.prototype.L,de.prototype.getLastError=de.prototype.Ka,de.prototype.getLastErrorCode=de.prototype.Ba,de.prototype.getStatus=de.prototype.Z,de.prototype.getResponseJson=de.prototype.Oa,de.prototype.getResponseText=de.prototype.oa,de.prototype.send=de.prototype.ea,de.prototype.setWithCredentials=de.prototype.Ha,Yc=St.XhrIo=de}).apply(typeof Gs<"u"?Gs:typeof self<"u"?self:typeof window<"u"?window:{});var vp="@firebase/firestore";var Ae=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ae.UNAUTHENTICATED=new Ae(null),Ae.GOOGLE_CREDENTIALS=new Ae("google-credentials-uid"),Ae.FIRST_PARTY=new Ae("first-party-uid"),Ae.MOCK_USER=new Ae("mock-user");var Ar="10.13.2";var kn=new Wt("@firebase/firestore");function Ii(){return kn.logLevel}function L(n,...e){if(kn.logLevel<=K.DEBUG){let t=e.map(Gl);kn.debug(`Firestore (${Ar}): ${n}`,...t)}}function Rt(n,...e){if(kn.logLevel<=K.ERROR){let t=e.map(Gl);kn.error(`Firestore (${Ar}): ${n}`,...t)}}function fr(n,...e){if(kn.logLevel<=K.WARN){let t=e.map(Gl);kn.warn(`Firestore (${Ar}): ${n}`,...t)}}function Gl(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function z(n="Unexpected state"){let e=`FIRESTORE (${Ar}) INTERNAL ASSERTION FAILED: `+n;throw Rt(e),new Error(e)}function ie(n,e){n||z()}function $(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends Qe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Pt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Js=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},au=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ae.UNAUTHENTICATED))}shutdown(){}},cu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},uu=class{constructor(e){this.t=e,this.currentUser=Ae.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new Pt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Pt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>y(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},u=h=>{L("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(L("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Pt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(L("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ie(typeof r.accessToken=="string"),new Js(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return ie(e===null||typeof e=="string"),new Ae(e)}},lu=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Ae.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},hu=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new lu(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ae.FIRST_PARTY))}shutdown(){}invalidateToken(){}},du=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},fu=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=o=>{o.error!=null&&L("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.R;return this.R=o.token,L("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{L("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):L("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ie(typeof t.token=="string"),this.R=t.token,new du(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function Ow(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Ys=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Ow(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function ee(n,e){return n<e?-1:n>e?1:0}function pr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Se=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var W=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Se(0,0))}static max(){return new n(new Se(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Xs=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&z(),r===void 0?r=e.length-t:r>e.length-t&&z(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),a=t.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},he=class n extends Xs{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new M(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},Mw=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ye=class n extends Xs{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return Mw.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new M(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new M(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new M(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(he.fromString(e))}static fromName(e){return new n(he.fromString(e).popFirst(5))}static empty(){return new n(he.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&he.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return he.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new he(e.slice()))}};var pu=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};pu.UNKNOWN_ID=-1;function Fw(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new Se(t+1,0):new Se(t,r));return new Nn(i,B.empty(),e)}function Lw(n){return new Nn(n.readTime,n.key,-1)}var Nn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(W.min(),B.empty(),-1)}static max(){return new n(W.max(),B.empty(),-1)}};function Uw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:ee(n.largestBatchId,e.largestBatchId))}var jw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",mu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ui(n){return y(this,null,function*(){if(n.code!==P.FAILED_PRECONDITION||n.message!==jw)throw n;L("LocalStore","Unexpectedly lost primary lease")})}var x=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&z(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===o&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function Bw(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ji(n){return n.name==="IndexedDbTransactionError"}var em=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Ro(n){return n==null}function Ci(n){return n===0&&1/n==-1/0}function qw(n){return typeof n=="number"&&Number.isInteger(n)&&!Ci(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var zw=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],$A=[...zw,"documentOverlays"],Gw=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],$w=Gw,Ww=[...$w,"indexConfiguration","indexState","indexEntries"];var WA=[...Ww,"globals"];function Ip(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function jn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function tm(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var fe=class n{constructor(e,t){this.comparator=e,this.root=t||ft.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ft.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ft.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new lr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new lr(this.root,e,this.comparator,!1)}getReverseIterator(){return new lr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new lr(this.root,e,this.comparator,!0)}},lr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ft=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw z();let e=this.left.check();if(e!==this.right.check())throw z();return e+(this.isRed()?0:1)}};ft.EMPTY=null,ft.RED=!0,ft.BLACK=!1;ft.EMPTY=new class{constructor(){this.size=0}get key(){throw z()}get value(){throw z()}get color(){throw z()}get left(){throw z()}get right(){throw z()}copy(e,t,r,i,o){return this}insert(e,t,r){return new ft(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ne=class n{constructor(e){this.comparator=e,this.data=new fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Zs(this.data.getIterator())}getIteratorFrom(e){return new Zs(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Zs=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var nt=class n{constructor(e){this.fields=e,e.sort(Ye.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ne(Ye.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var eo=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ve=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new eo("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ve.EMPTY_BYTE_STRING=new Ve("");var Hw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Dt(n){if(ie(!!n),typeof n=="string"){let e=0,t=Hw.exec(n);if(ie(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:le(n.seconds),nanos:le(n.nanos)}}function le(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function nn(n){return typeof n=="string"?Ve.fromBase64String(n):Ve.fromUint8Array(n)}function $l(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Wl(n){let e=n.mapValue.fields.__previous_value__;return $l(e)?Wl(e):e}function Si(n){let e=Dt(n.mapValue.fields.__local_write_time__.timestampValue);return new Se(e.seconds,e.nanos)}var gu=class{constructor(e,t,r,i,o,a,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d}},to=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ws={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Vn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?$l(n)?4:rm(n)?9007199254740991:nm(n)?10:11:z()}function gt(n,e){if(n===e)return!0;let t=Vn(n);if(t!==Vn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Si(n).isEqual(Si(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=Dt(i.timestampValue),u=Dt(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return nn(i.bytesValue).isEqual(nn(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return le(i.geoPointValue.latitude)===le(o.geoPointValue.latitude)&&le(i.geoPointValue.longitude)===le(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return le(i.integerValue)===le(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=le(i.doubleValue),u=le(o.doubleValue);return a===u?Ci(a)===Ci(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return pr(n.arrayValue.values||[],e.arrayValue.values||[],gt);case 10:case 11:return function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(Ip(a)!==Ip(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!gt(a[h],u[h])))return!1;return!0}(n,e);default:return z()}}function Pi(n,e){return(n.values||[]).find(t=>gt(t,e))!==void 0}function mr(n,e){if(n===e)return 0;let t=Vn(n),r=Vn(e);if(t!==r)return ee(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ee(n.booleanValue,e.booleanValue);case 2:return function(o,a){let u=le(o.integerValue||o.doubleValue),h=le(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return wp(n.timestampValue,e.timestampValue);case 4:return wp(Si(n),Si(e));case 5:return ee(n.stringValue,e.stringValue);case 6:return function(o,a){let u=nn(o),h=nn(a);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){let u=o.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=ee(u[d],h[d]);if(p!==0)return p}return ee(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){let u=ee(le(o.latitude),le(a.latitude));return u!==0?u:ee(le(o.longitude),le(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Ep(n.arrayValue,e.arrayValue);case 10:return function(o,a){var u,h,d,p;let I=o.fields||{},A=a.fields||{},S=(u=I.value)===null||u===void 0?void 0:u.arrayValue,V=(h=A.value)===null||h===void 0?void 0:h.arrayValue,F=ee(((d=S?.values)===null||d===void 0?void 0:d.length)||0,((p=V?.values)===null||p===void 0?void 0:p.length)||0);return F!==0?F:Ep(S,V)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===Ws.mapValue&&a===Ws.mapValue)return 0;if(o===Ws.mapValue)return 1;if(a===Ws.mapValue)return-1;let u=o.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let I=0;I<h.length&&I<p.length;++I){let A=ee(h[I],p[I]);if(A!==0)return A;let S=mr(u[h[I]],d[p[I]]);if(S!==0)return S}return ee(h.length,p.length)}(n.mapValue,e.mapValue);default:throw z()}}function wp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ee(n,e);let t=Dt(n),r=Dt(e),i=ee(t.seconds,r.seconds);return i!==0?i:ee(t.nanos,r.nanos)}function Ep(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=mr(t[i],r[i]);if(o)return o}return ee(t.length,r.length)}function gr(n){return _u(n)}function _u(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Dt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return nn(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return B.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=_u(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${_u(t.fields[a])}`;return i+"}"}(n.mapValue):z()}function bp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function yu(n){return!!n&&"integerValue"in n}function Hl(n){return!!n&&"arrayValue"in n}function Tp(n){return!!n&&"nullValue"in n}function Ap(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ks(n){return!!n&&"mapValue"in n}function nm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Ei(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return jn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ei(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ei(n.arrayValue.values[t]);return e}return Object.assign({},n)}function rm(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Je=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ks(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ei(t)}setAll(e){let t=Ye.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=Ei(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Ks(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ks(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){jn(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Ei(this.value))}};function im(n){let e=[];return jn(n.fields,(t,r)=>{let i=new Ye([t]);if(Ks(r)){let o=im(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new nt(e)}var st=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,W.min(),W.min(),W.min(),Je.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,W.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,W.min(),W.min(),Je.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,W.min(),W.min(),Je.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Je.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Je.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var _r=class{constructor(e,t){this.position=e,this.inclusive=t}};function Cp(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=B.comparator(B.fromName(a.referenceValue),t.key):r=mr(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Sp(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!gt(n.position[t],e.position[t]))return!1;return!0}var On=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function Kw(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var no=class{},ye=class n extends no{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Iu(e,t,r):t==="array-contains"?new bu(e,r):t==="in"?new Tu(e,r):t==="not-in"?new Au(e,r):t==="array-contains-any"?new Cu(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new wu(e,r):new Eu(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(mr(t,this.value)):t!==null&&Vn(this.value)===Vn(t)&&this.matchesComparison(mr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return z()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ot=class n extends no{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return sm(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function sm(n){return n.op==="and"}function om(n){return Qw(n)&&sm(n)}function Qw(n){for(let e of n.filters)if(e instanceof ot)return!1;return!0}function vu(n){if(n instanceof ye)return n.field.canonicalString()+n.op.toString()+gr(n.value);if(om(n))return n.filters.map(e=>vu(e)).join(",");{let e=n.filters.map(t=>vu(t)).join(",");return`${n.op}(${e})`}}function am(n,e){return n instanceof ye?function(r,i){return i instanceof ye&&r.op===i.op&&r.field.isEqual(i.field)&&gt(r.value,i.value)}(n,e):n instanceof ot?function(r,i){return i instanceof ot&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&am(a,i.filters[u]),!0):!1}(n,e):void z()}function cm(n){return n instanceof ye?function(t){return`${t.field.canonicalString()} ${t.op} ${gr(t.value)}`}(n):n instanceof ot?function(t){return t.op.toString()+" {"+t.getFilters().map(cm).join(" ,")+"}"}(n):"Filter"}var Iu=class extends ye{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},wu=class extends ye{constructor(e,t){super(e,"in",t),this.keys=um("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Eu=class extends ye{constructor(e,t){super(e,"not-in",t),this.keys=um("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function um(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var bu=class extends ye{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Hl(t)&&Pi(t.arrayValue,this.value)}},Tu=class extends ye{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Pi(this.value.arrayValue,t)}},Au=class extends ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Pi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Pi(this.value.arrayValue,t)}},Cu=class extends ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Hl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Pi(this.value.arrayValue,r))}};var Su=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.ue=null}};function Pp(n,e=null,t=[],r=[],i=null,o=null,a=null){return new Su(n,e,t,r,i,o,a)}function Kl(n){let e=$(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>vu(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Ro(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>gr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>gr(r)).join(",")),e.ue=t}return e.ue}function Ql(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Kw(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!am(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Sp(n.startAt,e.startAt)&&Sp(n.endAt,e.endAt)}function Pu(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var rn=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Jw(n,e,t,r,i,o,a,u){return new rn(n,e,t,r,i,o,a,u)}function Jl(n){return new rn(n)}function Rp(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lm(n){return n.collectionGroup!==null}function bi(n){let e=$(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Ne(Ye.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new On(o,r))}),t.has(Ye.keyField().canonicalString())||e.ce.push(new On(Ye.keyField(),r))}return e.ce}function pt(n){let e=$(n);return e.le||(e.le=Yw(e,bi(n))),e.le}function Yw(n,e){if(n.limitType==="F")return Pp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new On(i.field,o)});let t=n.endAt?new _r(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new _r(n.startAt.position,n.startAt.inclusive):null;return Pp(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Ru(n,e){let t=n.filters.concat([e]);return new rn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ro(n,e,t){return new rn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Do(n,e){return Ql(pt(n),pt(e))&&n.limitType===e.limitType}function hm(n){return`${Kl(pt(n))}|lt:${n.limitType}`}function ar(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>cm(i)).join(", ")}]`),Ro(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>gr(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>gr(i)).join(",")),`Target(${r})`}(pt(n))}; limitType=${n.limitType})`}function xo(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):B.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of bi(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){let d=Cp(a,u,h);return a.inclusive?d<=0:d<0}(r.startAt,bi(r),i)||r.endAt&&!function(a,u,h){let d=Cp(a,u,h);return a.inclusive?d>=0:d>0}(r.endAt,bi(r),i))}(n,e)}function Xw(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function dm(n){return(e,t)=>{let r=!1;for(let i of bi(n)){let o=Zw(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function Zw(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):function(o,a,u){let h=a.data.field(o),d=u.data.field(o);return h!==null&&d!==null?mr(h,d):z()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return z()}}var sn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){jn(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return tm(this.inner)}size(){return this.innerSize}};var e0=new fe(B.comparator);function xt(){return e0}var fm=new fe(B.comparator);function wi(...n){let e=fm;for(let t of n)e=e.insert(t.key,t);return e}function pm(n){let e=fm;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Pn(){return Ti()}function mm(){return Ti()}function Ti(){return new sn(n=>n.toString(),(n,e)=>n.isEqual(e))}var t0=new fe(B.comparator),n0=new Ne(B.comparator);function Q(...n){let e=n0;for(let t of n)e=e.add(t);return e}var r0=new Ne(ee);function i0(){return r0}function Yl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ci(e)?"-0":e}}function gm(n){return{integerValue:""+n}}function s0(n,e){return qw(e)?gm(e):Yl(n,e)}var yr=class{constructor(){this._=void 0}};function o0(n,e,t){return n instanceof vr?function(i,o){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&$l(o)&&(o=Wl(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(t,e):n instanceof Mn?ym(n,e):n instanceof Fn?vm(n,e):function(i,o){let a=_m(i,o),u=Dp(a)+Dp(i.Pe);return yu(a)&&yu(i.Pe)?gm(u):Yl(i.serializer,u)}(n,e)}function a0(n,e,t){return n instanceof Mn?ym(n,e):n instanceof Fn?vm(n,e):t}function _m(n,e){return n instanceof Ir?function(r){return yu(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var vr=class extends yr{},Mn=class extends yr{constructor(e){super(),this.elements=e}};function ym(n,e){let t=Im(e);for(let r of n.elements)t.some(i=>gt(i,r))||t.push(r);return{arrayValue:{values:t}}}var Fn=class extends yr{constructor(e){super(),this.elements=e}};function vm(n,e){let t=Im(e);for(let r of n.elements)t=t.filter(i=>!gt(i,r));return{arrayValue:{values:t}}}var Ir=class extends yr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Dp(n){return le(n.integerValue||n.doubleValue)}function Im(n){return Hl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function c0(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Mn&&i instanceof Mn||r instanceof Fn&&i instanceof Fn?pr(r.elements,i.elements,gt):r instanceof Ir&&i instanceof Ir?gt(r.Pe,i.Pe):r instanceof vr&&i instanceof vr}(n.transform,e.transform)}var Du=class{constructor(e,t){this.version=e,this.transformResults=t}},en=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Qs(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var wr=class{};function wm(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new io(n.key,en.none()):new Ln(n.key,n.data,en.none());{let t=n.data,r=Je.empty(),i=new Ne(Ye.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new _t(n.key,r,new nt(i.toArray()),en.none())}}function u0(n,e,t){n instanceof Ln?function(i,o,a){let u=i.value.clone(),h=kp(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof _t?function(i,o,a){if(!Qs(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=kp(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(Em(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Ai(n,e,t,r){return n instanceof Ln?function(o,a,u,h){if(!Qs(o.precondition,a))return u;let d=o.value.clone(),p=Np(o.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof _t?function(o,a,u,h){if(!Qs(o.precondition,a))return u;let d=Np(o.fieldTransforms,h,a),p=a.data;return p.setAll(Em(o)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(I=>I.field))}(n,e,t,r):function(o,a,u){return Qs(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function l0(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=_m(r.transform,i||null);o!=null&&(t===null&&(t=Je.empty()),t.set(r.field,o))}return t||null}function xp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&pr(r,i,(o,a)=>c0(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Ln=class extends wr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},_t=class extends wr{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function Em(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function kp(n,e,t){let r=new Map;ie(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,a0(a,u,t[i]))}return r}function Np(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,o0(o,a,e))}return r}var io=class extends wr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},xu=class extends wr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var ku=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&u0(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ai(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ai(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=mm();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let h=wm(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Q())}isEqual(e){return this.batchId===e.batchId&&pr(this.mutations,e.mutations,(t,r)=>xp(t,r))&&pr(this.baseMutations,e.baseMutations,(t,r)=>xp(t,r))}},Nu=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ie(e.mutations.length===r.length);let i=function(){return t0}(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var Vu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Ou=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ge,X;function h0(n){switch(n){default:return z();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function bm(n){if(n===void 0)return Rt("GRPC error has no .code"),P.UNKNOWN;switch(n){case ge.OK:return P.OK;case ge.CANCELLED:return P.CANCELLED;case ge.UNKNOWN:return P.UNKNOWN;case ge.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case ge.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case ge.INTERNAL:return P.INTERNAL;case ge.UNAVAILABLE:return P.UNAVAILABLE;case ge.UNAUTHENTICATED:return P.UNAUTHENTICATED;case ge.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case ge.NOT_FOUND:return P.NOT_FOUND;case ge.ALREADY_EXISTS:return P.ALREADY_EXISTS;case ge.PERMISSION_DENIED:return P.PERMISSION_DENIED;case ge.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case ge.ABORTED:return P.ABORTED;case ge.OUT_OF_RANGE:return P.OUT_OF_RANGE;case ge.UNIMPLEMENTED:return P.UNIMPLEMENTED;case ge.DATA_LOSS:return P.DATA_LOSS;default:return z()}}(X=ge||(ge={}))[X.OK=0]="OK",X[X.CANCELLED=1]="CANCELLED",X[X.UNKNOWN=2]="UNKNOWN",X[X.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",X[X.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",X[X.NOT_FOUND=5]="NOT_FOUND",X[X.ALREADY_EXISTS=6]="ALREADY_EXISTS",X[X.PERMISSION_DENIED=7]="PERMISSION_DENIED",X[X.UNAUTHENTICATED=16]="UNAUTHENTICATED",X[X.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",X[X.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",X[X.ABORTED=10]="ABORTED",X[X.OUT_OF_RANGE=11]="OUT_OF_RANGE",X[X.UNIMPLEMENTED=12]="UNIMPLEMENTED",X[X.INTERNAL=13]="INTERNAL",X[X.UNAVAILABLE=14]="UNAVAILABLE",X[X.DATA_LOSS=15]="DATA_LOSS";var Vp=null;function d0(){return new TextEncoder}var f0=new Zt([4294967295,4294967295],0);function Op(n){let e=d0().encode(n),t=new Jc;return t.update(e),new Uint8Array(t.digest())}function Mp(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Zt([t,r],0),new Zt([i,o],0)]}var Mu=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Rn(`Invalid padding: ${t}`);if(r<0)throw new Rn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Rn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Rn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Zt.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Zt.fromNumber(r)));return i.compare(f0)===1&&(i=new Zt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Op(e),[r,i]=Mp(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;let t=Op(e),[r,i]=Mp(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Rn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var so=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ri.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(W.min(),i,new fe(ee),xt(),Q())}},Ri=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Q(),Q(),Q())}};var hr=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},oo=class{constructor(e,t){this.targetId=e,this.me=t}},ao=class{constructor(e,t,r=Ve.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},co=class{constructor(){this.fe=0,this.ge=Lp(),this.pe=Ve.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Q(),t=Q(),r=Q();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:z()}}),new Ri(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Lp()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ie(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Fu=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=xt(),this.qe=Fp(),this.Qe=new fe(ee)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:z()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(Pu(o))if(r===0){let a=new B(o.path);this.Ue(t,a,st.newNoDocument(a,W.min()))}else ie(r===1);else{let a=this.Ye(t);if(a!==r){let u=this.Ze(e),h=u?this.Xe(u,e,a):1;if(h!==0){this.je(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}Vp?.et(function(p,I,A,S,V){var F,N,H,J,Y,ae;let Oe={localCacheCount:p,existenceFilterCount:I.count,databaseId:A.database,projectId:A.projectId},te=I.unchangedNames;return te&&(Oe.bloomFilter={applied:V===0,hashCount:(F=te?.hashCount)!==null&&F!==void 0?F:0,bitmapLength:(J=(H=(N=te?.bits)===null||N===void 0?void 0:N.bitmap)===null||H===void 0?void 0:H.length)!==null&&J!==void 0?J:0,padding:(ae=(Y=te?.bits)===null||Y===void 0?void 0:Y.padding)!==null&&ae!==void 0?ae:0,mightContain:w=>{var m;return(m=S?.mightContain(w))!==null&&m!==void 0&&m}}),Oe}(a,e.me,this.Le.tt(),u,h))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,u;try{a=nn(r).toUint8Array()}catch(h){if(h instanceof eo)return fr("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Mu(a,i,o)}catch(h){return fr(h instanceof Rn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,a)=>{let u=this.Je(a);if(u){if(o.current&&Pu(u.target)){let h=new B(u.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,st.newNoDocument(h,e))}o.be&&(t.set(a,o.ve()),o.Ce())}});let r=Q();this.qe.forEach((o,a)=>{let u=!0;a.forEachWhile(h=>{let d=this.Je(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));let i=new so(e,t,this.Qe,this.ke,r);return this.ke=xt(),this.qe=Fp(),this.Qe=new fe(ee),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new co,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ne(ee),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||L("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new co),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Fp(){return new fe(B.comparator)}function Lp(){return new fe(B.comparator)}var p0={asc:"ASCENDING",desc:"DESCENDING"},m0={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},g0={and:"AND",or:"OR"},Lu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Uu(n,e){return n.useProto3Json||Ro(e)?e:{value:e}}function uo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Tm(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function _0(n,e){return uo(n,e.toTimestamp())}function mt(n){return ie(!!n),W.fromTimestamp(function(t){let r=Dt(t);return new Se(r.seconds,r.nanos)}(n))}function Xl(n,e){return ju(n,e).canonicalString()}function ju(n,e){let t=function(i){return new he(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Am(n){let e=he.fromString(n);return ie(Dm(e)),e}function Bu(n,e){return Xl(n.databaseId,e.path)}function ru(n,e){let t=Am(e);if(t.get(1)!==n.databaseId.projectId)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(Sm(t))}function Cm(n,e){return Xl(n.databaseId,e)}function y0(n){let e=Am(n);return e.length===4?he.emptyPath():Sm(e)}function qu(n){return new he(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Sm(n){return ie(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Up(n,e,t){return{name:Bu(n,e),fields:t.value.mapValue.fields}}function v0(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:z()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,p){return d.useProto3Json?(ie(p===void 0||typeof p=="string"),Ve.fromBase64String(p||"")):(ie(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Ve.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?P.UNKNOWN:bm(d.code);return new M(p,d.message||"")}(a);t=new ao(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=ru(n,r.document.name),o=mt(r.document.updateTime),a=r.document.createTime?mt(r.document.createTime):W.min(),u=new Je({mapValue:{fields:r.document.fields}}),h=st.newFoundDocument(i,o,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new hr(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=ru(n,r.document),o=r.readTime?mt(r.readTime):W.min(),a=st.newNoDocument(i,o),u=r.removedTargetIds||[];t=new hr([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=ru(n,r.document),o=r.removedTargetIds||[];t=new hr([],o,i,null)}else{if(!("filter"in e))return z();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new Ou(i,o),u=r.targetId;t=new oo(u,a)}}return t}function I0(n,e){let t;if(e instanceof Ln)t={update:Up(n,e.key,e.value)};else if(e instanceof io)t={delete:Bu(n,e.key)};else if(e instanceof _t)t={update:Up(n,e.key,e.data),updateMask:R0(e.fieldMask)};else{if(!(e instanceof xu))return z();t={verify:Bu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,a){let u=a.transform;if(u instanceof vr)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Mn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Fn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Ir)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw z()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:_0(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:z()}(n,e.precondition)),t}function w0(n,e){return n&&n.length>0?(ie(e!==void 0),n.map(t=>function(i,o){let a=i.updateTime?mt(i.updateTime):mt(o);return a.isEqual(W.min())&&(a=mt(o)),new Du(a,i.transformResults||[])}(t,e))):[]}function E0(n,e){return{documents:[Cm(n,e.path)]}}function b0(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Cm(n,i);let o=function(d){if(d.length!==0)return Rm(ot.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let a=function(d){if(d.length!==0)return d.map(p=>function(A){return{field:cr(A.field),direction:C0(A.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=Uu(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function T0(n){let e=y0(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ie(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=function(I){let A=Pm(I);return A instanceof ot&&om(A)?A.getFilters():[A]}(t.where));let a=[];t.orderBy&&(a=function(I){return I.map(A=>function(V){return new On(ur(V.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(V.direction))}(A))}(t.orderBy));let u=null;t.limit&&(u=function(I){let A;return A=typeof I=="object"?I.value:I,Ro(A)?null:A}(t.limit));let h=null;t.startAt&&(h=function(I){let A=!!I.before,S=I.values||[];return new _r(S,A)}(t.startAt));let d=null;return t.endAt&&(d=function(I){let A=!I.before,S=I.values||[];return new _r(S,A)}(t.endAt)),Jw(e,i,a,o,u,"F",h,d)}function A0(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return z()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Pm(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=ur(t.unaryFilter.field);return ye.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ur(t.unaryFilter.field);return ye.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=ur(t.unaryFilter.field);return ye.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=ur(t.unaryFilter.field);return ye.create(a,"!=",{nullValue:"NULL_VALUE"});default:return z()}}(n):n.fieldFilter!==void 0?function(t){return ye.create(ur(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return z()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ot.create(t.compositeFilter.filters.map(r=>Pm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return z()}}(t.compositeFilter.op))}(n):z()}function C0(n){return p0[n]}function S0(n){return m0[n]}function P0(n){return g0[n]}function cr(n){return{fieldPath:n.canonicalString()}}function ur(n){return Ye.fromServerFormat(n.fieldPath)}function Rm(n){return n instanceof ye?function(t){if(t.op==="=="){if(Ap(t.value))return{unaryFilter:{field:cr(t.field),op:"IS_NAN"}};if(Tp(t.value))return{unaryFilter:{field:cr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ap(t.value))return{unaryFilter:{field:cr(t.field),op:"IS_NOT_NAN"}};if(Tp(t.value))return{unaryFilter:{field:cr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cr(t.field),op:S0(t.op),value:t.value}}}(n):n instanceof ot?function(t){let r=t.getFilters().map(i=>Rm(i));return r.length===1?r[0]:{compositeFilter:{op:P0(t.op),filters:r}}}(n):z()}function R0(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Dm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Di=class n{constructor(e,t,r,i,o=W.min(),a=W.min(),u=Ve.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var zu=class{constructor(e){this.ct=e}};function D0(n){let e=T0({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ro(e,e.limit,"L"):e}var lo=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(le(e.integerValue));else if("doubleValue"in e){let r=le(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Ci(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Dt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(nn(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?rm(e)?this.dt(t,Number.MAX_SAFE_INTEGER):nm(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):z()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let a="value",u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(le(u)),this.Vt(a,t),this.Tt(o[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),B.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};lo.vt=new lo;var Gu=class{constructor(){this.un=new $u}addToCollectionParentIndex(e,t){return this.un.add(t),x.resolve()}getCollectionParents(e,t){return x.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return x.resolve()}deleteFieldIndex(e,t){return x.resolve()}deleteAllFieldIndexes(e){return x.resolve()}createTargetIndexes(e,t){return x.resolve()}getDocumentsMatchingTarget(e,t){return x.resolve(null)}getIndexType(e,t){return x.resolve(0)}getFieldIndexes(e,t){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,t){return x.resolve(Nn.min())}getMinOffsetFromCollectionGroup(e,t){return x.resolve(Nn.min())}updateCollectionGroup(e,t,r){return x.resolve()}updateIndexEntries(e,t){return x.resolve()}},$u=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ne(he.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ne(he.comparator)).toArray()}};var KA=new Uint8Array(0);var dt=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};dt.DEFAULT_COLLECTION_PERCENTILE=10,dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,dt.DEFAULT=new dt(41943040,dt.DEFAULT_COLLECTION_PERCENTILE,dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),dt.DISABLED=new dt(-1,0,0);var xi=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Wu=class{constructor(){this.changes=new sn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,st.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?x.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Hu=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ku=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ai(r.mutation,i,nt.empty(),Se.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Q()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Q()){let i=Pn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=wi();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=Pn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Q()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=xt(),a=Ti(),u=function(){return Ti()}();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof _t)?o=o.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),Ai(p.mutation,d,p.mutation.getFieldMask(),Se.now())):a.set(d.key,nt.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var I;return u.set(d,new Hu(p,(I=a.get(d))!==null&&I!==void 0?I:null))}),u))}recalculateAndSaveOverlays(e,t){let r=Ti(),i=new fe((a,u)=>a-u),o=Q();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||nt.empty();p=u.applyToLocalView(d,p),r.set(h,p);let I=(i.get(u.batchId)||Q()).add(h);i=i.insert(u.batchId,I)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,I=mm();p.forEach(A=>{if(!o.has(A)){let S=wm(t.get(A),r.get(A));S!==null&&I.set(A,S),o=o.add(A)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,I))}return x.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return B.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):x.resolve(Pn()),u=-1,h=o;return a.next(d=>x.forEach(d,(p,I)=>(u<I.largestBatchId&&(u=I.largestBatchId),o.get(p)?x.resolve():this.remoteDocumentCache.getEntry(e,p).next(A=>{h=h.insert(p,A)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,Q())).next(p=>({batchId:u,changes:pm(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=wi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=wi();return this.indexManager.getCollectionParents(e,o).next(u=>x.forEach(u,h=>{let d=function(I,A){return new rn(A,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((I,A)=>{a=a.insert(I,A)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,st.newInvalidDocument(p)))});let u=wi();return a.forEach((h,d)=>{let p=o.get(h);p!==void 0&&Ai(p.mutation,d,nt.empty(),Se.now()),xo(t,d)&&(u=u.insert(h,d))}),u})}};var Qu=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return x.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:mt(i.createTime)}}(t)),x.resolve()}getNamedQuery(e,t){return x.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:D0(i.bundledQuery),readTime:mt(i.readTime)}}(t)),x.resolve()}};var Ju=class{constructor(){this.overlays=new fe(B.comparator),this.Ir=new Map}getOverlay(e,t){return x.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Pn();return x.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),x.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),x.resolve()}getOverlaysForCollection(e,t,r){let i=Pn(),o=t.length+1,a=new B(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return x.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new fe((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=o.get(d.largestBatchId);p===null&&(p=Pn(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=Pn(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return x.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Vu(t,r));let o=this.Ir.get(t);o===void 0&&(o=Q(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var Yu=class{constructor(){this.sessionToken=Ve.EMPTY_BYTE_STRING}getSessionToken(e){return x.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,x.resolve()}};var ki=class{constructor(){this.Tr=new Ne(_e.Er),this.dr=new Ne(_e.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new _e(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new _e(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new B(new he([])),r=new _e(t,e),i=new _e(t,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new B(new he([])),r=new _e(t,e),i=new _e(t,e+1),o=Q();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new _e(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},_e=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return B.comparator(e.key,t.key)||ee(e.wr,t.wr)}static Ar(e,t){return ee(e.wr,t.wr)||B.comparator(e.key,t.key)}};var Xu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ne(_e.Er)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new ku(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.br=this.br.add(new _e(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return x.resolve(a)}lookupMutationBatch(e,t){return x.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return x.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new _e(t,0),i=new _e(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{let u=this.Dr(a.wr);o.push(u)}),x.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ne(ee);return t.forEach(i=>{let o=new _e(i,0),a=new _e(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],u=>{r=r.add(u.wr)})}),x.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;B.isDocumentKey(o)||(o=o.child(""));let a=new _e(new B(o),0),u=new Ne(ee);return this.br.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.wr)),!0)},a),x.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ie(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return x.forEach(t.mutations,i=>{let o=new _e(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new _e(t,0),i=this.br.firstAfterOrEqual(r);return x.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Zu=class{constructor(e){this.Mr=e,this.docs=function(){return new fe(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return x.resolve(r?r.document.mutableCopy():st.newInvalidDocument(t))}getEntries(e,t){let r=xt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():st.newInvalidDocument(i))}),x.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=xt(),a=t.path,u=new B(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||Uw(Lw(p),r)<=0||(i.has(p.key)||xo(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return x.resolve(o)}getAllFromCollectionGroup(e,t,r,i){z()}Or(e,t){return x.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new el(this)}getSize(e){return x.resolve(this.size)}},el=class extends Wu{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),x.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var tl=class{constructor(e){this.persistence=e,this.Nr=new sn(t=>Kl(t),Ql),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ki,this.targetCount=0,this.kr=xi.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),x.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new xi(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,x.resolve()}updateTargetData(e,t){return this.Kn(t),x.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),x.waitFor(o).next(()=>i)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return x.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),x.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),x.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),x.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return x.resolve(r)}containsKey(e,t){return x.resolve(this.Br.containsKey(t))}};var nl=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new em(0),this.Kr=!1,this.Kr=!0,this.$r=new Yu,this.referenceDelegate=e(this),this.Ur=new tl(this),this.indexManager=new Gu,this.remoteDocumentCache=function(i){return new Zu(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new zu(t),this.Gr=new Qu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ju,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Xu(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){L("MemoryPersistence","Starting transaction:",e);let i=new rl(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return x.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},rl=class extends mu{constructor(e){super(),this.currentSequenceNumber=e}},il=class n{constructor(e){this.persistence=e,this.Jr=new ki,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw z()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),x.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),x.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),x.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Xr,r=>{let i=B.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,W.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return x.or([()=>x.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var sl=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=Q(),i=Q();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var ol=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var al=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return of()?8:Bw(be())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new ol;return this.Xi(e,t,a).next(u=>{if(o.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Ii()<=K.DEBUG&&L("QueryEngine","SDK will not create cache indexes for query:",ar(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),x.resolve()):(Ii()<=K.DEBUG&&L("QueryEngine","Query:",ar(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Ii()<=K.DEBUG&&L("QueryEngine","The SDK decides to create cache indexes for query:",ar(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pt(t))):x.resolve())}Yi(e,t){if(Rp(t))return x.resolve(null);let r=pt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=ro(t,null,"F"),r=pt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=Q(...o);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.ts(t,u);return this.ns(t,d,a,h.readTime)?this.Yi(e,ro(t,null,"F")):this.rs(e,d,t,h)}))})))}Zi(e,t,r,i){return Rp(t)||i.isEqual(W.min())?x.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let a=this.ts(t,o);return this.ns(t,a,r,i)?x.resolve(null):(Ii()<=K.DEBUG&&L("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ar(t)),this.rs(e,a,t,Fw(i,-1)).next(u=>u))})}ts(e,t){let r=new Ne(dm(e));return t.forEach((i,o)=>{xo(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return Ii()<=K.DEBUG&&L("QueryEngine","Using full collection scan to execute query:",ar(t)),this.Ji.getDocumentsMatchingQuery(e,t,Nn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var cl=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new fe(ee),this._s=new sn(o=>Kl(o),Ql),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ku(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function x0(n,e,t,r){return new cl(n,e,t,r)}function xm(n,e){return y(this,null,function*(){let t=$(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],h=Q();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of o){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function k0(n,e){let t=$(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,h,d,p){let I=d.batch,A=I.keys(),S=x.resolve();return A.forEach(V=>{S=S.next(()=>p.getEntry(h,V)).next(F=>{let N=d.docVersions.get(V);ie(N!==null),F.version.compareTo(N)<0&&(I.applyToRemoteDocument(F,d),F.isValidDocument()&&(F.setReadTime(d.commitVersion),p.addEntry(F)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(h,I))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=Q();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function km(n){let e=$(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function N0(n,e){let t=$(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let u=[];e.targetChanges.forEach((p,I)=>{let A=i.get(I);if(!A)return;u.push(t.Ur.removeMatchingKeys(o,p.removedDocuments,I).next(()=>t.Ur.addMatchingKeys(o,p.addedDocuments,I)));let S=A.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(I)!==null?S=S.withResumeToken(Ve.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(I,S),function(F,N,H){return F.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=3e8?!0:H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0}(A,S,p)&&u.push(t.Ur.updateTargetData(o,S))});let h=xt(),d=Q();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),u.push(V0(o,a,e.documentUpdates).next(p=>{h=p.Ps,d=p.Is})),!r.isEqual(W.min())){let p=t.Ur.getLastRemoteSnapshotVersion(o).next(I=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(p)}return x.waitFor(u).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(t.os=i,o))}function V0(n,e,t){let r=Q(),i=Q();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=xt();return t.forEach((u,h)=>{let d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(W.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):L("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ps:a,Is:i}})}function O0(n,e){let t=$(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function M0(n,e){let t=$(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,x.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new Di(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function ul(n,e,t){return y(this,null,function*(){let r=$(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!ji(a))throw a;L("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function jp(n,e,t){let r=$(n),i=W.min(),o=Q();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,p){let I=$(h),A=I._s.get(p);return A!==void 0?x.resolve(I.os.get(A)):I.Ur.getTargetData(d,p)}(r,a,pt(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(h=>{o=h})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:W.min(),t?o:Q())).next(u=>(F0(r,Xw(e),u),{documents:u,Ts:o})))}function F0(n,e,t){let r=n.us.get(e)||W.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}var ho=class{constructor(){this.activeTargetIds=i0()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ll=class{constructor(){this.so=new ho,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ho,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var hl=class{_o(e){}shutdown(){}};var fo=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){L("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){L("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Hs=null;function iu(){return Hs===null?Hs=function(){return 268435456+Math.round(2147483648*Math.random())}():Hs++,"0x"+Hs.toString(16)}var L0={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var dl=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var ke="WebChannelConnection",fl=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,a){let u=iu(),h=this.xo(t,r.toUriEncodedString());L("RestConnection",`Sending RPC '${t}' ${u}:`,h,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,o,a),this.No(t,h,d,i).then(p=>(L("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw fr("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",h,"request:",i),p})}Lo(t,r,i,o,a,u){return this.Mo(t,r,i,o,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ar}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>t[a]=o),i&&i.headers.forEach((o,a)=>t[a]=o)}xo(t,r){let i=L0[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=iu();return new Promise((a,u)=>{let h=new Yc;h.setWithCredentials(!0),h.listenOnce(Zc.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case vi.NO_ERROR:let p=h.getResponseJson();L(ke,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case vi.TIMEOUT:L(ke,`RPC '${e}' ${o} timed out`),u(new M(P.DEADLINE_EXCEEDED,"Request time out"));break;case vi.HTTP_ERROR:let I=h.getStatus();if(L(ke,`RPC '${e}' ${o} failed with status:`,I,"response text:",h.getResponseText()),I>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);let S=A?.error;if(S&&S.status&&S.message){let V=function(N){let H=N.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(H)>=0?H:P.UNKNOWN}(S.status);u(new M(V,S.message))}else u(new M(P.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new M(P.UNAVAILABLE,"Connection failed."));break;default:z()}}finally{L(ke,`RPC '${e}' ${o} completed.`)}});let d=JSON.stringify(i);L(ke,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=iu(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=nu(),u=tu(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.xmlHttpFactory=new Xc({})),this.Oo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=o.join("");L(ke,`Creating RPC '${e}' stream ${i}: ${p}`,h);let I=a.createWebChannel(p,h),A=!1,S=!1,V=new dl({Io:N=>{S?L(ke,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(A||(L(ke,`Opening RPC '${e}' stream ${i} transport.`),I.open(),A=!0),L(ke,`RPC '${e}' stream ${i} sending:`,N),I.send(N))},To:()=>I.close()}),F=(N,H,J)=>{N.listen(H,Y=>{try{J(Y)}catch(ae){setTimeout(()=>{throw ae},0)}})};return F(I,or.EventType.OPEN,()=>{S||(L(ke,`RPC '${e}' stream ${i} transport opened.`),V.yo())}),F(I,or.EventType.CLOSE,()=>{S||(S=!0,L(ke,`RPC '${e}' stream ${i} transport closed`),V.So())}),F(I,or.EventType.ERROR,N=>{S||(S=!0,fr(ke,`RPC '${e}' stream ${i} transport errored:`,N),V.So(new M(P.UNAVAILABLE,"The operation could not be completed")))}),F(I,or.EventType.MESSAGE,N=>{var H;if(!S){let J=N.data[0];ie(!!J);let Y=J,ae=Y.error||((H=Y[0])===null||H===void 0?void 0:H.error);if(ae){L(ke,`RPC '${e}' stream ${i} received error:`,ae);let Oe=ae.status,te=function(_){let v=ge[_];if(v!==void 0)return bm(v)}(Oe),w=ae.message;te===void 0&&(te=P.INTERNAL,w="Unknown error status: "+Oe+" with message "+ae.message),S=!0,V.So(new M(te,w)),I.close()}else L(ke,`RPC '${e}' stream ${i} received:`,J),V.bo(J)}}),F(u,eu.STAT_EVENT,N=>{N.stat===$s.PROXY?L(ke,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===$s.NOPROXY&&L(ke,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{V.wo()},0),V}};function su(){return typeof document<"u"?document:null}function ko(n){return new Lu(n,!0)}var po=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&L("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var mo=class{constructor(e,t,r,i,o,a,u,h){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new po(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(Rt(t.toString()),Rt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new M(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return L("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(L("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},pl=class extends mo{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=v0(this.serializer,e),r=function(o){if(!("targetChange"in o))return W.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?W.min():a.readTime?mt(a.readTime):W.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=qu(this.serializer),t.addTarget=function(o,a){let u,h=a.target;if(u=Pu(h)?{documents:E0(o,h)}:{query:b0(o,h)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Tm(o,a.resumeToken);let d=Uu(o,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(W.min())>0){u.readTime=uo(o,a.snapshotVersion.toTimestamp());let d=Uu(o,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=A0(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=qu(this.serializer),t.removeTarget=e,this.a_(t)}},ml=class extends mo{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ie(!!e.streamToken),this.lastStreamToken=e.streamToken,ie(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ie(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=w0(e.writeResults,e.commitTime),r=mt(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=qu(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>I0(this.serializer,r))};this.a_(t)}};var gl=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,ju(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(P.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,ju(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new M(P.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},_l=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Rt(t),this.D_=!1):L("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var yl=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(()=>y(this,null,function*(){Bn(this)&&(L("RemoteStore","Restarting streams for network reachability change."),yield function(h){return y(this,null,function*(){let d=$(h);d.L_.add(4),yield Bi(d),d.q_.set("Unknown"),d.L_.delete(4),yield No(d)})}(this))}))}),this.q_=new _l(r,i)}};function No(n){return y(this,null,function*(){if(Bn(n))for(let e of n.B_)yield e(!0)})}function Bi(n){return y(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Nm(n,e){let t=$(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),nh(t)?th(t):Cr(t).r_()&&eh(t,e))}function Zl(n,e){let t=$(n),r=Cr(t);t.N_.delete(e),r.r_()&&Vm(t,e),t.N_.size===0&&(r.r_()?r.o_():Bn(t)&&t.q_.set("Unknown"))}function eh(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Cr(n).A_(e)}function Vm(n,e){n.Q_.xe(e),Cr(n).R_(e)}function th(n){n.Q_=new Fu({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Cr(n).start(),n.q_.v_()}function nh(n){return Bn(n)&&!Cr(n).n_()&&n.N_.size>0}function Bn(n){return $(n).L_.size===0}function Om(n){n.Q_=void 0}function U0(n){return y(this,null,function*(){n.q_.set("Online")})}function j0(n){return y(this,null,function*(){n.N_.forEach((e,t)=>{eh(n,e)})})}function B0(n,e){return y(this,null,function*(){Om(n),nh(n)?(n.q_.M_(e),th(n)):n.q_.set("Unknown")})}function q0(n,e,t){return y(this,null,function*(){if(n.q_.set("Online"),e instanceof ao&&e.state===2&&e.cause)try{yield function(i,o){return y(this,null,function*(){let a=o.cause;for(let u of o.targetIds)i.N_.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))})}(n,e)}catch(r){L("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield go(n,r)}else if(e instanceof hr?n.Q_.Ke(e):e instanceof oo?n.Q_.He(e):n.Q_.We(e),!t.isEqual(W.min()))try{let r=yield km(n.localStore);t.compareTo(r)>=0&&(yield function(o,a){let u=o.Q_.rt(a);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=o.N_.get(d);p&&o.N_.set(d,p.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,d)=>{let p=o.N_.get(h);if(!p)return;o.N_.set(h,p.withResumeToken(Ve.EMPTY_BYTE_STRING,p.snapshotVersion)),Vm(o,h);let I=new Di(p.target,h,d,p.sequenceNumber);eh(o,I)}),o.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){L("RemoteStore","Failed to raise snapshot:",r),yield go(n,r)}})}function go(n,e,t){return y(this,null,function*(){if(!ji(e))throw e;n.L_.add(1),yield Bi(n),n.q_.set("Offline"),t||(t=()=>km(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){L("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield No(n)}))})}function Mm(n,e){return e().catch(t=>go(n,t,e))}function Vo(n){return y(this,null,function*(){let e=$(n),t=on(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;z0(e);)try{let i=yield O0(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,G0(e,i)}catch(i){yield go(e,i)}Fm(e)&&Lm(e)})}function z0(n){return Bn(n)&&n.O_.length<10}function G0(n,e){n.O_.push(e);let t=on(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Fm(n){return Bn(n)&&!on(n).n_()&&n.O_.length>0}function Lm(n){on(n).start()}function $0(n){return y(this,null,function*(){on(n).p_()})}function W0(n){return y(this,null,function*(){let e=on(n);for(let t of n.O_)e.m_(t.mutations)})}function H0(n,e,t){return y(this,null,function*(){let r=n.O_.shift(),i=Nu.from(r,e,t);yield Mm(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Vo(n)})}function K0(n,e){return y(this,null,function*(){e&&on(n).V_&&(yield function(r,i){return y(this,null,function*(){if(function(a){return h0(a)&&a!==P.ABORTED}(i.code)){let o=r.O_.shift();on(r).s_(),yield Mm(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Vo(r)}})}(n,e)),Fm(n)&&Lm(n)})}function Bp(n,e){return y(this,null,function*(){let t=$(n);t.asyncQueue.verifyOperationInProgress(),L("RemoteStore","RemoteStore received new credentials");let r=Bn(t);t.L_.add(3),yield Bi(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield No(t)})}function Q0(n,e){return y(this,null,function*(){let t=$(n);e?(t.L_.delete(2),yield No(t)):e||(t.L_.add(2),yield Bi(t),t.q_.set("Unknown"))})}function Cr(n){return n.K_||(n.K_=function(t,r,i){let o=$(t);return o.w_(),new pl(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:U0.bind(null,n),Ro:j0.bind(null,n),mo:B0.bind(null,n),d_:q0.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.K_.s_(),nh(n)?th(n):n.q_.set("Unknown")):(yield n.K_.stop(),Om(n))}))),n.K_}function on(n){return n.U_||(n.U_=function(t,r,i){let o=$(t);return o.w_(),new ml(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:$0.bind(null,n),mo:K0.bind(null,n),f_:W0.bind(null,n),g_:H0.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.U_.s_(),yield Vo(n)):(yield n.U_.stop(),n.O_.length>0&&(L("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var vl=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Pt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function rh(n,e){if(Rt("AsyncQueue",`${e}: ${n}`),ji(n))return new M(P.UNAVAILABLE,`${e}: ${n}`);throw n}var _o=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=wi(),this.sortedSet=new fe(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var yo=class{constructor(){this.W_=new fe(B.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):z():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},Er=class n{constructor(e,t,r,i,o,a,u,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,_o.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Do(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Il=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},wl=class{constructor(){this.queries=qp(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=$(t),o=i.queries;i.queries=qp(),o.forEach((a,u)=>{for(let h of u.j_)h.onError(r)})})(this,new M(P.ABORTED,"Firestore shutting down"))}};function qp(){return new sn(n=>hm(n),Do)}function J0(n,e){return y(this,null,function*(){let t=$(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new Il,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=rh(a,`Initialization of query '${ar(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&ih(t)})}function Y0(n,e){return y(this,null,function*(){let t=$(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function X0(n,e){let t=$(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&ih(t)}function Z0(n,e,t){let r=$(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function ih(n){n.Y_.forEach(e=>{e.next()})}var El,zp;(zp=El||(El={})).ea="default",zp.Cache="cache";var bl=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Er(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Er.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==El.Cache}};var vo=class{constructor(e){this.key=e}},Io=class{constructor(e){this.key=e}},Tl=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Q(),this.mutatedKeys=Q(),this.Aa=dm(e),this.Ra=new _o(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new yo,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,I)=>{let A=i.get(p),S=xo(this.query,I)?I:null,V=!!A&&this.mutatedKeys.has(A.key),F=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),N=!1;A&&S?A.data.isEqual(S.data)?V!==F&&(r.track({type:3,doc:S}),N=!0):this.ga(A,S)||(r.track({type:2,doc:S}),N=!0,(h&&this.Aa(S,h)>0||d&&this.Aa(S,d)<0)&&(u=!0)):!A&&S?(r.track({type:0,doc:S}),N=!0):A&&!S&&(r.track({type:1,doc:A}),N=!0,(h||d)&&(u=!0)),N&&(S?(a=a.add(S),o=F?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:u,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,I)=>function(S,V){let F=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return z()}};return F(S)-F(V)}(p.type,I.type)||this.Aa(p.doc,I.doc)),this.pa(r),i=i!=null&&i;let u=t&&!i?this.ya():[],h=this.da.size===0&&this.current&&!i?1:0,d=h!==this.Ea;return this.Ea=h,a.length!==0||d?{snapshot:new Er(this.query,e.Ra,o,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new yo,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=Q(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Io(r))}),this.da.forEach(r=>{e.has(r)||t.push(new vo(r))}),t}ba(e){this.Ta=e.Ts,this.da=Q();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Er.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Al=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Cl=class{constructor(e){this.key=e,this.va=!1}},Sl=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new sn(u=>hm(u),Do),this.Ma=new Map,this.xa=new Set,this.Oa=new fe(B.comparator),this.Na=new Map,this.La=new ki,this.Ba={},this.ka=new Map,this.qa=xi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function eE(n,e,t=!0){return y(this,null,function*(){let r=Gm(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield Um(r,e,t,!0),i})}function tE(n,e){return y(this,null,function*(){let t=Gm(n);yield Um(t,e,!0,!1)})}function Um(n,e,t,r){return y(this,null,function*(){let i=yield M0(n.localStore,pt(e)),o=i.targetId,a=n.sharedClientState.addLocalQueryTarget(o,t),u;return r&&(u=yield nE(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Nm(n.remoteStore,i),u})}function nE(n,e,t,r,i){return y(this,null,function*(){n.Ka=(I,A,S)=>function(F,N,H,J){return y(this,null,function*(){let Y=N.view.ma(H);Y.ns&&(Y=yield jp(F.localStore,N.query,!1).then(({documents:w})=>N.view.ma(w,Y)));let ae=J&&J.targetChanges.get(N.targetId),Oe=J&&J.targetMismatches.get(N.targetId)!=null,te=N.view.applyChanges(Y,F.isPrimaryClient,ae,Oe);return $p(F,N.targetId,te.wa),te.snapshot})}(n,I,A,S);let o=yield jp(n.localStore,e,!0),a=new Tl(e,o.Ts),u=a.ma(o.documents),h=Ri.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,h);$p(n,t,d.wa);let p=new Al(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function rE(n,e,t){return y(this,null,function*(){let r=$(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(a=>!Do(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield ul(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Zl(r.remoteStore,i.targetId),Pl(r,i.targetId)}).catch(Ui))):(Pl(r,i.targetId),yield ul(r.localStore,i.targetId,!0))})}function iE(n,e){return y(this,null,function*(){let t=$(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Zl(t.remoteStore,r.targetId))})}function sE(n,e,t){return y(this,null,function*(){let r=dE(n);try{let i=yield function(a,u){let h=$(a),d=Se.now(),p=u.reduce((S,V)=>S.add(V.key),Q()),I,A;return h.persistence.runTransaction("Locally write mutations","readwrite",S=>{let V=xt(),F=Q();return h.cs.getEntries(S,p).next(N=>{V=N,V.forEach((H,J)=>{J.isValidDocument()||(F=F.add(H))})}).next(()=>h.localDocuments.getOverlayedDocuments(S,V)).next(N=>{I=N;let H=[];for(let J of u){let Y=l0(J,I.get(J.key).overlayedDocument);Y!=null&&H.push(new _t(J.key,Y,im(Y.value.mapValue),en.exists(!0)))}return h.mutationQueue.addMutationBatch(S,d,H,u)}).next(N=>{A=N;let H=N.applyToLocalDocumentSet(I,F);return h.documentOverlayCache.saveOverlays(S,N.batchId,H)})}).then(()=>({batchId:A.batchId,changes:pm(I)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let d=a.Ba[a.currentUser.toKey()];d||(d=new fe(ee)),d=d.insert(u,h),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield qi(r,i.changes),yield Vo(r.remoteStore)}catch(i){let o=rh(i,"Failed to persist write");t.reject(o)}})}function jm(n,e){return y(this,null,function*(){let t=$(n);try{let r=yield N0(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t.Na.get(o);a&&(ie(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?ie(a.va):i.removedDocuments.size>0&&(ie(a.va),a.va=!1))}),yield qi(t,r,e)}catch(r){yield Ui(r)}})}function Gp(n,e,t){let r=$(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,a)=>{let u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let h=$(a);h.onlineState=u;let d=!1;h.queries.forEach((p,I)=>{for(let A of I.j_)A.Z_(u)&&(d=!0)}),d&&ih(h)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function oE(n,e,t){return y(this,null,function*(){let r=$(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let a=new fe(B.comparator);a=a.insert(o,st.newNoDocument(o,W.min()));let u=Q().add(o),h=new so(W.min(),new Map,new fe(ee),a,u);yield jm(r,h),r.Oa=r.Oa.remove(o),r.Na.delete(e),sh(r)}else yield ul(r.localStore,e,!1).then(()=>Pl(r,e,t)).catch(Ui)})}function aE(n,e){return y(this,null,function*(){let t=$(n),r=e.batch.batchId;try{let i=yield k0(t.localStore,e);qm(t,r,null),Bm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield qi(t,i)}catch(i){yield Ui(i)}})}function cE(n,e,t){return y(this,null,function*(){let r=$(n);try{let i=yield function(a,u){let h=$(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(I=>(ie(I!==null),p=I.keys(),h.mutationQueue.removeMutationBatch(d,I))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(r.localStore,e);qm(r,e,t),Bm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield qi(r,i)}catch(i){yield Ui(i)}})}function Bm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function qm(n,e,t){let r=$(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Pl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||zm(n,r)})}function zm(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Zl(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),sh(n))}function $p(n,e,t){for(let r of t)r instanceof vo?(n.La.addReference(r.key,e),uE(n,r)):r instanceof Io?(L("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||zm(n,r.key)):z()}function uE(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(L("SyncEngine","New document in limbo: "+t),n.xa.add(r),sh(n))}function sh(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new B(he.fromString(e)),r=n.qa.next();n.Na.set(r,new Cl(t)),n.Oa=n.Oa.insert(t,r),Nm(n.remoteStore,new Di(pt(Jl(t.path)),r,"TargetPurposeLimboResolution",em.oe))}}function qi(n,e,t){return y(this,null,function*(){let r=$(n),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,h)=>{a.push(r.Ka(h,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let I=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,I?"current":"not-current")}if(d){i.push(d);let I=sl.Wi(h.targetId,d);o.push(I)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(h,d){return y(this,null,function*(){let p=$(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",I=>x.forEach(d,A=>x.forEach(A.$i,S=>p.persistence.referenceDelegate.addReference(I,A.targetId,S)).next(()=>x.forEach(A.Ui,S=>p.persistence.referenceDelegate.removeReference(I,A.targetId,S)))))}catch(I){if(!ji(I))throw I;L("LocalStore","Failed to update sequence numbers: "+I)}for(let I of d){let A=I.targetId;if(!I.fromCache){let S=p.os.get(A),V=S.snapshotVersion,F=S.withLastLimboFreeSnapshotVersion(V);p.os=p.os.insert(A,F)}}})}(r.localStore,o))})}function lE(n,e){return y(this,null,function*(){let t=$(n);if(!t.currentUser.isEqual(e)){L("SyncEngine","User change. New user:",e.toKey());let r=yield xm(t.localStore,e);t.currentUser=e,function(o,a){o.ka.forEach(u=>{u.forEach(h=>{h.reject(new M(P.CANCELLED,a))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield qi(t,r.hs)}})}function hE(n,e){let t=$(n),r=t.Na.get(e);if(r&&r.va)return Q().add(r.key);{let i=Q(),o=t.Ma.get(e);if(!o)return i;for(let a of o){let u=t.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}function Gm(n){let e=$(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=jm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hE.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oE.bind(null,e),e.Ca.d_=X0.bind(null,e.eventManager),e.Ca.$a=Z0.bind(null,e.eventManager),e}function dE(n){let e=$(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=aE.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=cE.bind(null,e),e}var wo=class{constructor(){this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){this.serializer=ko(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return x0(this.persistence,new al,e.initialUser,this.serializer)}createPersistence(e){return new nl(il.Zr,this.serializer)}createSharedClientState(e){return new ll}terminate(){return y(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Rl=class{initialize(e,t){return y(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Gp(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=lE.bind(null,this.syncEngine),yield Q0(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new wl}()}createDatastore(e){let t=ko(e.databaseInfo.databaseId),r=function(o){return new fl(o)}(e.databaseInfo);return function(o,a,u,h){return new gl(o,a,u,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,o,a,u){return new yl(r,i,o,a,u)}(this.localStore,this.datastore,e.asyncQueue,t=>Gp(this.syncEngine,t,0),function(){return fo.D()?new fo:new hl}())}createSyncEngine(e,t){return function(i,o,a,u,h,d,p){let I=new Sl(i,o,a,u,h,d);return p&&(I.Qa=!0),I}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return y(this,null,function*(){var e,t;yield function(i){return y(this,null,function*(){let o=$(i);L("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield Bi(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};var Dl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):Rt("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var xl=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ae.UNAUTHENTICATED,this.clientId=Ys.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,o=>y(this,null,function*(){L("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(L("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Pt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=rh(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function ou(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),L("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield xm(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Wp(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield pE(n);L("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Bp(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Bp(e.remoteStore,i)),n._onlineComponents=e})}function fE(n){return n.name==="FirebaseError"?n.code===P.FAILED_PRECONDITION||n.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function pE(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){L("FirestoreClient","Using user provided OfflineComponentProvider");try{yield ou(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!fE(t))throw t;fr("Error using user provided cache. Falling back to memory cache: "+t),yield ou(n,new wo)}}else L("FirestoreClient","Using default OfflineComponentProvider"),yield ou(n,new wo);return n._offlineComponents})}function $m(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(L("FirestoreClient","Using user provided OnlineComponentProvider"),yield Wp(n,n._uninitializedComponentsProvider._online)):(L("FirestoreClient","Using default OnlineComponentProvider"),yield Wp(n,new Rl))),n._onlineComponents})}function mE(n){return $m(n).then(e=>e.syncEngine)}function Hp(n){return y(this,null,function*(){let e=yield $m(n),t=e.eventManager;return t.onListen=eE.bind(null,e.syncEngine),t.onUnlisten=rE.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=tE.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=iE.bind(null,e.syncEngine),t})}function Wm(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Kp=new Map;function Hm(n,e,t){if(!t)throw new M(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function gE(n,e,t,r){if(e===!0&&r===!0)throw new M(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Qp(n){if(!B.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Jp(n){if(B.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Oo(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":z()}function xn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new M(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Oo(n);throw new M(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function _E(n,e){if(e<=0)throw new M(P.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Eo=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}gE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Wm((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},br=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Eo({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new M(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Eo(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new au;switch(r.type){case"firstParty":return new hu(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Kp.get(t);r&&(L("ComponentProvider","Removing Datastore"),Kp.delete(t),r.terminate())}(this),Promise.resolve()}};function Km(n,e,t,r={}){var i;let o=(n=xn(n,br))._getSettings(),a=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==a&&fr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),r.mockUserToken){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=Ae.MOCK_USER;else{u=Zd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new M(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Ae(d)}n._authCredentials=new cu(new Js(u,h))}}var an=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ge=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},tn=class n extends an{constructor(e,t,r){super(e,t,Jl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ge(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Qm(n,e,...t){if(n=Te(n),Hm("collection","path",e),n instanceof br){let r=he.fromString(e,...t);return Jp(r),new tn(n,null,r)}{if(!(n instanceof Ge||n instanceof tn))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(he.fromString(e,...t));return Jp(r),new tn(n.firestore,null,r)}}function oh(n,e,...t){if(n=Te(n),arguments.length===1&&(e=Ys.newId()),Hm("doc","path",e),n instanceof br){let r=he.fromString(e,...t);return Qp(r),new Ge(n,null,new B(r))}{if(!(n instanceof Ge||n instanceof tn))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(he.fromString(e,...t));return Qp(r),new Ge(n.firestore,n instanceof tn?n.converter:null,new B(r))}}var kl=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new po(this,"async_queue_retry"),this.Eu=()=>{let t=su();t&&L("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=su();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=su();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new Pt;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return y(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!ji(e))throw e;L("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw Rt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=vl.createAndSchedule(this,e,t,r,o=>this.Vu(o));return this.lu.push(i),i}du(){this.hu&&z()}verifyOperationInProgress(){}mu(){return y(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function Yp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var Un=class extends br{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new kl}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Xm(this),this._firestoreClient.terminate()}};function Jm(n,e){let t=typeof n=="object"?n:er(),r=typeof n=="string"?n:e||"(default)",i=ui(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Xd("firestore");o&&Km(i,...o)}return i}function Ym(n){return n._firestoreClient||Xm(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Xm(n){var e,t,r;let i=n._freezeSettings(),o=function(u,h,d,p){return new gu(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Wm(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new xl(n._authCredentials,n._appCheckCredentials,n._queue,o),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var Ni=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ve.fromBase64String(e))}catch(t){throw new M(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ve.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Tr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ye(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Vi=class{constructor(e){this._methodName=e}};var Oi=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}};var Mi=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var yE=/^__.*__$/,Nl=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new _t(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ln(e,this.data,t,this.fieldTransforms)}},bo=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new _t(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function Zm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw z()}}var Vl=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.yu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return Ao(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(Zm(this.wu)&&yE.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},Ol=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ko(e)}Nu(e,t,r,i=!1){return new Vl({wu:e,methodName:t,Ou:r,path:Ye.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ah(n){let e=n._freezeSettings(),t=ko(n._databaseId);return new Ol(n._databaseId,!!e.ignoreUndefinedProperties,t)}function vE(n,e,t,r,i,o={}){let a=n.Nu(o.merge||o.mergeFields?2:0,e,t,i);ch("Data must be an object, but it was:",a,r);let u=eg(r,a),h,d;if(o.merge)h=new nt(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){let p=[];for(let I of o.mergeFields){let A=Ml(e,I,t);if(!a.contains(A))throw new M(P.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);ng(p,A)||p.push(A)}h=new nt(p),d=a.fieldTransforms.filter(I=>h.covers(I.field))}else h=null,d=a.fieldTransforms;return new Nl(new Je(u),h,d)}var To=class n extends Vi{_toFieldTransform(e){if(e.wu!==2)throw e.wu===1?e.Mu(`${this._methodName}() can only appear at the top level of your update data`):e.Mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function IE(n,e,t,r){let i=n.Nu(1,e,t);ch("Data must be an object, but it was:",i,r);let o=[],a=Je.empty();jn(r,(h,d)=>{let p=uh(e,h,t);d=Te(d);let I=i.Cu(p);if(d instanceof To)o.push(p);else{let A=zi(d,I);A!=null&&(o.push(p),a.set(p,A))}});let u=new nt(o);return new bo(a,u,i.fieldTransforms)}function wE(n,e,t,r,i,o){let a=n.Nu(1,e,t),u=[Ml(e,r,t)],h=[i];if(o.length%2!=0)throw new M(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let A=0;A<o.length;A+=2)u.push(Ml(e,o[A])),h.push(o[A+1]);let d=[],p=Je.empty();for(let A=u.length-1;A>=0;--A)if(!ng(d,u[A])){let S=u[A],V=h[A];V=Te(V);let F=a.Cu(S);if(V instanceof To)d.push(S);else{let N=zi(V,F);N!=null&&(d.push(S),p.set(S,N))}}let I=new nt(d);return new bo(p,I,a.fieldTransforms)}function EE(n,e,t,r=!1){return zi(t,n.Nu(r?4:3,e))}function zi(n,e){if(tg(n=Te(n)))return ch("Unsupported field value:",e,n),eg(n,e);if(n instanceof Vi)return function(r,i){if(!Zm(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let o=[],a=0;for(let u of r){let h=zi(u,i.Fu(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Te(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return s0(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Se.fromDate(r);return{timestampValue:uo(i.serializer,o)}}if(r instanceof Se){let o=new Se(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:uo(i.serializer,o)}}if(r instanceof Oi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ni)return{bytesValue:Tm(i.serializer,r._byteString)};if(r instanceof Ge){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Xl(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Mi)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw u.Mu("VectorValues must only contain numeric values.");return Yl(u.serializer,h)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${Oo(r)}`)}(n,e)}function eg(n,e){let t={};return tm(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jn(n,(r,i)=>{let o=zi(i,e.bu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function tg(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Se||n instanceof Oi||n instanceof Ni||n instanceof Ge||n instanceof Vi||n instanceof Mi)}function ch(n,e,t){if(!tg(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Oo(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function Ml(n,e,t){if((e=Te(e))instanceof Tr)return e._internalPath;if(typeof e=="string")return uh(n,e);throw Ao("Field path arguments must be of type string or ",n,!1,void 0,t)}var bE=new RegExp("[~\\*/\\[\\]]");function uh(n,e,t){if(e.search(bE)>=0)throw Ao(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Tr(...e.split("."))._internalPath}catch{throw Ao(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ao(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new M(P.INVALID_ARGUMENT,u+n+h)}function ng(n,e){return n.some(t=>t.isEqual(e))}var Co=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ge(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Fl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(lh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Fl=class extends Co{data(){return super.data()}};function lh(n,e){return typeof e=="string"?uh(n,e):e instanceof Tr?e._internalPath:e._delegate._internalPath}function TE(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new M(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Fi=class{},Li=class extends Fi{};function rg(n,e,...t){let r=[];e instanceof Fi&&r.push(e),r=r.concat(t),function(o){let a=o.filter(h=>h instanceof Ul).length,u=o.filter(h=>h instanceof Ll).length;if(a>1||a>0&&u>0)throw new M(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Ll=class n extends Li{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return og(e._query,t),new an(e.firestore,e.converter,Ru(e._query,t))}_parse(e){let t=ah(e.firestore);return function(o,a,u,h,d,p,I){let A;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new M(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Zp(I,p);let S=[];for(let V of I)S.push(Xp(h,o,V));A={arrayValue:{values:S}}}else A=Xp(h,o,I)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Zp(I,p),A=EE(u,a,I,p==="in"||p==="not-in");return ye.create(d,p,A)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var Ul=class n extends Fi{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ot.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let a=i,u=o.getFlattenedFilters();for(let h of u)og(a,h),a=Ru(a,h)}(e._query,t),new an(e.firestore,e.converter,Ru(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var jl=class n extends Li{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,a){if(i.startAt!==null)throw new M(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new On(o,a)}(e._query,this._field,this._direction);return new an(e.firestore,e.converter,function(i,o){let a=i.explicitOrderBy.concat([o]);return new rn(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function ig(n,e="asc"){let t=e,r=lh("orderBy",n);return jl._create(r,t)}var Bl=class n extends Li{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new an(e.firestore,e.converter,ro(e._query,this._limit,this._limitType))}};function sg(n){return _E("limit",n),Bl._create("limit",n,"F")}function Xp(n,e,t){if(typeof(t=Te(t))=="string"){if(t==="")throw new M(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lm(e)&&t.indexOf("/")!==-1)throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(he.fromString(t));if(!B.isDocumentKey(r))throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return bp(n,new B(r))}if(t instanceof Ge)return bp(n,t._key);throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Oo(t)}.`)}function Zp(n,e){if(!Array.isArray(n)||n.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function og(n,e){let t=function(i,o){for(let a of i)for(let u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var ql=class{convertValue(e,t="none"){switch(Vn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return le(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(nn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw z()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return jn(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>le(a.doubleValue));return new Mi(o)}convertGeoPoint(e){return new Oi(le(e.latitude),le(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Wl(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Si(e));default:return null}}convertTimestamp(e){let t=Dt(e);return new Se(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=he.fromString(e);ie(Dm(r));let i=new to(r.get(1),r.get(3)),o=new B(r.popFirst(5));return i.isEqual(t)||Rt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function AE(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Dn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},So=class extends Co{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new dr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(lh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},dr=class extends So{data(e={}){return super.data(e)}},zl=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Dn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new dr(this._firestore,this._userDataWriter,r.key,r,new Dn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new dr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Dn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let h=new dr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Dn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:CE(u.type),doc:h,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function CE(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return z()}}var Po=class extends ql{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ni(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ge(this.firestore,null,t)}};function ag(n,e,t,...r){n=xn(n,Ge);let i=xn(n.firestore,Un),o=ah(i),a;return a=typeof(e=Te(e))=="string"||e instanceof Tr?wE(o,"updateDoc",n._key,e,t,r):IE(o,"updateDoc",n._key,e),ug(i,[a.toMutation(n._key,en.exists(!0))])}function cg(n,e){let t=xn(n.firestore,Un),r=oh(n),i=AE(n.converter,e);return ug(t,[vE(ah(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,en.exists(!1))]).then(()=>r)}function hh(n,...e){var t,r,i;n=Te(n);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Yp(e[a])||(o=e[a],a++);let u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Yp(e[a])){let I=e[a];e[a]=(t=I.next)===null||t===void 0?void 0:t.bind(I),e[a+1]=(r=I.error)===null||r===void 0?void 0:r.bind(I),e[a+2]=(i=I.complete)===null||i===void 0?void 0:i.bind(I)}let h,d,p;if(n instanceof Ge)d=xn(n.firestore,Un),p=Jl(n._key.path),h={next:I=>{e[a]&&e[a](SE(d,n,I))},error:e[a+1],complete:e[a+2]};else{let I=xn(n,an);d=xn(I.firestore,Un),p=I._query;let A=new Po(d);h={next:S=>{e[a]&&e[a](new zl(d,A,I,S))},error:e[a+1],complete:e[a+2]},TE(n._query)}return function(A,S,V,F){let N=new Dl(F),H=new bl(S,N,V);return A.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return J0(yield Hp(A),H)})),()=>{N.za(),A.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Y0(yield Hp(A),H)}))}}(Ym(d),p,u,h)}function ug(n,e){return function(r,i){let o=new Pt;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return sE(yield mE(r),i,o)})),o.promise}(Ym(n),e)}function SE(n,e,t){let r=t.docs.get(e._key),i=new Po(n);return new So(n,i,e._key,r,new Dn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Ar=i})(Qt),Kt(new tt("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new Un(new uu(r.getProvider("auth-internal")),new fu(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new M(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new to(d.options.projectId,p)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),ve(vp,"4.7.2",e),ve(vp,"4.7.2","esm2017")})();var Mo=function(){return Mo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Mo.apply(this,arguments)};var DE={includeMetadataChanges:!1};function lg(n,e){return e===void 0&&(e=DE),new Xr(function(t){var r=hh(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function hg(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Mo(Mo({},r),(t={},t[e.idField]=n.id,t))}function dg(n){return lg(n,{includeMetadataChanges:!0}).pipe(_n(function(e){return e.docs}))}function fg(n,e){return e===void 0&&(e={}),dg(n).pipe(_n(function(t){return t.map(function(r){return hg(r,e)})}))}var kt=class{constructor(e){return e}},pg="firestore",dh=class{constructor(){return li(pg)}};var fh=new He("angularfire2.firestore-instances");function xE(n,e){let t=As(pg,n,e);return t&&new kt(t)}function kE(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new kt(r)}}var NE={provide:dh,deps:[[new et,fh]]},VE={provide:kt,useFactory:xE,deps:[[new et,fh],Tt]};function mg(n,...e){return ve("angularfire",En.full,"fst"),Kn([VE,NE,{provide:fh,useFactory:kE(n),multi:!0,deps:[Bt,yn,rr,bn,[new et,yi],[new et,nr],...e]}])}var Fo=ze(fg,!0);var Gi=ze(cg,!0);var cn=ze(Qm,!0);var gg=ze(oh,!0);var _g=ze(Jm,!0);var yg=ze(sg,!0);var vg=ze(ig,!0);var Ig=ze(rg,!0);var wg=ze(ag,!0);var $e=class n{constructor(e){this.firestore=e}guardarUsuario(e){let t=cn(this.firestore,"usuarios");return e.nombre=e.nombre.toLowerCase(),Gi(t,e)}obtenerUsuarios(){let e=cn(this.firestore,"usuarios");return Fo(e,{idField:"id"})}generarLogUsuario(e){let t=cn(this.firestore,"logsSesion");e.nombre=e.nombre.toLowerCase();let r=new Date().toISOString(),i={nombre:e.nombre,tiempo:r};return Gi(t,i)}actulizarPuntaje(e,t,r){let i=cn(this.firestore,"usuarios"),o=gg(i,t),a={};a[e]=r,wg(o,a)}static \u0275fac=function(t){return new(t||n)(jt(kt))};static \u0275prov=it({token:n,factory:n.\u0275fac,providedIn:"root"})};var Lo=class n{constructor(e,t){this._usuario=e;this.db=t}subscripcion=[];ngOnDestroy(){if(this.subscripcion)for(let e of this.subscripcion)e.unsubscribe()}get usuario(){return this._usuario}static \u0275fac=function(t){return new(t||n)(q(Ee),q($e))};static \u0275cmp=pe({type:n,selectors:[["app-home"]],standalone:!0,features:[me],decls:16,vars:0,consts:[[1,"right"],["routerLink","/ahorcado"],["src","../../../assets/ahorcado.png","alt","img"],["routerLink","/preguntados"],["src","../../../assets/preguntados.png","alt","img"],["routerLink","/mayor-menor"],["src","../../../assets/mayoromenor.png","alt","img"],["routerLink",""]],template:function(t,r){t&1&&(D(0,"div",0)(1,"button",1),se(2,"img",2),D(3,"p"),O(4,"Ahorcado"),R()(),D(5,"button",3),se(6,"img",4),D(7,"p"),O(8,"Preguntados"),R()(),D(9,"button",5),se(10,"img",6),D(11,"p"),O(12,"Mayor o Menor"),R()(),D(13,"button",7)(14,"p"),O(15,"Juego Proximamente"),R()()())},dependencies:[Zn,we,Ie],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:stretch}p[_ngcontent-%COMP%]{text-decoration:none;margin:1px}.left[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:50px;width:400px;width:68vw}.right[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:85vh;width:10vw;justify-content:center;margin-right:1vw}ul[_ngcontent-%COMP%]{list-style:none}.izquierda[_ngcontent-%COMP%]{width:30px}.derecha[_ngcontent-%COMP%]{width:300px}.centro[_ngcontent-%COMP%]{width:50px}.right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:8vw;max-height:20vh}button[_ngcontent-%COMP%]{max-height:20vh;margin:200px 20px;padding:20px;background-color:#32cd32;display:flex;flex-direction:column;align-items:center;justify-content:center;border:1px solid black;border-radius:20px;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{background-color:#36b036}button[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2vw;color:#fff;text-align:center;font-weight:700}.list-pair[_ngcontent-%COMP%]{display:flex}.list[_ngcontent-%COMP%]{padding:1px;margin:0 10px;width:80%;text-align:center;border:1px solid black;border-radius:20px}.list[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{width:100%;padding:5px 0;background-color:#32cd32;border:1px solid black;border-radius:20px}.lista-texto-izquierda[_ngcontent-%COMP%]{display:inline-block;width:5%;text-align:start;margin-right:5px}.lista-texto-centro[_ngcontent-%COMP%]{display:inline-block;width:85%;text-align:start}.lista-texto-derecha[_ngcontent-%COMP%]{margin:0 5px;display:inline-block;width:10%;text-align:end}li[_ngcontent-%COMP%]{font-size:20px;font-weight:600;width:100%;display:flex;border-bottom:1px solid #333}ul[_ngcontent-%COMP%]{width:100%}"]})};var Dg=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(r){return new(r||n)(q(ei),q(ja))}}static{this.\u0275dir=at({type:n})}}return n})(),OE=(()=>{class n extends Dg{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=kd(n)))(i||n)}})()}static{this.\u0275dir=at({type:n,features:[qt]})}}return n})(),yh=new He("");var ME={provide:yh,useExisting:Zr(()=>hn),multi:!0};function FE(){let n=za()?za().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var LE=new He(""),hn=(()=>{class n extends Dg{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!FE())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(r){return new(r||n)(q(ei),q(ja),q(LE,8))}}static{this.\u0275dir=at({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&ue("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},features:[ni([ME]),qt]})}}return n})();function un(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function xg(n){return n!=null&&typeof n.length=="number"}var vh=new He(""),Ih=new He(""),UE=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Xe=class{static min(e){return jE(e)}static max(e){return BE(e)}static required(e){return qE(e)}static requiredTrue(e){return zE(e)}static email(e){return GE(e)}static minLength(e){return $E(e)}static maxLength(e){return WE(e)}static pattern(e){return HE(e)}static nullValidator(e){return kg(e)}static compose(e){return Lg(e)}static composeAsync(e){return jg(e)}};function jE(n){return e=>{if(un(e.value)||un(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function BE(n){return e=>{if(un(e.value)||un(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function qE(n){return un(n.value)?{required:!0}:null}function zE(n){return n.value===!0?null:{required:!0}}function GE(n){return un(n.value)||UE.test(n.value)?null:{email:!0}}function $E(n){return e=>un(e.value)||!xg(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}function WE(n){return e=>xg(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function HE(n){if(!n)return kg;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(un(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function kg(n){return null}function Ng(n){return n!=null}function Vg(n){return jd(n)?Ua(n):n}function Og(n){let e={};return n.forEach(t=>{e=t!=null?Be(Be({},e),t):e}),Object.keys(e).length===0?null:e}function Mg(n,e){return e.map(t=>t(n))}function KE(n){return!n.validate}function Fg(n){return n.map(e=>KE(e)?e:t=>e.validate(t))}function Lg(n){if(!n)return null;let e=n.filter(Ng);return e.length==0?null:function(t){return Og(Mg(t,e))}}function Ug(n){return n!=null?Lg(Fg(n)):null}function jg(n){if(!n)return null;let e=n.filter(Ng);return e.length==0?null:function(t){let r=Mg(t,e).map(Vg);return Pd(r).pipe(_n(Og))}}function Bg(n){return n!=null?jg(Fg(n)):null}function bg(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function qg(n){return n._rawValidators}function zg(n){return n._rawAsyncValidators}function ph(n){return n?Array.isArray(n)?n:[n]:[]}function jo(n,e){return Array.isArray(n)?n.includes(e):n===e}function Tg(n,e){let t=ph(e);return ph(n).forEach(i=>{jo(t,i)||t.push(i)}),t}function Ag(n,e){return ph(e).filter(t=>!jo(n,t))}var Bo=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ug(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Bg(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},qn=class extends Bo{get formDirective(){return null}get path(){return null}},zn=class extends Bo{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},qo=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},QE={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},eP=Ze(Be({},QE),{"[class.ng-submitted]":"isSubmitted"}),xr=(()=>{class n extends qo{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(q(zn,2))}}static{this.\u0275dir=at({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Ba("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[qt]})}}return n})(),Ho=(()=>{class n extends qo{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(q(qn,10))}}static{this.\u0275dir=at({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Ba("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[qt]})}}return n})();var $i="VALID",Uo="INVALID",Pr="PENDING",Wi="DISABLED",ln=class{},zo=class extends ln{constructor(e,t){super(),this.value=e,this.source=t}},Hi=class extends ln{constructor(e,t){super(),this.pristine=e,this.source=t}},Ki=class extends ln{constructor(e,t){super(),this.touched=e,this.source=t}},Rr=class extends ln{constructor(e,t){super(),this.status=e,this.source=t}},mh=class extends ln{constructor(e){super(),this.source=e}},gh=class extends ln{constructor(e){super(),this.source=e}};function Gg(n){return(Ko(n)?n.validators:n)||null}function JE(n){return Array.isArray(n)?Ug(n):n||null}function $g(n,e){return(Ko(e)?e.asyncValidators:n)||null}function YE(n){return Array.isArray(n)?Bg(n):n||null}function Ko(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function XE(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new ps(1e3,"");if(!r[t])throw new ps(1001,"")}function ZE(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new ps(1002,"")})}var Go=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=ii(()=>this.statusReactive()),this.statusReactive=ti(void 0),this._pristine=ii(()=>this.pristineReactive()),this.pristineReactive=ti(!0),this._touched=ii(()=>this.touchedReactive()),this.touchedReactive=ti(!1),this._events=new Ad,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return zt(this.statusReactive)}set status(e){zt(()=>this.statusReactive.set(e))}get valid(){return this.status===$i}get invalid(){return this.status===Uo}get pending(){return this.status==Pr}get disabled(){return this.status===Wi}get enabled(){return this.status!==Wi}get pristine(){return zt(this.pristineReactive)}set pristine(e){zt(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return zt(this.touchedReactive)}set touched(e){zt(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Tg(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Tg(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Ag(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Ag(e,this._rawAsyncValidators))}hasValidator(e){return jo(this._rawValidators,e)}hasAsyncValidator(e){return jo(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Ze(Be({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Ki(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Ki(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Ze(Be({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Hi(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Hi(!0,r))}markAsPending(e={}){this.status=Pr;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Rr(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Ze(Be({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Wi,this.errors=null,this._forEachChild(i=>{i.disable(Ze(Be({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new zo(this.value,r)),this._events.next(new Rr(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Ze(Be({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=$i,this._forEachChild(r=>{r.enable(Ze(Be({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Ze(Be({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===$i||this.status===Pr)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new zo(this.value,t)),this._events.next(new Rr(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Ze(Be({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Wi:$i}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Pr,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=Vg(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Rr(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Qn,this.statusChanges=new Qn}_calculateStatus(){return this._allControlsDisabled()?Wi:this.errors?Uo:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Pr)?Pr:this._anyControlsHaveStatus(Uo)?Uo:$i}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Hi(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Ki(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Ko(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=JE(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=YE(this._rawAsyncValidators)}},Dr=class extends Go{constructor(e,t,r){super(Gg(t),$g(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){ZE(this,!0,e),Object.keys(e).forEach(r=>{XE(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Qo=new He("CallSetDisabledState",{providedIn:"root",factory:()=>Jo}),Jo="always";function Wg(n,e){return[...e.path,n]}function _h(n,e,t=Jo){wh(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),tb(n,e),rb(n,e),nb(n,e),eb(n,e)}function Cg(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Wo(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function $o(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function eb(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function wh(n,e){let t=qg(n);e.validator!==null?n.setValidators(bg(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=zg(n);e.asyncValidator!==null?n.setAsyncValidators(bg(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();$o(e._rawValidators,i),$o(e._rawAsyncValidators,i)}function Wo(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=qg(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(a=>a!==e.validator);o.length!==i.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let i=zg(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(a=>a!==e.asyncValidator);o.length!==i.length&&(t=!0,n.setAsyncValidators(o))}}}let r=()=>{};return $o(e._rawValidators,r),$o(e._rawAsyncValidators,r),t}function tb(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Hg(n,e)})}function nb(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Hg(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Hg(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function rb(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function ib(n,e){n==null,wh(n,e)}function sb(n,e){return Wo(n,e)}function Kg(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function ob(n){return Object.getPrototypeOf(n.constructor)===OE}function ab(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function Qg(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===hn?t=o:ob(o)?r=o:i=o}),i||r||t||null}function cb(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Sg(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Pg(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Vt=class extends Go{constructor(e=null,t,r){super(Gg(t),$g(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ko(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Pg(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Sg(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Sg(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Pg(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var ub=n=>n instanceof Vt;var lb={provide:zn,useExisting:Zr(()=>Eh)},Rg=Promise.resolve(),Eh=(()=>{class n extends zn{constructor(t,r,i,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new Vt,this._registered=!1,this.name="",this.update=new Qn,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=Qg(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),Kg(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){_h(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){Rg.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&zd(r);Rg.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?Wg(t,this._parent):[t]}static{this.\u0275fac=function(r){return new(r||n)(q(qn,9),q(vh,10),q(Ih,10),q(yh,10),q(qd,8),q(Qo,8))}}static{this.\u0275dir=at({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ni([lb]),qt,_s]})}}return n})(),Yo=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=at({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})();var Jg=new He("");var hb={provide:qn,useExisting:Zr(()=>Qi)},Qi=(()=>{class n extends qn{get submitted(){return zt(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}constructor(t,r,i){super(),this.callSetDisabledState=i,this._submitted=ii(()=>this._submittedReactive()),this._submittedReactive=ti(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Qn,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Wo(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return _h(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){Cg(t.control||null,t,!1),cb(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this._submittedReactive.set(!0),ab(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new mh(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this._submittedReactive.set(!1),this.form._events.next(new gh(this.form))}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(Cg(r||null,t),ub(i)&&(_h(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);ib(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&sb(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){wh(this.form,this),this._oldForm&&Wo(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(r){return new(r||n)(q(vh,10),q(Ih,10),q(Qo,8))}}static{this.\u0275dir=at({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&ue("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ni([hb]),qt,_s]})}}return n})();var db={provide:zn,useExisting:Zr(()=>Ji)},Ji=(()=>{class n extends zn{set isDisabled(t){}static{this._ngModelWarningSentOnce=!1}constructor(t,r,i,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new Qn,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=Qg(this,o)}ngOnChanges(t){this._added||this._setUpControl(),Kg(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return Wg(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(r){return new(r||n)(q(qn,13),q(vh,10),q(Ih,10),q(yh,10),q(Jg,8))}}static{this.\u0275dir=at({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[ni([db]),qt,_s]})}}return n})();var Yg=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=gs({type:n})}static{this.\u0275inj=ms({})}}return n})();var dn=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Qo,useValue:t.callSetDisabledState??Jo}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=gs({type:n})}static{this.\u0275inj=ms({imports:[Yg]})}}return n})(),Xo=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Jg,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Qo,useValue:t.callSetDisabledState??Jo}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=gs({type:n})}static{this.\u0275inj=ms({imports:[Yg]})}}return n})();function pb(n,e){n&1&&(D(0,"small",12),O(1," Debe Ingresar Un Usuario "),R())}function mb(n,e){n&1&&(D(0,"small",12),O(1," Al Menos 16 Caracteres "),R())}function gb(n,e){n&1&&(D(0,"strong",12),O(1," Usuario y/o Contrase\xF1a Invalidos "),R())}function _b(n,e){n&1&&(D(0,"strong"),O(1," Validando Credenciales "),R())}var Zo=class n{constructor(e,t,r){this.dbUsuarios=e;this.login=t;this.router=r;this.formularioLogin=new Dr({nombre:new Vt("",[Xe.required]),password:new Vt("",[Xe.minLength(16),Xe.required])})}formularioLogin;loginInvalido=!1;validando=!1;logear(){this.limpiarEspacios(),this.loginInvalido=!1,this.validando=!0;let e=this.formularioLogin.value,t=this.dbUsuarios.obtenerUsuarios().subscribe(r=>{t.unsubscribe(),this.validando=!1;for(let i of r)if(i.nombre==e.nombre&&i.password==e.password){i.password="",this.login.iniciar(i),this.dbUsuarios.generarLogUsuario(e),this.router.navigate(["/home"]);return}this.loginInvalido=!0})}limpiarEspacios(){this.formularioLogin.get("nombre")?.setValue(this.formularioLogin.get("nombre")?.value.trim()),this.formularioLogin.get("password")?.setValue(this.formularioLogin.get("password")?.value.trim())}completarLoginRapido(){this.formularioLogin.get("nombre")?.setValue("test@testing.com"),this.formularioLogin.get("password")?.setValue("roottestroottest")}static \u0275fac=function(t){return new(t||n)(q($e),q(Ee),q(ys))};static \u0275cmp=pe({type:n,selectors:[["app-login"]],standalone:!0,features:[me],decls:22,vars:6,consts:[[1,"login-form",3,"formGroup"],[1,"form-group"],["for","nombre"],["type","text","id","nombre","placeholder","Ingrese usuario","formControlName","nombre"],["class","error",4,"ngIf"],["for","password"],["type","password","id","password","placeholder","Ingrese contrase\xF1a","formControlName","password"],[1,"button-group"],[1,"login-button",3,"click","disabled"],["routerLink","/registro",1,"register-button"],[1,"login-button",3,"click"],[4,"ngIf"],[1,"error"]],template:function(t,r){if(t&1&&(D(0,"form",0)(1,"h2"),O(2,"Login"),R(),D(3,"div",1)(4,"label",2),O(5,"Usuario"),R(),se(6,"input",3),re(7,pb,2,0,"small",4),R(),D(8,"div",1)(9,"label",5),O(10,"Contrase\xF1a"),R(),se(11,"input",6),re(12,mb,2,0,"small",4),R(),D(13,"div",7)(14,"button",8),ue("click",function(){return r.logear()}),O(15,"Login"),R(),D(16,"button",9),O(17,"Registrarse"),R(),D(18,"button",10),ue("click",function(){return r.completarLoginRapido()}),O(19,"Inicio Rapido"),R()(),re(20,gb,2,0,"strong",4)(21,_b,2,0,"strong",11),R()),t&2){let i,o;j("formGroup",r.formularioLogin),U(7),j("ngIf",((i=r.formularioLogin.get("nombre"))==null?null:i.touched)&&!((i=r.formularioLogin.get("nombre"))!=null&&i.valid)),U(5),j("ngIf",((o=r.formularioLogin.get("password"))==null?null:o.touched)&&!((o=r.formularioLogin.get("password"))!=null&&o.valid)),U(2),j("disabled",!r.formularioLogin.valid),U(6),j("ngIf",r.loginInvalido),U(),j("ngIf",r.validando)}},dependencies:[Zn,we,Ie,qe,Xo,Yo,hn,xr,Ho,Qi,Ji],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:stretch}.login-form[_ngcontent-%COMP%]{margin-top:20px;display:flex;flex-direction:column;align-items:center;background-color:#f8f8f8;padding:40px;border-radius:5px;box-shadow:0 0 10px #0003;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin:10px 0}.button-group[_ngcontent-%COMP%]{margin-top:20px;display:flex;flex-direction:column;align-items:center}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:700}input[_ngcontent-%COMP%]{padding:5px;border-radius:5px;border:1px solid #ccc;width:100%;max-width:300px}button[_ngcontent-%COMP%]{width:212px;margin:2px 25px;padding:10px;border:none;border-radius:5px;font-size:1rem;font-weight:700;cursor:pointer}.login-button[_ngcontent-%COMP%]{background-color:#007f00;color:#fff}.register-button[_ngcontent-%COMP%]{background-color:#005e00;color:#fff}.login-button[_ngcontent-%COMP%]:hover, .register-button[_ngcontent-%COMP%]:hover{background-color:#55b955}.login-button[_ngcontent-%COMP%]:disabled{background-color:#007f00;cursor:default}input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border:red 1px solid}small[_ngcontent-%COMP%]{text-decoration:underline;display:block;width:212px}.error[_ngcontent-%COMP%]{color:red}"]})};var ea=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=pe({type:n,selectors:[["app-quien-soy"]],standalone:!0,features:[me],decls:27,vars:0,consts:[[1,"about-me"],[1,"doble"],["src","../../../assets/foto.jpg","alt","foto"]],template:function(t,r){t&1&&(D(0,"div",0)(1,"h2"),O(2,"Quien soy"),R(),D(3,"h3"),O(4,"Charotti Michelle M. "),R(),D(5,"p"),O(6,"Cursando la materia Lab IV."),R(),D(7,"p"),O(8,"Las cosas que hago en mis tiempos libres es viajar y recorrer pueblos no conocidos."),R(),D(9,"div",1),se(10,"img",2),D(11,"div")(12,"p")(13,"strong"),O(14,"Juego: Proximamente"),R()(),D(15,"p"),O(16,"Reglas: "),R(),D(17,"p"),O(18,"Lorem ipsum dolor sit amet consectetur adipisicing elit."),R(),D(19,"p"),O(20," Excepturi voluptates neque corrupti,"),R(),D(21,"p"),O(22," aperiam placeat quas magnam autem nisi dolores "),R(),D(23,"p"),O(24," iusto mollitia quaerat non vitae ab voluptatum quisquam? "),R(),D(25,"p"),O(26,"Ratione, vero veniam?"),R()()()())},dependencies:[we],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:stretch}.about-me[_ngcontent-%COMP%]{margin-top:20px;display:flex;flex-direction:column;align-items:center;background-color:#f8f8f8;padding:20px;border-radius:5px;box-shadow:0 0 10px #0003;margin-bottom:20px}.about-me[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#005b4f;font-size:36px;font-weight:700;margin-bottom:10px}.about-me[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#005b4f;font-size:24px;margin-bottom:20px}.about-me[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:50vh;height:auto;margin:0 40px 20px;padding:5px;border-radius:50px;border:2px solid #ccc;width:100%;max-width:300px}.about-me[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#005b4f;font-size:18px;margin-bottom:20px}.doble[_ngcontent-%COMP%]{display:flex}"]})};function Xg(){return n=>{let e=n.get("password"),t=n.get("repetirPassword"),r={noCoincide:"La Contrase\xF1a No Coincide"};return e?.value!==t?.value?(n.get("repetirPassword")?.setErrors(r),r):(n.get("repetirPassword")?.setErrors(null),null)}}function Zg(n){return e=>{let t=e.value.toLowerCase();return n.obtenerUsuarios().pipe(Rd(500),Dd(1),_n(r=>{for(let i of r)if(i.nombre==t)return{usuarioExiste:"usuarioExiste"};return null}))}}function yb(n,e){n&1&&(D(0,"small"),O(1," Debe Ingresar Un Email Valido "),R())}function vb(n,e){n&1&&(D(0,"small"),O(1," Usuario Ya Registrado "),R())}function Ib(n,e){n&1&&(D(0,"small"),O(1," Al Menos 16 Caracteres "),R())}function wb(n,e){n&1&&(D(0,"small"),O(1," Debe Coincidir Con Contrase\xF1a "),R())}function Eb(n,e){n&1&&(D(0,"strong"),O(1," Verificando Disponibilidad de Usuario "),R())}function bb(n,e){n&1&&(D(0,"strong"),O(1," Usuario Disponible "),R())}var ta=class n{constructor(e,t,r){this.dbUsuarios=e;this.login=t;this.router=r;this.formularioRegistro=new Dr({nombre:new Vt("",[Xe.required,Xe.email],Zg(e)),password:new Vt("",[Xe.minLength(16),Xe.required]),repetirPassword:new Vt("",[Xe.minLength(16),Xe.required])},[Xg()])}formularioRegistro;generarUsuario(){this.limpiarEspacios();let e={nombre:this.formularioRegistro.value.nombre,password:this.formularioRegistro.value.password,puntajeMaxAhorcado:0,puntajeMaxMayorMenor:0,puntajeMaxPreguntados:0};this.dbUsuarios.guardarUsuario(e),this.login.iniciar(e),this.dbUsuarios.generarLogUsuario(e),this.router.navigate(["/home"])}limpiarEspacios(){this.formularioRegistro.get("nombre")?.setValue(this.formularioRegistro.get("nombre")?.value.trim()),this.formularioRegistro.get("password")?.setValue(this.formularioRegistro.get("password")?.value.trim()),this.formularioRegistro.get("repetirPassword")?.setValue(this.formularioRegistro.get("repetirPassword")?.value.trim())}static \u0275fac=function(t){return new(t||n)(q($e),q(Ee),q(ys))};static \u0275cmp=pe({type:n,selectors:[["app-registro"]],standalone:!0,features:[me],decls:24,vars:8,consts:[[1,"login-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","nombre"],["type","text","id","nombre","placeholder","Ingrese email","formControlName","nombre"],[4,"ngIf"],["for","password"],["type","password","id","password","placeholder","Ingrese contrase\xF1a","formControlName","password"],["for","repetirPassword"],["type","password","id","repetirPassword","placeholder","Repita contrase\xF1a","formControlName","repetirPassword"],[1,"button-group"],["routerLink","/registro",1,"register-button",3,"disabled"]],template:function(t,r){if(t&1&&(D(0,"form",0),ue("ngSubmit",function(){return r.generarUsuario()}),D(1,"h2"),O(2,"Registro"),R(),D(3,"div",1)(4,"label",2),O(5,"Email"),R(),se(6,"input",3),re(7,yb,2,0,"small",4)(8,vb,2,0,"small",4),R(),D(9,"div",1)(10,"label",5),O(11,"Contrase\xF1a"),R(),se(12,"input",6),re(13,Ib,2,0,"small",4),R(),D(14,"div",1)(15,"label",7),O(16,"Repetir Contrase\xF1a"),R(),se(17,"input",8),re(18,wb,2,0,"small",4),R(),D(19,"div",9)(20,"button",10),O(21,"Registrarse"),R()(),re(22,Eb,2,0,"strong",4)(23,bb,2,0,"strong",4),R()),t&2){let i,o,a,u,h,d;j("formGroup",r.formularioRegistro),U(7),j("ngIf",((i=r.formularioRegistro.get("nombre"))==null?null:i.touched)&&((i=r.formularioRegistro.get("nombre"))==null||i.errors==null?null:i.errors.email)),U(),j("ngIf",(o=r.formularioRegistro.get("nombre"))==null?null:o.getError("usuarioExiste")),U(5),j("ngIf",((a=r.formularioRegistro.get("password"))==null?null:a.touched)&&!((a=r.formularioRegistro.get("password"))!=null&&a.valid)),U(5),j("ngIf",((u=r.formularioRegistro.get("repetirPassword"))==null?null:u.touched)&&r.formularioRegistro.getError("noCoincide")),U(2),j("disabled",!r.formularioRegistro.valid),U(2),j("ngIf",(h=r.formularioRegistro.get("nombre"))==null?null:h.pending),U(),j("ngIf",(d=r.formularioRegistro.get("nombre"))==null?null:d.valid)}},dependencies:[Ie,qe,Xo,Yo,hn,xr,Ho,Qi,Ji],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:stretch}.login-form[_ngcontent-%COMP%]{margin-top:20px;display:flex;flex-direction:column;align-items:center;background-color:#f8f8f8;padding:40px;border-radius:5px;box-shadow:0 0 10px #0003;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin:10px 0}.button-group[_ngcontent-%COMP%]{width:212px;margin-top:5px;display:flex;flex-direction:column;align-items:center}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:700}input[_ngcontent-%COMP%]{display:block;padding:5px;border-radius:5px;border:1px solid #ccc;width:100%;width:212px}button[_ngcontent-%COMP%]{width:100%;margin:2px 0;padding:10px 0;border:none;border-radius:5px;font-size:1rem;font-weight:700;cursor:pointer}.register-button[_ngcontent-%COMP%]{background-color:#007f00;color:#fff}.register-button[_ngcontent-%COMP%]:hover{background-color:#55b955}.register-button[_ngcontent-%COMP%]:disabled{background-color:#007f00;cursor:default}input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border:red 1px solid}small[_ngcontent-%COMP%]{text-decoration:underline;color:red;display:block;width:212px}"]})};var Tb=(n,e)=>({ganado:n,perdio:e});function Ab(n,e){n&1&&(D(0,"h2",9),O(1,"Generando Nueva Palabra"),R())}function Cb(n,e){if(n&1&&(D(0,"p"),O(1),R()),n&2){let t=oe().$implicit;U(),ct(t)}}function Sb(n,e){n&1&&(D(0,"p"),O(1,"_"),R())}function Pb(n,e){if(n&1&&(D(0,"div",10),re(1,Cb,2,1,"p",11)(2,Sb,2,0,"p",11),R()),n&2){let t=e.$implicit,r=oe();U(),j("ngIf",r.letrasSeleccionadas.includes(t)),U(),j("ngIf",!r.letrasSeleccionadas.includes(t))}}function Rb(n,e){if(n&1){let t=Ke();D(0,"button",12),ue("click",function(){let i=Le(t).$implicit,o=oe();return Ue(o.intentarLetra(i))}),O(1),R()}if(n&2){let t=e.$implicit,r=oe();j("disabled",r.letrasSeleccionadas.includes(t)||r.mostrarMensajeFinal||r.generandoPalabra),U(),ut(" ",t," ")}}function Db(n,e){if(n&1){let t=Ke();D(0,"div",13)(1,"h2"),O(2),R(),D(3,"button",14),ue("click",function(){Le(t);let i=oe();return Ue(i.nuevoJuego())}),O(4,"\xBFJugar Otra Vez?"),R()()}if(n&2){let t=oe();j("ngClass",Yn(2,Tb,t.calcularVictoria(),t.calcularDerrota())),U(2),ct(t.mensajeFinal)}}var na=class n{constructor(e,t){this.user=e;this.db=t;this.nuevoJuego()}palabra=["E","l"," ","P","s","y"," ","K","o","n","g","r","o","o"];errores=0;letrasSeleccionadas=[];abecedario="abcdefghijklmn\xF1opqrstuvwxyz".split("");imagenAhorcado=["../../../assets/ahorcado/hangman-0.png","../../../assets/ahorcado/hangman-1.png","../../../assets/ahorcado/hangman-2.png","../../../assets/ahorcado/hangman-3.png","../../../assets/ahorcado/hangman-4.png","../../../assets/ahorcado/hangman-5.png","../../../assets/ahorcado/hangman-6.png"];mostrarMensajeFinal=!1;generandoPalabra=!0;mensajeFinal="";listOfWords=["GATO","PERRO","LEON","ELEFANTE","SERPIENTE","COCODRILO","POMELO","MANZANA","LAPICERA","CUADERNO"];word="";nuevoJuego(){return y(this,null,function*(){this.generandoPalabra=!0,this.palabra=["E","l"," ","P","s","y"," ","K","o","n","g","r","o","o"],this.errores=0,this.mostrarMensajeFinal=!1,this.ObtenerPalabra()})}formatearPalabra(e){return e.toLowerCase().replace(" ","").replace("  ","").replace("   ","")}ObtenerPalabra(){this.word=this.listOfWords[Math.round(Math.random()*(this.listOfWords.length-1))],this.word&&(this.palabra=this.formatearPalabra(this.word).split(""),this.letrasSeleccionadas=[],this.letrasSeleccionadas.push(this.palabra[0],this.palabra[this.palabra.length-1]),this.generandoPalabra=!1)}intentarLetra(e){this.agregarLetra(e),this.verificarLetra(e),this.calcularVictoria()?this.ganoElJuego():this.calcularDerrota()&&this.Perder()}ganoElJuego(){let e=Math.max(1,this.palabra.length-5);this.mostrarMensajeFinal=!0,this.mensajeFinal="GANASTE",this.user.datos?.id&&(this.mensajeFinal=this.mensajeFinal+" "+e+" PUNTOS!!",this.user.datos.puntajeMaxAhorcado=e+this.user.datos.puntajeMaxAhorcado,this.db.actulizarPuntaje("puntajeMaxAhorcado",this.user.datos.id,this.user.datos.puntajeMaxAhorcado))}verificarLetra(e){let t=!1;e=="a"?t=this.palabra.some(r=>r==="a"||r==="\xE1"):e=="e"?t=this.palabra.some(r=>r==="e"||r==="\xE9"):e=="i"?t=this.palabra.some(r=>r==="i"||r==="\xED"):e=="o"?t=this.palabra.some(r=>r==="o"||r==="\xF3"):e=="u"?t=this.palabra.some(r=>r==="u"||r==="\xFA"||r==="\xFC"):t=this.palabra.includes(e),t||this.errores++}agregarLetra(e){this.letrasSeleccionadas.push(e),e=="a"&&this.letrasSeleccionadas.push("\xE1"),e=="e"&&this.letrasSeleccionadas.push("\xE9"),e=="i"&&this.letrasSeleccionadas.push("\xED"),e=="o"&&this.letrasSeleccionadas.push("\xF3"),e=="u"&&this.letrasSeleccionadas.push("\xFA","\xFC")}calcularVictoria(){return this.palabra.every(e=>this.letrasSeleccionadas.includes(e))}calcularDerrota(){return this.errores==6}Perder(){this.letrasSeleccionadas.push(...this.palabra),this.mostrarMensajeFinal=!0,this.mensajeFinal="PERDISTE!"}static \u0275fac=function(t){return new(t||n)(q(Ee),q($e))};static \u0275cmp=pe({type:n,selectors:[["app-ahorcado"]],standalone:!0,features:[me],decls:9,vars:5,consts:[[1,"ahorcado-contenedor"],[1,"ahorcado-imagen"],["alt","ahorcado imagen",3,"src"],[1,"palabra-contenedor"],["class","mensaje",4,"ngIf"],["class","palabra-contenedor-letras",4,"ngFor","ngForOf"],[1,"contenedor-letras"],["class","letras-botones",3,"disabled","click",4,"ngFor","ngForOf"],["class","mensaje",3,"ngClass",4,"ngIf"],[1,"mensaje"],[1,"palabra-contenedor-letras"],[4,"ngIf"],[1,"letras-botones",3,"click","disabled"],[1,"mensaje",3,"ngClass"],[3,"click"]],template:function(t,r){t&1&&(D(0,"div",0)(1,"div",1),se(2,"img",2),R(),D(3,"div",3),re(4,Ab,2,0,"h2",4)(5,Pb,3,2,"div",5),R(),D(6,"div",6),re(7,Rb,2,2,"button",7),R(),re(8,Db,5,5,"div",8),R()),t&2&&(U(2),j("src",r.imagenAhorcado[r.errores],Jn),U(2),j("ngIf",r.generandoPalabra),U(),j("ngForOf",r.palabra),U(2),j("ngForOf",r.abecedario),U(),j("ngIf",r.mostrarMensajeFinal))},dependencies:[we,Ie,Xn,Gt,qe,dn],styles:["[_nghost-%COMP%]{background-color:#000}.ahorcado-contenedor[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:85vh}.ahorcado-imagen[_ngcontent-%COMP%]{background-size:cover;background-position:center;margin-bottom:2vh}img[_ngcontent-%COMP%]{height:45vh;max-height:600px;width:100%}.contenedor-letras[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;max-width:600px}.letras-botones[_ngcontent-%COMP%]{align-items:end;justify-content:center;text-transform:uppercase;display:flex;font-size:5vmin;width:7vmin;height:7vmin;margin:5px;border:none;background-color:#2bb52b;color:#fff;text-align:center;cursor:pointer;border-radius:5px}.letras-botones[_ngcontent-%COMP%]:disabled{background-color:#aaa;cursor:not-allowed}.palabra-contenedor[_ngcontent-%COMP%]{margin-top:20px;display:flex}.palabra-contenedor-letras[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-transform:uppercase;font-size:6vmin;width:5vmin;text-align:center;padding:2px;margin:0 2px}.button[_ngcontent-%COMP%]{display:inline-block;background-color:#f44336;color:#fff;border:none;padding:10px 20px;font-size:16px;text-align:center;cursor:pointer;border-radius:5px}.button[_ngcontent-%COMP%]:hover{background-color:#d32f2f}.button[_ngcontent-%COMP%]:active{background-color:#b71c1c}.mensaje[_ngcontent-%COMP%]{position:fixed;background-color:#445740;top:80%;left:50%;transform:translate(-50%,-50%);color:#fff;padding:20px;border-radius:5px;text-align:center;box-shadow:0 2px 6px #0000004d}.mensaje[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:20px}.mensaje[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-block;background-color:#fff;color:#000;border:none;padding:10px 20px;font-size:16px;text-align:center;cursor:pointer;border-radius:5px}.mensaje[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#d3d3d3}.mensaje.ganado[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.mensaje.perdio[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}@media (max-height: 600px){.ahorcado-contenedor[_ngcontent-%COMP%]{flex-direction:row}.contenedor-letras[_ngcontent-%COMP%]{max-width:300px}.ahorcado-imagen[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:70vh;min-width:30vw}}"]})};var ra=class n{constructor(e){this.http=e}obtenerPreguntaArte(){return this.http.get("https://restcountries.com/v3.1/all")}static \u0275fac=function(t){return new(t||n)(jt(Gd))};static \u0275prov=it({token:n,factory:n.\u0275fac,providedIn:"root"})};var kb=(n,e)=>({correcta:n,incorrecta:e}),Nb=n=>({ganado:n});function Vb(n,e){if(n&1){let t=Ke();D(0,"button",4),ue("click",function(){let i=Le(t).$implicit,o=oe();return Ue(o.seleccionarRespuesta(i.estado))}),O(1),R()}if(n&2){let t=e.$implicit,r=oe();j("disabled",r.mostrandoMensajeFinal||r.generandoPregunta)("ngClass",Yn(3,kb,r.mostrandoMensajeFinal&&t.estado,r.mostrandoMensajeFinal&&!t.estado)),U(),ut(" ",t.respuesta," ")}}function Ob(n,e){if(n&1){let t=Ke();D(0,"div",5)(1,"p"),O(2),R(),D(3,"button",6),ue("click",function(){Le(t);let i=oe();return Ue(i.iniciarJuego())}),O(4,"\xBFOtra Pregunta?"),R()()}if(n&2){let t=oe();j("ngClass",ri(2,Nb,t.gano)),U(2),ct(t.mensajeFinal)}}var ia=class n{constructor(e,t,r){this.preguntas=e;this.db=t;this.user=r}generandoPregunta=!1;mostrandoMensajeFinal=!1;gano=!1;mensajeFinal="";pregunta="";tema="";respuestas=[];ngOnInit(){this.iniciarJuego()}iniciarJuego(){this.generandoPregunta=!0,this.mostrandoMensajeFinal=!1,this.mensajeFinal="",this.pregunta="Generando Pregunta...",this.obtenerPreguntaAleatoria()}seleccionarRespuesta(e){e?this.ganar():this.perder(),this.mostrandoMensajeFinal=!0}ganar(){this.user.datos?.id&&(this.user.datos.puntajeMaxPreguntados++,this.db.actulizarPuntaje("puntajeMaxPreguntados",this.user.datos.id,this.user.datos.puntajeMaxPreguntados)),this.gano=!0,this.mensajeFinal="RESPUESTA CORRECTA!!"}perder(){this.gano=!1,this.mensajeFinal="RESPUESTA INCORRECTA :c"}obtenerPreguntaAleatoria(){switch(this.random(0,5)){case 0:this.tema="Arte",this.obtenerPreguntaArte();break}}obtenerPreguntaArte(){let e=this.preguntas.obtenerPreguntaArte().subscribe(t=>{this.asignarPreguntaRespuestas(t),e.unsubscribe()})}asignarPreguntaRespuestas(e){this.generandoPregunta=!1,this.pregunta=e.p,this.respuestas[0]={respuesta:e.r,estado:!0},this.respuestas[1]={respuesta:e.i1,estado:!1},this.respuestas[2]={respuesta:e.i2,estado:!1},this.respuestas[3]={respuesta:e.i3,estado:!1},this.mezclarRespuestas()}random(e,t){return Math.floor(Math.random()*(t-e+1))+e}mezclarRespuestas(){for(let e=this.respuestas.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[this.respuestas[e],this.respuestas[t]]=[this.respuestas[t],this.respuestas[e]]}}static \u0275fac=function(t){return new(t||n)(q(ra),q($e),q(Ee))};static \u0275cmp=pe({type:n,selectors:[["app-preguntados"]],standalone:!0,features:[me],decls:8,vars:4,consts:[[1,"pregunta"],[1,"lista-respuestas"],["class","respuesta",3,"disabled","ngClass","click",4,"ngFor","ngForOf"],["class","mensaje-final",3,"ngClass",4,"ngIf"],[1,"respuesta",3,"click","disabled","ngClass"],[1,"mensaje-final",3,"ngClass"],[3,"click"]],template:function(t,r){t&1&&(D(0,"div",0)(1,"h2"),O(2),R(),D(3,"p"),O(4),R()(),D(5,"div",1),re(6,Vb,2,6,"button",2),R(),re(7,Ob,5,4,"div",3)),t&2&&(U(2),ut("Preguntados: ",r.tema,""),U(2),ct(r.pregunta),U(2),j("ngForOf",r.respuestas),U(),j("ngIf",r.mostrandoMensajeFinal))},dependencies:[dn,Ie,Xn,Gt,qe,we],styles:["[_nghost-%COMP%]{display:grid;grid-template:auto;justify-content:center;align-items:center;height:85vh;background-color:#f5f5f5;border-bottom:1px solid black}h2[_ngcontent-%COMP%]{text-align:center;font-weight:bolder;margin-bottom:20px}.pregunta[_ngcontent-%COMP%]{background-color:#6495ed;padding:1vw;border-radius:20px;border:1px solid gainsboro}.pregunta[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;font-size:26px;font-weight:600}.lista-respuestas[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;justify-content:center;align-items:center}.respuesta[_ngcontent-%COMP%]{width:40vw;background-color:#6495ed;padding:1vw;border-radius:20px;font-size:26px}.respuesta[_ngcontent-%COMP%]:hover:enabled{background-color:#4169e1}.mensaje-final[_ngcontent-%COMP%]{position:fixed;top:80%;left:50%;transform:translate(-50%,-50%);background-color:#f44336;color:#fff;padding:20px;border-radius:5px;text-align:center;box-shadow:0 2px 6px #0000004d}.mensaje-final.ganado[_ngcontent-%COMP%]{background-color:#4caf50}.mensaje-final[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:24px;margin-bottom:20px}.correcta[_ngcontent-%COMP%]{background-color:#6ce470}.incorrecta[_ngcontent-%COMP%]{background-color:#e46c6c}.mensaje-final[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline-block;background-color:#fff;color:#000;border:none;padding:10px 20px;font-size:16px;text-align:center;cursor:pointer;border-radius:5px}.mensaje-final[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#d3d3d3}"]})};var sa=class{_cartas;_cartasUsadas;constructor(e=!0){this._cartasUsadas=[],this._cartas=[],e?this.generarMazoCompleto():this.generarMazoDe10(),this.mezclarMazo()}get restantes(){return this._cartas.length}mezclarMazo(){for(let e=this._cartas.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[this._cartas[e],this._cartas[t]]=[this._cartas[t],this._cartas[e]]}}obtenerCarta(){let e=this._cartas.pop();return e&&this._cartasUsadas.push(e),e}reiniciarMazo(){this._cartas.push(...this._cartasUsadas),this._cartasUsadas=[],this.mezclarMazo()}generarMazoDe10(){for(let e=1;e<=10;e++){let t={codigo:"P"+e,valor:e},r={codigo:"C"+e,valor:e},i={codigo:"T"+e,valor:e},o={codigo:"D"+e,valor:e};this._cartas.push(t,r,i,o)}}generarMazoCompleto(){let e={codigo:"P1",valor:11},t={codigo:"C1",valor:11},r={codigo:"T1",valor:11},i={codigo:"D1",valor:11};this._cartas.push(e,t,r,i);for(let o=2;o<10;o++){let a={codigo:"P"+o,valor:o},u={codigo:"C"+o,valor:o},h={codigo:"T"+o,valor:o},d={codigo:"D"+o,valor:o};this._cartas.push(a,u,h,d)}for(let o=10;o<14;o++){let a={codigo:"P"+o,valor:10},u={codigo:"C"+o,valor:10},h={codigo:"T"+o,valor:10},d={codigo:"D"+o,valor:10};this._cartas.push(a,u,h,d)}}};var t_=n=>({rotar:n}),Mb=()=>[],Fb=(n,e)=>({ganado:n,perdido:e});function Lb(n,e){if(n&1&&(D(0,"div",14),se(1,"img",15),R()),n&2){let t=e.index;Vd("margin-top",-t*1.5,"px"),U(),j("src","../../../assets/cartas/flip"+(t/2==0?"0":"0bis")+".png",Jn)}}function Ub(n,e){if(n&1){let t=Ke();D(0,"div",16)(1,"h2"),O(2),R(),D(3,"button",17),ue("click",function(){Le(t);let i=oe();return Ue(i.generarNuevaRonda())}),O(4,"\xBFJugar Otra Vez?"),R()()}if(n&2){let t=oe();j("ngClass",Yn(2,Fb,t.estado==0,t.estado==1)),U(2),ct(t.mensajeFinal)}}var oa=class n{constructor(e,t,r){this.user=e;this.db=t;this.preload=r;this.preCargarImagenes(this.generarListaImagenes()),this.user.datos&&(this.puntajeActual=this.user.datos.puntajeMaxMayorMenor),this.generarNuevaRonda()}mazo=new sa(!1);cartaVisible;cartaAdivinar;mostrarMensajeFinal=!1;mensajeFinal="";estado=2;puntajeActual=0;get imagenCartaVisible(){let e="0";return this.cartaVisible&&(e=this.cartaVisible.codigo),"../../../assets/cartas/"+e+".png"}get imagenCartaAdivinar(){let e="0";return this.cartaAdivinar&&(e=this.cartaAdivinar.codigo),"../../../assets/cartas/"+e+".png"}generarNuevaRonda(){this.mazo.restantes<15&&this.mazo.reiniciarMazo(),this.cartaAdivinar=void 0,this.cartaVisible=void 0,setTimeout(()=>{this.cartaVisible=this.mazo.obtenerCarta()},500),this.mostrarMensajeFinal=!1,this.mensajeFinal=""}adivinar(){return this.mostrarMensajeFinal=!0,this.cartaAdivinar=this.mazo.obtenerCarta(),this.cartaAdivinar?.valor==this.cartaVisible?.valor?(this.empatar(),!1):!0}adivinarMayor(){this.adivinar()&&(this.cartaAdivinar.valor>this.cartaVisible.valor?this.ganar():this.perder())}adivinarMenor(){this.adivinar()&&(this.cartaAdivinar.valor<this.cartaVisible.valor?this.ganar():this.perder())}ganar(){this.estado=0,this.mensajeFinal="GANASTE 1 PUNTO",this.guardarPuntaje()}perder(){this.estado=1,this.mensajeFinal="PERDISTE"}empatar(){this.estado=2,this.mensajeFinal="EMPATE"}guardarPuntaje(){this.puntajeActual+=1,this.user.datos?.id&&(this.user.datos.puntajeMaxMayorMenor=this.puntajeActual,this.db.actulizarPuntaje("puntajeMaxMayorMenor",this.user.datos.id,this.user.datos.puntajeMaxMayorMenor))}preCargarImagenes(e){e.forEach(t=>{let r=new Image;r.src=t,this.preload.appendChild(document.body,r),document.body.removeChild(r)})}generarListaImagenes(){let e=[],t="../../../assets/cartas/";for(let r=1;r<11;r++)e.push(t+"P"+r+".png"),e.push(t+"D"+r+".png"),e.push(t+"C"+r+".png"),e.push(t+"T"+r+".png");return e}static \u0275fac=function(t){return new(t||n)(q(Ee),q($e),q(ei))};static \u0275cmp=pe({type:n,selectors:[["app-mayor-menor"]],standalone:!0,features:[me],decls:25,vars:15,consts:[[1,"contenedor"],[1,"contenedor-imagenes"],[1,"carta-animacion-contenedor"],[1,"carta-animacion",3,"ngClass"],["src","../../../assets/cartas/0.png",1,"carta-animacion-dorso"],[1,"carta-animacion-frente",3,"src"],[1,"mazo-cartas"],["class","carta",3,"margin-top",4,"ngFor","ngForOf"],[1,"contenedor-botones"],[1,"mayor",3,"click","disabled"],[1,"menor",3,"click","disabled"],["class","mensaje",3,"ngClass",4,"ngIf"],[1,"puntaje-mazo"],[1,"puntaje"],[1,"carta"],[3,"src"],[1,"mensaje",3,"ngClass"],[3,"click"]],template:function(t,r){t&1&&(D(0,"div",0)(1,"h3"),O(2,"La Siguiente Carta: \xBFSera Menor o Mayor?"),R(),D(3,"div",1)(4,"div",2)(5,"div",3),se(6,"img",4)(7,"img",5),R()(),D(8,"div",2)(9,"div",3),se(10,"img",4)(11,"img",5),R()(),D(12,"div",6),re(13,Lb,2,3,"div",7),R()(),D(14,"div",8)(15,"button",9),ue("click",function(){return r.adivinarMayor()}),O(16,"Mayor >"),R(),D(17,"button",10),ue("click",function(){return r.adivinarMenor()}),O(18,"Menor <"),R()(),re(19,Ub,5,5,"div",11),D(20,"div",12)(21,"div",13),O(22),se(23,"br"),O(24),R()()()),t&2&&(U(5),j("ngClass",ri(10,t_,r.cartaVisible)),U(2),j("src",r.imagenCartaVisible,Jn),U(2),j("ngClass",ri(12,t_,r.cartaAdivinar)),U(2),j("src",r.imagenCartaAdivinar,Jn),U(2),j("ngForOf",Ld(14,Mb).constructor(r.mazo.restantes)),U(2),j("disabled",r.mostrarMensajeFinal||!r.cartaVisible),U(2),j("disabled",r.mostrarMensajeFinal||!r.cartaVisible),U(2),j("ngIf",r.mostrarMensajeFinal),U(3),ut(" Puntaje Actual: ",r.puntajeActual," "),U(2),ut(" Cartas Restantes: ",r.mazo.restantes," "))},dependencies:[Ie,Xn,Gt,qe,dn,we]})};var n_=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"home",component:Lo},{path:"login",component:Zo},{path:"quien-soy",component:ea},{path:"registro",component:ta},{path:"ahorcado",component:na,loadChildren:()=>import("./chunk-3744EE5S.js").then(n=>n.AhorcadoModule)},{path:"preguntados",component:ia,loadChildren:()=>import("./chunk-PS2AOHBY.js").then(n=>n.PreguntadosModule)},{path:"mayor-menor",component:oa,loadChildren:()=>import("./chunk-ZAIRFUEU.js").then(n=>n.MayormenorModule)}];var r_={projectId:"tpsaladejuego1",appId:"1:985391348349:web:ab26650cf50dc9c20c8f14",storageBucket:"tpsaladejuego1.appspot.com",apiKey:"AIzaSyAGfY93O1rHzc3HuJ4VYcy-TrWoZnXnzao",authDomain:"tpsaladejuego1.firebaseapp.com",messagingSenderId:"985391348349"};var i_={providers:[Bd({eventCoalescing:!0}),Kd(n_),Tf(()=>Af(r_)),mp(()=>gp()),mg(()=>_g()),$d()]};function jb(n,e){if(n&1&&(D(0,"strong"),O(1),R()),n&2){let t=oe();U(),ut("Bienvenido, ",t.usuario.nombre,"")}}function Bb(n,e){n&1&&(D(0,"button",9),O(1,"Login"),R())}function qb(n,e){n&1&&(D(0,"button",10),O(1,"Registro"),R())}function zb(n,e){if(n&1){let t=Ke();D(0,"button",11),ue("click",function(){Le(t);let i=oe();return Ue(i.cerrarSesion())}),O(1,"Cerrar Sesi\xF3n"),R()}}var aa=class n{constructor(e){this.usuario=e}cerrarSesion(){this.usuario.cerrar()}static \u0275fac=function(t){return new(t||n)(q(Ee))};static \u0275cmp=pe({type:n,selectors:[["app-header"]],standalone:!0,features:[me],decls:14,vars:4,consts:[[1,"left"],["src","../../../assets/iconogame.png","alt","i"],[1,"right"],[4,"ngIf"],["routerLink",""],["routerLink","quien-soy"],["routerLink","login",4,"ngIf"],["routerLink","registro",4,"ngIf"],[3,"click",4,"ngIf"],["routerLink","login"],["routerLink","registro"],[3,"click"]],template:function(t,r){t&1&&(D(0,"nav")(1,"div",0),se(2,"img",1),D(3,"h1"),O(4,"Sala de Juegos"),R()(),D(5,"div",2),re(6,jb,2,1,"strong",3),D(7,"button",4),O(8,"Home"),R(),D(9,"button",5),O(10,"Quien Soy"),R(),re(11,Bb,2,0,"button",6)(12,qb,2,0,"button",7)(13,zb,2,0,"button",8),R()()),t&2&&(U(6),j("ngIf",r.usuario.datos),U(5),j("ngIf",r.usuario.datos==null),U(),j("ngIf",r.usuario.datos==null),U(),j("ngIf",r.usuario.datos!=null))},dependencies:[Zn,we,Ie,qe],styles:["nav[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background-color:green;padding:10px;height:80px}.left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:#fff;font-size:24px}.left[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px}.right[_ngcontent-%COMP%]{display:flex;gap:10px}.right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#fff;border:none;color:green;padding:10px 20px;font-size:16px;border-radius:5px;min-width:125px;cursor:pointer}.right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#d3d3d3}strong[_ngcontent-%COMP%]{text-justify:auto;text-align:center;background-color:transparent;text-decoration:underline;color:#fff;margin-right:10px;padding:10px 20px;font-size:24px}@media (max-width: 1400px){strong[_ngcontent-%COMP%]{display:none}}"]})};var ca=class n{constructor(e){this.firestore=e}guardarMensaje(e){let t=cn(this.firestore,"mensajes");return Gi(t,e)}obtenerMensajes(){let e=cn(this.firestore,"mensajes"),t=Ig(e,vg("hora","desc"),yg(100));return Fo(t)}static \u0275fac=function(t){return new(t||n)(jt(kt))};static \u0275prov=it({token:n,factory:n.\u0275fac,providedIn:"root"})};function $b(n,e){if(n&1&&(D(0,"li"),O(1),R()),n&2){let t=e.$implicit,r=oe(3);U(),ct(r.formatearMensaje(t))}}function Wb(n,e){if(n&1){let t=Ke();D(0,"div",3)(1,"div",4)(2,"button",5),ue("click",function(){Le(t);let i=oe(2);return Ue(i.cerrarChat())}),O(3,"X"),R()(),D(4,"div",6)(5,"div")(6,"ul"),re(7,$b,2,1,"li",7),R()()(),D(8,"div")(9,"input",8),Fd("ngModelChange",function(i){Le(t);let o=oe(2);return Md(o.nuevoMensaje,i)||(o.nuevoMensaje=i),Ue(i)}),R(),D(10,"button",9),ue("click",function(){Le(t);let i=oe(2);return Ue(i.enviarMensaje())}),O(11,">"),R()()()}if(n&2){let t=oe(2);U(7),j("ngForOf",t.mensajes),U(2),Od("ngModel",t.nuevoMensaje)}}function Hb(n,e){if(n&1){let t=Ke();D(0,"button",10),ue("click",function(){Le(t);let i=oe(2);return Ue(i.abrirChat())}),se(1,"img",11),O(2,"Chat"),R()}}function Kb(n,e){if(n&1&&(D(0,"div"),re(1,Wb,12,2,"div",1)(2,Hb,3,0,"button",2),R()),n&2){let t=oe();U(),j("ngIf",t.chatActivo),U(),j("ngIf",!t.chatActivo)}}var ua=class n{constructor(e,t){this.usuario=e;this.dbMensajes=t}chatActivo=!1;mensajes=[];nuevoMensaje="";observableMensajes;get usuarioLogeado(){return this.usuario.datos!==void 0}ngDestroy(){this.observableMensajes&&this.observableMensajes.unsubscribe()}abrirChat(){this.observableMensajes=this.dbMensajes.obtenerMensajes().subscribe(e=>{e=e.reverse(),this.mensajes=e}),this.chatActivo=!0,this.scrollChatAbajo()}scrollChatAbajo(){setTimeout(()=>{let e=document.getElementById("chat");e&&(e.scrollTop+=e.scrollHeight)},250)}cerrarChat(){this.chatActivo=!1}enviarMensaje(){if(this.scrollChatAbajo(),this.usuario.datos&&this.nuevoMensaje!=""){let e=new Date().toISOString();console.log(e);let t={autor:this.usuario.datos.nombre,hora:e,texto:this.nuevoMensaje};this.dbMensajes.guardarMensaje(t),this.nuevoMensaje=""}}formatearMensaje(e){let r=new Date(e.hora).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}),i=e.autor.split("@")[0];return r+"| "+i+": "+e.texto}static \u0275fac=function(t){return new(t||n)(q(Ee),q(ca))};static \u0275cmp=pe({type:n,selectors:[["app-chat"]],standalone:!0,features:[me],decls:1,vars:1,consts:[[4,"ngIf"],["class","chat",4,"ngIf"],["class","abrir",3,"click",4,"ngIf"],[1,"chat"],[1,"cerrar"],[3,"click"],["id","chat",1,"chat-box"],[4,"ngFor","ngForOf"],["type","text","placeholder","Ingrese su mensaje...",3,"ngModelChange","ngModel"],[1,"enviar",3,"click"],[1,"abrir",3,"click"],["src","../../../assets/chat.png","alt",""]],template:function(t,r){t&1&&re(0,Kb,3,2,"div",0),t&2&&j("ngIf",r.usuarioLogeado)},dependencies:[we,Ie,Gt,qe,dn,hn,xr,Eh],styles:["[_nghost-%COMP%]{position:fixed;bottom:0%;left:0%}img[_ngcontent-%COMP%]{width:50px}.chat[_ngcontent-%COMP%]{text-align:left;font-size:20px;font-weight:700;border:1px solid black;border-radius:10px;background-color:#d7ecd7;color:#fff;padding:5px;margin:3px}.abrir[_ngcontent-%COMP%]{text-align:left;font-size:20px;font-weight:700;min-width:120px;border:1px solid black;border-radius:10px;background-color:#32cd32;color:#fff;padding:5px;margin:3px}.cerrar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;right:0;text-align:left;font-size:20px;font-weight:700;border:1px solid black;border-radius:10px;background-color:#32cd32;color:#fff;padding:5px;margin:2px 7px}.enviar[_ngcontent-%COMP%]{position:absolute;right:0;text-align:left;font-size:20px;font-weight:700;border:1px solid black;border-radius:10px;background-color:#32cd32;color:#fff;padding:5px;margin:-5px 7px}input[_ngcontent-%COMP%]{width:calc(100% - 30px)}button[_ngcontent-%COMP%]:hover{background-color:#277927}.chat-box[_ngcontent-%COMP%]{color:#000;font-size:16px;font-weight:300;height:60vh;width:33vw;overflow-y:scroll;-ms-overflow-style:none;scrollbar-width:none}li[_ngcontent-%COMP%]{list-style:none;border-bottom:1px black solid}ul[_ngcontent-%COMP%]{padding:1px 5px}.chat-box[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}"]})};var la=class n{title="tpsaladejuego1";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=pe({type:n,selectors:[["app-root"]],standalone:!0,features:[me],decls:3,vars:0,template:function(t,r){t&1&&se(0,"app-header")(1,"app-chat")(2,"router-outlet")},dependencies:[Hd,we,Ie,aa,ua],styles:["[_nghost-%COMP%]{width:100%;height:100%}"]})};Wd(la,i_).catch(n=>console.error(n));
